<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.7.32">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <meta name="author" content="Shreya Dimri">
    <meta name="dcterms.date" content="2025-07-05">

    <title>Green Nest Material Meta-Analysis</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      html { -webkit-text-size-adjust: 100%; }
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      const contentEl = window.document.getElementById('quarto-content');
      for (const child of contentEl.children) {
        child.style.paddingTop = header.clientHeight + "px";
        child.style.marginTop = "1em";
      }

      // Use the article root if the `back` call doesn't work. This isn't perfect
      // but should typically work
      window.quartoBackToArticle = () => {
        var currentUrl = window.location.href;
        window.history.back();
        setTimeout(() => {
            // if location was not changed in 100 ms, then there is no history back
            if(currentUrl === window.location.href){              
                // redirect to site root
                window.location.href = "../index.html";
            }
        }, 100);
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="../site_libs/manuscript-notebook/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-234273d1456647dabc34a594ac50e507.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-25ba1f05e5e722b081d00d4588ea7249.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
     <script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>  <link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>   <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script> 
      </head>

  <body class="quarto-notebook quarto-light">
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      
      <a onclick="window.quartoBackToArticle(); return false;" class="btn btn-primary quarto-back-link" href=""><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> Green Nest Material Meta-Analysis</h6>

            <a href="../notebook/data_analysis.qmd" class="btn btn-primary quarto-download-embed" download="data_analysis.qmd">Download Source</a>
          </div>

     <div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="3">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul class="collapse">
  <li><a href="#loading-data-for-analysis" id="toc-loading-data-for-analysis" class="nav-link active" data-scroll-target="#loading-data-for-analysis">Loading Data for analysis</a></li>
  <li><a href="#preparing-datasets" id="toc-preparing-datasets" class="nav-link" data-scroll-target="#preparing-datasets">Preparing datasets</a></li>
  <li><a href="#overall-effect-intercept-only-meta-analytic-model" id="toc-overall-effect-intercept-only-meta-analytic-model" class="nav-link" data-scroll-target="#overall-effect-intercept-only-meta-analytic-model">Overall effect : Intercept-only meta-analytic model</a>
  <ul class="collapse">
  <li><a href="#using-lnrr" id="toc-using-lnrr" class="nav-link" data-scroll-target="#using-lnrr">using lnRR</a></li>
  <li><a href="#lnrr-heterogeneity" id="toc-lnrr-heterogeneity" class="nav-link" data-scroll-target="#lnrr-heterogeneity">lnRR-heterogeneity</a></li>
  <li><a href="#using-smdh" id="toc-using-smdh" class="nav-link" data-scroll-target="#using-smdh">using SMDH</a></li>
  <li><a href="#smdh-heterogeneity" id="toc-smdh-heterogeneity" class="nav-link" data-scroll-target="#smdh-heterogeneity">SMDH-heterogeneity</a></li>
  <li><a href="#bivariate-meta-analytical-model" id="toc-bivariate-meta-analytical-model" class="nav-link" data-scroll-target="#bivariate-meta-analytical-model">Bivariate Meta-analytical model</a></li>
  </ul></li>
  <li><a href="#sensitivity-analysis" id="toc-sensitivity-analysis" class="nav-link" data-scroll-target="#sensitivity-analysis">Sensitivity Analysis</a></li>
  <li><a href="#mechanistic-hypothesis" id="toc-mechanistic-hypothesis" class="nav-link" data-scroll-target="#mechanistic-hypothesis">Mechanistic Hypothesis</a></li>
  <li><a href="#exploratory-analysis" id="toc-exploratory-analysis" class="nav-link" data-scroll-target="#exploratory-analysis">Exploratory Analysis</a></li>
  <li><a href="#sensitivity-analyses-robustness-checks" id="toc-sensitivity-analyses-robustness-checks" class="nav-link" data-scroll-target="#sensitivity-analyses-robustness-checks"><strong>Sensitivity analyses / robustness checks</strong></a>
  <ul class="collapse">
  <li><a href="#other-analysis" id="toc-other-analysis" class="nav-link" data-scroll-target="#other-analysis">Other Analysis</a></li>
  <li><a href="#publication-bias" id="toc-publication-bias" class="nav-link" data-scroll-target="#publication-bias">Publication Bias</a></li>
  <li><a href="#all-in-model-for-heterogeneity" id="toc-all-in-model-for-heterogeneity" class="nav-link" data-scroll-target="#all-in-model-for-heterogeneity">All-in Model for heterogeneity</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">      <header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Green Nest Material Meta-Analysis</h1>
<p class="subtitle lead">The adaptive value of green nest material across birds: A systematic review and meta-analysis</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Shreya Dimri </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 5, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>     <section id="loading-data-for-analysis" class="level2">
<h2 class="anchored" data-anchor-id="loading-data-for-analysis">Loading Data for analysis</h2>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [1]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting up workspace</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># For plotting trees, and although not strictly necessary, we may need the `ggtree` R package, which you should be able to install by running:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># if (!require("BiocManager", quietly = TRUE))</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("BiocManager")</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># BiocManager::install("ggtree")</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#devtools::install_github("daniel1noble/orchaRd", ref = "main", force = TRUE)</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(here, tidyverse, metafor,ggpubr,orchaRd,ggpubfigs) <span class="co">#Packages needed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggpubfigs' is not available for this version of R

A version of this package for your version of R might be available elsewhere,
see the ideas at
https://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Installing-packages</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'BiocManager' not available.  Could not check Bioconductor.

Please use `install.packages('BiocManager')` and then retry.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in p_install(package, character.only = TRUE, ...):</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in library(package, lib.loc = lib.loc, character.only = TRUE,
logical.return = TRUE, : there is no package called 'ggpubfigs'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in pacman::p_load(here, tidyverse, metafor, ggpubr, orchaRd, ggpubfigs): Failed to install/load:
ggpubfigs</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="do">## cleaning up</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">430</span>) <span class="co">#set seed for reproducibility (for random number generation)</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading cleaned dataset</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>dataset_analysis<span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/03_data_cleaning/dataset_analysis.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 279 Columns: 71
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (35): paper_ID, fulltext_screening, variable_note, authors, population_l...
dbl (35): year_publication, Observation_ID, experiment_ID, group_ID, repeate...
lgl  (1): fulltext_notes

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Functions needed</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># function to estimate typical sampling error variance obtained from </span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># https://github.com/Yefeng0920/heterogeneity_ecoevo/tree/main/function</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>sigma2_v <span class="ot">&lt;-</span> <span class="cf">function</span>(mod){</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  sigma2_v <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="dv">1</span> <span class="sc">/</span> mod<span class="sc">$</span>vi) <span class="sc">*</span> (mod<span class="sc">$</span>k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">sum</span>(<span class="dv">1</span> <span class="sc">/</span> mod<span class="sc">$</span>vi)<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="fu">sum</span>((<span class="dv">1</span> <span class="sc">/</span> mod<span class="sc">$</span>vi)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sigma2_v)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<section id="creating-phylogeny-for-the-plot" class="level3">
<h3 class="anchored" data-anchor-id="creating-phylogeny-for-the-plot">Creating Phylogeny for the plot</h3>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [2]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("pacman")</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(rotl,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>               ape,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>               ggtree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggtree' is not available for this version of R

A version of this package for your version of R might be available elsewhere,
see the ideas at
https://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Installing-packages</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'BiocManager' not available.  Could not check Bioconductor.

Please use `install.packages('BiocManager')` and then retry.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in p_install(package, character.only = TRUE, ...):</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in library(package, lib.loc = lib.loc, character.only = TRUE,
logical.return = TRUE, : there is no package called 'ggtree'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in pacman::p_load(rotl, ape, ggtree): Failed to install/load:
ggtree</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Doesn't matter if I take dataset_lnRR or dataset_SMDH</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>bird_species <span class="ot">&lt;-</span> <span class="fu">unique</span>(dataset_analysis<span class="sc">$</span>bird_species)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># extracting taxonomic information</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>taxa <span class="ot">&lt;-</span> rotl<span class="sc">::</span><span class="fu">tnrs_match_names</span>(<span class="at">names =</span> bird_species)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>taxa</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["search_string"],"name":[1],"type":["chr"],"align":["left"]},{"label":["unique_name"],"name":[2],"type":["chr"],"align":["left"]},{"label":["approximate_match"],"name":[3],"type":["lgl"],"align":["right"]},{"label":["score"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["ott_id"],"name":[5],"type":["int"],"align":["right"]},{"label":["is_synonym"],"name":[6],"type":["lgl"],"align":["right"]},{"label":["flags"],"name":[7],"type":["chr"],"align":["left"]},{"label":["number_matches"],"name":[8],"type":["int"],"align":["right"]}],"data":[{"1":"cyanistes caeruleus","2":"Cyanistes caeruleus","3":"FALSE","4":"1","5":"746120","6":"FALSE","7":"","8":"1"},{"1":"sturnus unicolor","2":"Sturnus unicolor","3":"FALSE","4":"1","5":"366470","6":"FALSE","7":"sibling_higher","8":"1"},{"1":"tachycineta bicolor","2":"Tachycineta bicolor","3":"FALSE","4":"1","5":"136028","6":"FALSE","7":"","8":"1"},{"1":"sturnus vulgaris","2":"Sturnus vulgaris","3":"FALSE","4":"1","5":"565813","6":"FALSE","7":"sibling_higher","8":"1"},{"1":"parus major","2":"Parus major","3":"FALSE","4":"1","5":"515143","6":"FALSE","7":"","8":"1"},{"1":"passer cinnamomeus","2":"Passer cinnamomeus","3":"FALSE","4":"1","5":"7661508","6":"FALSE","7":"","8":"1"},{"1":"buteo buteo","2":"Buteo buteo","3":"FALSE","4":"1","5":"119214","6":"FALSE","7":"sibling_higher","8":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check approximate matches</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>taxa[taxa<span class="sc">$</span>approximate_match<span class="sc">==</span><span class="cn">TRUE</span> <span class="sc">&amp;</span> <span class="sc">!</span>(<span class="fu">is.na</span>(taxa<span class="sc">$</span>approximate_match)),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["search_string"],"name":[1],"type":["chr"],"align":["left"]},{"label":["unique_name"],"name":[2],"type":["chr"],"align":["left"]},{"label":["approximate_match"],"name":[3],"type":["lgl"],"align":["right"]},{"label":["score"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["ott_id"],"name":[5],"type":["int"],"align":["right"]},{"label":["is_synonym"],"name":[6],"type":["lgl"],"align":["right"]},{"label":["flags"],"name":[7],"type":["chr"],"align":["left"]},{"label":["number_matches"],"name":[8],"type":["int"],"align":["right"]}],"data":[],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># phylogenetic information for our species from the Open Tree of Life</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">&lt;-</span> rotl<span class="sc">::</span><span class="fu">tol_induced_subtree</span>(<span class="at">ott_ids =</span> taxa[[<span class="st">"ott_id"</span>]], <span class="at">label_format =</span> <span class="st">"name"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Progress [----------------------------------] 0/99 (  0%) ?s
Progress [================================] 99/99 (100%)  0s
                                                            </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in collapse_singles(tr, show_progress): Dropping singleton nodes with
labels: mrcaott246ott2907, mrcaott246ott3600042, mrcaott246ott47588,
mrcaott246ott7113, Passeriformes, mrcaott246ott3212, mrcaott246ott428578,
mrcaott246ott44866, mrcaott246ott5929, mrcaott246ott32658, mrcaott246ott4820,
mrcaott246ott310390, mrcaott246ott176461, mrcaott246ott22325,
mrcaott246ott10351, mrcaott246ott193904, mrcaott246ott5935, mrcaott246ott1566,
mrcaott1566ott3598440, mrcaott1566ott496009, mrcaott1566ott2175,
mrcaott2175ott600902, mrcaott2175ott259082, mrcaott2175ott59905,
mrcaott2175ott2224, mrcaott2224ott366470, mrcaott3364ott310375,
mrcaott3364ott3370, mrcaott4083ott35042, mrcaott4083ott370807,
mrcaott4083ott469177, mrcaott4083ott18592, mrcaott4083ott4088,
mrcaott4088ott9416, mrcaott9416ott840030, mrcaott9416ott96148,
mrcaott9416ott7068473, Passer, mrcaott9416ott7661508, mrcaott1488ott72472,
mrcaott1488ott63797, mrcaott1488ott284404, mrcaott1488ott107463,
mrcaott1488ott17016, mrcaott1488ott107476, mrcaott1488ott104673,
mrcaott1488ott16185, mrcaott16185ott274931, Hirundinidae, mrcaott16185ott67916,
mrcaott16185ott16194, mrcaott16185ott136028, mrcaott136028ott1050413,
Tachycineta, mrcaott136028ott621794, mrcaott2375ott73144, mrcaott2375ott124085,
mrcaott2375ott71358, mrcaott2375ott814750, mrcaott2375ott61147,
mrcaott84656ott325811, mrcaott84656ott325806, mrcaott84656ott875992, Parus,
mrcaott84656ott3598691, mrcaott123763ott995871, mrcaott123763ott258794,
Accipitriformes, mrcaott1858ott1036186, mrcaott1858ott806938, Accipitridae,
Accipitrinae, mrcaott1858ott47576, mrcaott1858ott103122, mrcaott1858ott8285,
mrcaott8285ott34284, mrcaott8285ott11582, mrcaott8285ott919198,
mrcaott8285ott68001, mrcaott8285ott243416, mrcaott8285ott327100,
mrcaott8285ott376409, mrcaott8285ott33798, mrcaott8285ott33791,
mrcaott8285ott1008547, mrcaott8285ott1034654, mrcaott8285ott33792,
mrcaott33792ott458092, mrcaott33792ott120833, mrcaott33792ott34339,
mrcaott33792ott458099, mrcaott33792ott33796, mrcaott33796ott34349,
mrcaott33796ott33797, mrcaott33796ott554772, mrcaott33796ott215782,
mrcaott215782ott236917, mrcaott215782ott433865, mrcaott215782ott805051</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">is.binary</span>(tree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># here are the species included in the tree</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(tree<span class="sc">$</span>tip.label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Buteo_buteo"         "Cyanistes_caeruleus" "Parus_major"        
[4] "Passer_cinnamomeus"  "Sturnus_unicolor"    "Sturnus_vulgaris"   
[7] "Tachycineta_bicolor"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># removing the underscore "_" from the tree tip.label</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>tree<span class="sc">$</span>tip.label <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"_"</span>,<span class="st">" "</span>, tree<span class="sc">$</span>tip.label)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(tree<span class="sc">$</span>tip.label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Buteo buteo"         "Cyanistes caeruleus" "Parus major"        
[4] "Passer cinnamomeus"  "Sturnus unicolor"    "Sturnus vulgaris"   
[7] "Tachycineta bicolor"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute branch lengths of tree</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>phylo_branch <span class="ot">&lt;-</span> <span class="fu">compute.brlen</span>(tree, <span class="at">method =</span> <span class="st">"Grafen"</span>, <span class="at">power =</span> <span class="dv">1</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># check tree is ultrametric</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">is.ultrametric</span>(phylo_branch) <span class="co"># TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix to be included in the models</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>bird_phylo <span class="ot">&lt;-</span> <span class="fu">vcv</span>(phylo_branch, <span class="at">cor =</span> T)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>bird_phylo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    Sturnus unicolor Sturnus vulgaris Passer cinnamomeus
Sturnus unicolor           1.0000000        0.8333333          0.6666667
Sturnus vulgaris           0.8333333        1.0000000          0.6666667
Passer cinnamomeus         0.6666667        0.6666667          1.0000000
Tachycineta bicolor        0.1666667        0.1666667          0.1666667
Parus major                0.1666667        0.1666667          0.1666667
Cyanistes caeruleus        0.1666667        0.1666667          0.1666667
Buteo buteo                0.0000000        0.0000000          0.0000000
                    Tachycineta bicolor Parus major Cyanistes caeruleus
Sturnus unicolor              0.1666667   0.1666667           0.1666667
Sturnus vulgaris              0.1666667   0.1666667           0.1666667
Passer cinnamomeus            0.1666667   0.1666667           0.1666667
Tachycineta bicolor           1.0000000   0.6666667           0.6666667
Parus major                   0.6666667   1.0000000           0.8333333
Cyanistes caeruleus           0.6666667   0.8333333           1.0000000
Buteo buteo                   0.0000000   0.0000000           0.0000000
                    Buteo buteo
Sturnus unicolor              0
Sturnus vulgaris              0
Passer cinnamomeus            0
Tachycineta bicolor           0
Parus major                   0
Cyanistes caeruleus           0
Buteo buteo                   1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tree) <span class="co">#check: https://www.rdocumentation.org/packages/ape/versions/5.3/topics/plot.phylo</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="data_analysis_files/figure-html/unnamed-chunk-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="data_analysis_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div></div>
</section>
<section id="visualizing-random-effects-structure" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-random-effects-structure">Visualizing random effects structure</h3>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [3]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("devtools")</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"davidsjoberg/ggsankey"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Using GitHub PAT from the git credential store.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Skipping install of 'ggsankey' from a github remote, the SHA1 (b675d0d5) has not changed since last install.
  Use `force = TRUE` to force installation</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggsankey)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>sankey_data <span class="ot">&lt;-</span> dataset_analysis <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Observation_ID, repeated_trait_ID_coded, paper_ID, experiment_ID_coded, group_ID_coded)<span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(Observation_ID, repeated_trait_ID_coded, paper_ID, experiment_ID_coded, group_ID_coded), as.character)) <span class="sc">%&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_long</span>(Observation_ID, repeated_trait_ID_coded, paper_ID, experiment_ID_coded, group_ID_coded)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>sankey_data <span class="ot">&lt;-</span> dataset_analysis <span class="sc">%&gt;%</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(paper_ID, bird_species, population_ID)<span class="sc">%&gt;%</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(paper_ID, bird_species, population_ID), as.character)) <span class="sc">%&gt;%</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_long</span>(paper_ID, bird_species, population_ID)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sankey_data, <span class="fu">aes</span>(<span class="at">x =</span> x, </span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">next_x =</span> next_x, </span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">node =</span> node, </span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">next_node =</span> next_node,</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">factor</span>(node))) <span class="sc">+</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sankey</span>() <span class="sc">+</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">drop=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="data_analysis_files/figure-html/unnamed-chunk-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="data_analysis_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sankey_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">next_x =</span> next_x, <span class="at">node =</span> node, <span class="at">next_node =</span> next_node, <span class="at">fill =</span> <span class="fu">factor</span>(node))) <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_alluvial</span>(<span class="at">flow.alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">drop =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_alluvial</span>(<span class="at">base_size =</span> <span class="dv">18</span>) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="data_analysis_files/figure-html/unnamed-chunk-2-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="data_analysis_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div></div>
</section>
</section>
<section id="preparing-datasets" class="level1">
<h1>Preparing datasets</h1>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [4]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For lnRR</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting dataset which are not flagged</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>dataset_lnRR<span class="ot">&lt;-</span>dataset_analysis<span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(lnRR_sign <span class="sc">!=</span> <span class="st">"NA"</span> <span class="sc">|</span> lnRR_variance <span class="sc">!=</span> <span class="st">"NA"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(proxy_decision <span class="sc">==</span> <span class="st">"include"</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting only published dataset</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_published<span class="ot">&lt;-</span>dataset_lnRR<span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(year_publication))</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting dataset which are flagged</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>lnRR_con_flagged<span class="ot">&lt;-</span>dataset_analysis<span class="sc">%&gt;%</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(lnRR_sign <span class="sc">!=</span> <span class="st">"NA"</span> <span class="sc">|</span> lnRR_variance <span class="sc">!=</span> <span class="st">"NA"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(proxy_decision <span class="sc">!=</span> <span class="st">"SMDH only"</span> <span class="sc">|</span> proxy_decision <span class="sc">!=</span> <span class="st">"contingency table"</span> )</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting dataset without those using 0 as ES because authors reported no effect</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>lnRR_sin_missingES <span class="ot">&lt;-</span> dataset_lnRR <span class="sc">%&gt;%</span> </span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="sc">!</span>proxy_comment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"use 0 as ES"</span>))</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>lnRR_flagged_no_missingES<span class="ot">&lt;-</span> lnRR_con_flagged <span class="sc">%&gt;%</span> </span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="sc">!</span>proxy_comment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"use 0 as ES"</span>))</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a><span class="do">## For SMDH</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting dataset which are not flagged</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>dataset_SMDH<span class="ot">&lt;-</span>dataset_analysis<span class="sc">%&gt;%</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(proxy_decision <span class="sc">==</span> <span class="st">"include"</span><span class="sc">|</span> proxy_decision <span class="sc">==</span> <span class="st">"SMDH only"</span><span class="sc">|</span>proxy_decision <span class="sc">==</span><span class="st">"contingency table"</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SMDH_sign <span class="sc">!=</span> <span class="st">"NA"</span>)</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting only published dataset</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_published<span class="ot">&lt;-</span>dataset_SMDH<span class="sc">%&gt;%</span></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(year_publication))</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting dataset which are flagged</span></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>SMDH_con_flagged<span class="ot">&lt;-</span>dataset_analysis<span class="sc">%&gt;%</span></span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(SMDH_sign <span class="sc">!=</span> <span class="st">"NA"</span>)</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting dataset without those using 0 as ES because authors reported no effect</span></span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>SMDH_sin_missingES <span class="ot">&lt;-</span> dataset_SMDH <span class="sc">%&gt;%</span> </span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="sc">!</span>proxy_comment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"use 0 as ES"</span>))</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>SMDH_flagged_no_missingES<span class="ot">&lt;-</span> SMDH_con_flagged <span class="sc">%&gt;%</span> </span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="sc">!</span>proxy_comment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"use 0 as ES"</span>))</span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting dataset which are not flagged but without the SMDH calculated from inferential statistics </span></span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a>SMDH_no_inferential<span class="ot">&lt;-</span>dataset_analysis<span class="sc">%&gt;%</span></span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(proxy_decision <span class="sc">==</span> <span class="st">"include"</span>)<span class="sc">%&gt;%</span> <span class="fu">filter</span>(SMDH_sign <span class="sc">!=</span> <span class="st">"NA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
</section>
<section id="overall-effect-intercept-only-meta-analytic-model" class="level1">
<h1>Overall effect : Intercept-only meta-analytic model</h1>
<p><em>“Does adding green material to the nest have an adaptive function across the bird species that perform this behaviour?”</em></p>
<section id="using-lnrr" class="level2">
<h2 class="anchored" data-anchor-id="using-lnrr">using lnRR</h2>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [5]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>VCV_lnRR<span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>intercept_lnRR<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> dataset_lnRR)</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(intercept_lnRR, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/intercept_lnRR.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p>Exploring heterogeneity in intercept only model</p>
<p>This is the function from Yefeng’s Github for interpretting heterogeneity. I have to download the data used for this function to be able to use it. For now I am using the values from the table directly so I should just delete it later before finishing the code.</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [6]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ## Function is from the Pluralistic approach to heterogeneity from Yefeng's Pre-print repository from GitHub</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># #-----------------------heterogeneity interpretation-----------------------#</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># het_interpret &lt;- function(observed_value, het_type, es_type, data) {</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   if (!het_type %in% c("I2", "CVH", "M", "sigma2", "V_bar")) {</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     stop("Invalid heterogeneity type. Choose from 'I2', 'CVH', 'M', 'sigma2', or 'V_bar'.")</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   if (!es_type %in% unique(data$es.type)) {</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     stop("Invalid effect size type. Check the levels of 'es.type'.")</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   filtered_data &lt;- data %&gt;% filter(es.type == es_type)</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   if (nrow(filtered_data) == 0) {</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     stop("No data available for the selected effect size type.")</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   het_values &lt;- filtered_data[[het_type]]</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   percentiles &lt;- quantile(het_values, probs = seq(0, 1, by = 0.05), na.rm = TRUE)</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   lower_bound &lt;- max(percentiles[percentiles &lt;= observed_value], na.rm = TRUE)</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   upper_bound &lt;- min(percentiles[percentiles &gt;= observed_value], na.rm = TRUE)</span></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   lower_percentile &lt;- names(percentiles)[percentiles == lower_bound]</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   upper_percentile &lt;- names(percentiles)[percentiles == upper_bound]</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   percentile_range &lt;- paste0(lower_percentile, "-", upper_percentile, "th percentile")</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a><span class="co">#   # return the results</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   return(tibble::tibble(</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a><span class="co">#     observed_value = observed_value,</span></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a><span class="co">#     het_type = het_type,</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     es_type = es_type,</span></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a><span class="co">#     percentile_range = percentile_range</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   ))</span></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a><span class="co"># x&lt;-het_interpret(observed_value= I2_main_model_vector[1], </span></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a><span class="co">#                  het_type = "I2", </span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a><span class="co">#                  es_type = "lnRR_sign", </span></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a><span class="co">#                  data= intercept_lnRR)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
</section>
<section id="lnrr-heterogeneity" class="level2">
<h2 class="anchored" data-anchor-id="lnrr-heterogeneity">lnRR-heterogeneity</h2>
<p>Let us look at the heterogeneity in lnRR intercept-only model</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [7]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Then also:</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # Typical sampling variance (which captures the statistical noise of the data, </span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # but is rarely reported in the current meta-analytic practice):</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sigma2_v</span>(intercept_lnRR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0003310316</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To calculate heterogeneity, these are the functions from orchaRd:</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # I2, CV and M</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>sigma2_main_model_vector <span class="ot">&lt;-</span> <span class="fu">sum</span>(intercept_lnRR<span class="sc">$</span>sigma2)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.11, 0.27, and 0.57 for lnRR</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>I2_main_model_vector <span class="ot">&lt;-</span> orchaRd<span class="sc">::</span><span class="fu">i2_ml</span>(intercept_lnRR)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.88, 0.95, and 0.99 for lnRR</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>CV_main_model_vector <span class="ot">&lt;-</span> orchaRd<span class="sc">::</span><span class="fu">cvh1_ml</span>(intercept_lnRR)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># CVH2 (CVH1) - 1.36 (1.16), 3.76 (1.94), and 12.1 (3.48) for lnRR</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>M_main_model_vector <span class="ot">&lt;-</span> orchaRd<span class="sc">::</span><span class="fu">m1_ml</span>(intercept_lnRR)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co"># M2(M1) - 0.58 (0.54), 0.79 (0.66), and 0.78 for lnRR;</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co"># # # Total unstandardized raw variance (i.e. total heterogeneity)</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sum</span>(intercept_lnRR<span class="sc">$</span>sigma2), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.022</code></pre>
</div>
</div></div>
</section>
<section id="using-smdh" class="level2">
<h2 class="anchored" data-anchor-id="using-smdh">using SMDH</h2>
<p>We are only running these analysis for the fitness proxy labelled “included”. Some proxies have been flagged and we will run them in a sensitivity analysis only</p>
<p>their sampling variances will be fitted as variance–covariance matrices assuming a 0.5 correlation (ρs) between sampling variances from the same paper_ID (Noble et al.&nbsp;2017).</p>
<p>The MLMA using SMDH as the effect size measure incorporate the imputed sampling variance</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [8]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>VCV_SMDH <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>intercept_SMDH<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify SMDH as the effect size measure;</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH, <span class="co"># specify SMDH's sampling variance-covariance matrix;</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> dataset_SMDH)</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(intercept_SMDH, file = here::here("model/intercept_SMDH.rds"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
</section>
<section id="smdh-heterogeneity" class="level2">
<h2 class="anchored" data-anchor-id="smdh-heterogeneity">SMDH-heterogeneity</h2>
<p>Now looking at the intercept only model</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [9]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(intercept_SMDH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 258; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-328.9026   657.8052   669.8052   691.0997   670.1412   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0010     26     no        paper_ID 
sigma^2.2  0.2543  0.5043    258     no  Observation_ID 
sigma^2.3  0.0000  0.0021     47     no  group_ID_coded 
sigma^2.4  0.0000  0.0042     19     no   population_ID 
sigma^2.5  0.0000  0.0002      7     no    bird_species 

Test for Heterogeneity:
Q(df = 257) = 1124.7869, p-val &lt; .0001

Model Results:

estimate      se    tval   df    pval   ci.lb   ci.ub     
  0.1720  0.0662  2.5979  257  0.0099  0.0416  0.3024  ** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(intercept_SMDH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se  ci.lb  ci.ub   pi.lb  pi.ub 
 0.1720 0.0662 0.0416 0.3024 -0.8296 1.1736 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Then also:</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # Typical sampling variance (which captures the statistical noise of the data, </span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # but is rarely reported in the current meta-analytic practice):</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sigma2_v</span>(intercept_SMDH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1321033</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To calculate heterogeneity, these are the functions from orchaRd:</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # I2, CV and M</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>sigma2_main_model_vector <span class="ot">&lt;-</span> <span class="fu">sum</span>(intercept_SMDH<span class="sc">$</span>sigma2)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.54, 1.25, and 3.03 for SMD;</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>I2_main_model_vector <span class="ot">&lt;-</span> orchaRd<span class="sc">::</span><span class="fu">i2_ml</span>(intercept_SMDH)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.78, 0.89, and 0.96 for SMD</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.88, 0.95, and 0.99 for lnRR</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>CV_main_model_vector <span class="ot">&lt;-</span> orchaRd<span class="sc">::</span><span class="fu">cvh1_ml</span>(intercept_SMDH)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># CVH2 (CVH1) - 1.36 (1.16), 3.76 (1.94), and 12.1 (3.48) for lnRR</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>M_main_model_vector <span class="ot">&lt;-</span> orchaRd<span class="sc">::</span><span class="fu">m1_ml</span>(intercept_SMDH)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co"># M2 (M1) - 0.58 (0.54), 0.79 (0.66), and 0.78 for lnRR</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="co"># # # Total unstandardized raw variance (i.e. total heterogeneity)</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sum</span>(intercept_SMDH<span class="sc">$</span>sigma2), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.254</code></pre>
</div>
</div></div>
</section>
<section id="bivariate-meta-analytical-model" class="level2">
<h2 class="anchored" data-anchor-id="bivariate-meta-analytical-model">Bivariate Meta-analytical model</h2>
<p>For the overall effect size (i.e., the meta-analytical mean), we will run the bivariate multilevel meta-analytic model suggested by Yang et al.&nbsp;(2024), which models both lnRR and SMD(H) simultaneously (i.e., including them both as response variables and estimating their correlation; random).</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [10]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>dataset_bivariate <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">paper_ID =</span> <span class="fu">c</span>(dataset_lnRR<span class="sc">$</span>paper_ID, dataset_SMDH<span class="sc">$</span>paper_ID),</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Observation_ID =</span> <span class="fu">c</span>(dataset_lnRR<span class="sc">$</span>Observation_ID, dataset_SMDH<span class="sc">$</span>Observation_ID),</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">group_ID_coded =</span> <span class="fu">c</span>(dataset_lnRR<span class="sc">$</span>group_ID_coded, dataset_SMDH<span class="sc">$</span>group_ID_coded),</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">population_ID =</span> <span class="fu">c</span>(dataset_lnRR<span class="sc">$</span>population_ID, dataset_SMDH<span class="sc">$</span>population_ID),</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">bird_species =</span> <span class="fu">c</span>(dataset_lnRR<span class="sc">$</span>bird_species, dataset_SMDH<span class="sc">$</span>bird_species),</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ES =</span> <span class="fu">c</span>(dataset_lnRR<span class="sc">$</span>lnRR_sign, dataset_SMDH<span class="sc">$</span>SMDH_sign),</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">V_ES =</span> <span class="fu">c</span>(dataset_lnRR<span class="sc">$</span>lnRR_variance, dataset_SMDH<span class="sc">$</span>SMDH_variance),</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ES_measure =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"lnRR"</span>, <span class="fu">nrow</span>(dataset_lnRR)), <span class="fu">rep</span>(<span class="st">"SMDH"</span>, <span class="fu">nrow</span>(dataset_SMDH)))</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>VCV_bivariate <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> V_ES, <span class="co"># sampling variances of lnRR and SMD that are correlated within the same study;</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">cluster =</span> paper_ID, <span class="co"># study identity;</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">type =</span> ES_measure, <span class="co"># different types of effect size measures underlying the observed effect sizes;</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> dataset_bivariate, <span class="co"># the long format data frame;</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">rho =</span> <span class="fl">0.2</span>, <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5.</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">nearpd =</span> <span class="cn">TRUE</span> <span class="co"># specify whether impose the non positive definite VCV matrix (not invertible) to the nearest positive semi-definite matrix </span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>Bivariate_model <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> ES, <span class="co"># specify the effect size estimate (the variable ES in our case);</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">V =</span> VCV_bivariate, <span class="co"># specify the imputed variance-covariance matrix;</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">mods =</span> <span class="sc">~</span> ES_measure <span class="sc">-</span> <span class="dv">1</span>, <span class="co"># specify the variable "ES_measure" indicating the types of effect size measures;</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> ES_measure <span class="sc">|</span> paper_ID, </span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">~</span> ES_measure <span class="sc">|</span> Observation_ID,</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>                              ), <span class="co"># add correlated random effects corresponding to the lnRR and SMD parameters in the same study;</span></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">struct =</span> <span class="st">"UN"</span>, <span class="co"># impose an unstructured variance-covariance of the study-specific random effects;</span></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">test =</span> <span class="st">"t"</span>, <span class="co"># t distribution is specified to test the overall effect against the null hypothesis and construct confidence intervals;</span></span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">method =</span> <span class="st">"REML"</span>, <span class="co"># restricted likelihood maximum is assigned as the estimator for variance components as suggested;</span></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> dataset_bivariate, <span class="co"># the long format dataset</span></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">sparse =</span> T</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>               )</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(Bivariate_model, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"sensitivity_analysis/bivariate_model.rds"</span>))</span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Bivariate_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 501; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-485.9593   971.9186   993.9186  1040.2573   994.4607   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0000     47     no  group_ID_coded 
sigma^2.2  0.0000  0.0000     19     no   population_ID 
sigma^2.3  0.0000  0.0000      7     no    bird_species 

outer factor: paper_ID   (nlvls = 26)
inner factor: ES_measure (nlvls = 2)

            estim    sqrt  k.lvl  fixed  level 
tau^2.1    0.0013  0.0359     26     no   lnRR 
tau^2.2    0.1561  0.3951     26     no   SMDH 

      rho.lnRR  rho.SMDH    lnRR  SMDH 
lnRR         1                 -    26 
SMDH   -1.0000         1      no     - 

outer factor: Observation_ID (nlvls = 258)
inner factor: ES_measure     (nlvls = 2)

              estim    sqrt  k.lvl  fixed  level 
gamma^2.1    0.1264  0.3555    243     no   lnRR 
gamma^2.2    1.2527  1.1192    258     no   SMDH 

      phi.lnRR  phi.SMDH    lnRR  SMDH 
lnRR         1    0.5215       -   243 
SMDH    0.5215         1      no     - 

Test for Residual Heterogeneity:
QE(df = 499) = 16205642523.4885, p-val &lt; .0001

Test of Moderators (coefficients 1:2):
F(df1 = 2, df2 = 499) = 1.7279, p-val = 0.1787

Model Results:

                estimate      se     tval   df    pval    ci.lb   ci.ub    
ES_measurelnRR   -0.0132  0.0301  -0.4392  499  0.6607  -0.0724  0.0460    
ES_measureSMDH    0.2404  0.1365   1.7616  499  0.0788  -0.0277  0.5085  . 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [11]:</pre></div><div class="cell" data-warning="false">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(ellipse)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>ab.l <span class="ot">&lt;-</span> <span class="fu">matreg</span>(<span class="at">y=</span><span class="dv">2</span>, <span class="at">x=</span><span class="dv">1</span>, <span class="at">R=</span>Bivariate_model<span class="sc">$</span>G, <span class="at">cov=</span><span class="cn">TRUE</span>, <span class="at">means=</span><span class="fu">coef</span>(Bivariate_model), <span class="at">n=</span>Bivariate_model<span class="sc">$</span>g.levels.comb.k) <span class="co"># fit regression model</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">ellipse</span>(Bivariate_model<span class="sc">$</span>G, <span class="at">centre=</span><span class="fu">coef</span>(Bivariate_model), <span class="at">level=</span><span class="fl">0.95</span>) <span class="co"># get 95% coverage region</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>ellipse_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> xy[, <span class="dv">1</span>], <span class="at">y =</span> xy[, <span class="dv">2</span>]) <span class="co"># convert it int dataframe so that we can use ggplot to make a figure</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_wider</span>(dataset_bivariate, <span class="at">names_from =</span> ES_measure, <span class="at">values_from =</span> <span class="fu">c</span>(ES, V_ES)) <span class="sc">%&gt;%</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> ES_lnRR, <span class="at">y =</span> ES_SMDH, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(V_ES_lnRR)), <span class="at">color =</span> <span class="st">"#1B9E77"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">coef</span>(Bivariate_model)[<span class="dv">1</span>], <span class="at">y =</span> <span class="fu">coef</span>(Bivariate_model)[<span class="dv">2</span>]), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> ab.l<span class="sc">$</span>tab<span class="sc">$</span>beta[<span class="dv">1</span>], <span class="at">slope =</span> ab.l<span class="sc">$</span>tab<span class="sc">$</span>beta[<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> ellipse_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_x_continuous(limits = c(-2.5, 2.5)) + </span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_y_continuous(limits = c(-2.5, 2.5)) + </span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">size =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"lnRR"</span>, <span class="at">y =</span> <span class="st">"SMD"</span>) <span class="sc">+</span> </span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_point(aes(x = coef(Bivariate_model)[1], y = coef(Bivariate_model)[2]), : All aesthetics have length 1, but the data has 258 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 15 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="data_analysis_files/figure-html/unnamed-chunk-6-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="data_analysis_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div></div>
<p>There is a very high negative correlation between the two effect sizes. This probably is an artifact of the data and not a true correlation. If you look at the model summary, the <span class="math inline">\(tau^2\)</span> for lnRR, it is extremely small 0.0008, i.e., there is very little variance. This could also be stemming from the fact that the log values in the dataset could be causing this. For SMDH on the other hand, the <span class="math inline">\(tau^2\)</span> is 0.1681 that is much larger. This difference in the variance estimate itself could be causing this artifact of the model. I will only go ahead to present this model as a senstivity analysis because I am not completely convinced by it’s robustness.</p>
</section>
</section>
<section id="sensitivity-analysis" class="level1">
<h1>Sensitivity Analysis</h1>
<section id="sensitivity-analysis-with-published-data-only" class="level3">
<h3 class="anchored" data-anchor-id="sensitivity-analysis-with-published-data-only">Sensitivity Analysis with published data only</h3>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [12]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing new variance-covariance matrix</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_published <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_published,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Running intercept only model</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>SA_lnRR_published<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_published, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> dataset_lnRR_published)</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_lnRR_published, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"sensitivity_analysis/SA_lnRR_published.rds"</span>))</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the effect now?</span></span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SA_lnRR_published)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 226; method: REML)

  logLik  Deviance       AIC       BIC      AICc   
-18.2947   36.5895   48.5895   69.0861   48.9748   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0003     24     no        paper_ID 
sigma^2.2  0.0231  0.1520    226     no  Observation_ID 
sigma^2.3  0.0000  0.0001     44     no  group_ID_coded 
sigma^2.4  0.0000  0.0002     17     no   population_ID 
sigma^2.5  0.0000  0.0000      6     no    bird_species 

Test for Heterogeneity:
Q(df = 225) = 2260.0579, p-val &lt; .0001

Model Results:

estimate      se    tval   df    pval    ci.lb   ci.ub    
  0.0182  0.0156  1.1662  225  0.2448  -0.0126  0.0490    

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(SA_lnRR_published)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se   ci.lb  ci.ub   pi.lb  pi.ub 
 0.0182 0.0156 -0.0126 0.0490 -0.2828 0.3193 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing new variance-covariance matrix</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_published <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_published,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Running intercept only model</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>SA_SMDH_published<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_published, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> dataset_SMDH_published)</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_SMDH_published, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"sensitivity_analysis/SA_SMDH_published.rds"</span>))</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the effect now?</span></span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SA_SMDH_published)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 240; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-312.9183   625.8367   637.8367   658.6955   638.1988   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0044     24     no        paper_ID 
sigma^2.2  0.2696  0.5192    240     no  Observation_ID 
sigma^2.3  0.0001  0.0071     45     no  group_ID_coded 
sigma^2.4  0.0007  0.0259     17     no   population_ID 
sigma^2.5  0.0000  0.0014      6     no    bird_species 

Test for Heterogeneity:
Q(df = 239) = 1102.1599, p-val &lt; .0001

Model Results:

estimate      se    tval   df    pval   ci.lb   ci.ub     
  0.1846  0.0688  2.6822  239  0.0078  0.0490  0.3201  ** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(SA_SMDH_published)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se  ci.lb  ci.ub   pi.lb  pi.ub 
 0.1846 0.0688 0.0490 0.3201 -0.8486 1.2177 </code></pre>
</div>
</div></div>
</section>
<section id="sensitivity-analysis-with-flagged-proxies" class="level3">
<h3 class="anchored" data-anchor-id="sensitivity-analysis-with-flagged-proxies">Sensitivity Analysis with flagged proxies</h3>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [13]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing new variance-covariance matrix</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_flagged <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> lnRR_con_flagged,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Running intercept only model</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>SA_lnRR_flagged<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_flagged, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> lnRR_con_flagged)</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_lnRR_flagged, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"sensitivity_analysis/SA_lnRR_flagged.rds"</span>))</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the effect now?</span></span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SA_lnRR_flagged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 264; method: REML)

  logLik  Deviance       AIC       BIC      AICc   
-20.7461   41.4922   53.4922   74.9252   53.8204   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0001     28     no        paper_ID 
sigma^2.2  0.0213  0.1458    264     no  Observation_ID 
sigma^2.3  0.0000  0.0003     52     no  group_ID_coded 
sigma^2.4  0.0000  0.0001     19     no   population_ID 
sigma^2.5  0.0000  0.0000      7     no    bird_species 

Test for Heterogeneity:
Q(df = 263) = 2402.2982, p-val &lt; .0001

Model Results:

estimate      se    tval   df    pval    ci.lb   ci.ub    
  0.0221  0.0143  1.5404  263  0.1247  -0.0061  0.0503    

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(SA_lnRR_flagged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se   ci.lb  ci.ub   pi.lb  pi.ub 
 0.0221 0.0143 -0.0061 0.0503 -0.2664 0.3105 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Now for SMDH </span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing new variance-covariance matrix</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_flagged <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> SMDH_con_flagged,</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Running intercept only model</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>SA_SMDH_flagged<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_flagged, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> SMDH_con_flagged)</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_SMDH_flagged, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"sensitivity_analysis/SA_SMDH_flagged.rds"</span>))</span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the effect now?</span></span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SA_SMDH_flagged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 279; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-348.4132   696.8265   708.8265   730.5922   709.1364   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0051     28     no        paper_ID 
sigma^2.2  0.2428  0.4927    279     no  Observation_ID 
sigma^2.3  0.0074  0.0863     53     no  group_ID_coded 
sigma^2.4  0.0000  0.0039     19     no   population_ID 
sigma^2.5  0.0000  0.0032      7     no    bird_species 

Test for Heterogeneity:
Q(df = 278) = 1194.9344, p-val &lt; .0001

Model Results:

estimate      se    tval   df    pval   ci.lb   ci.ub     
  0.1876  0.0650  2.8850  278  0.0042  0.0596  0.3157  ** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(SA_SMDH_flagged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se  ci.lb  ci.ub   pi.lb  pi.ub 
 0.1876 0.0650 0.0596 0.3157 -0.8055 1.1808 </code></pre>
</div>
</div></div>
</section>
<section id="sensitivity-analysis-without-0-es" class="level3">
<h3 class="anchored" data-anchor-id="sensitivity-analysis-without-0-es">Sensitivity Analysis without 0 ES</h3>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [14]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing new variance-covariance matrix</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_no_missingES <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> lnRR_sin_missingES,</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Running intercept only model</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>SA_lnRR_no_missingES<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_no_missingES, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> lnRR_sin_missingES)</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_lnRR_no_missingES, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"sensitivity_analysis/SA_lnRR_no_missingES.rds"</span>))</span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the effect now?</span></span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SA_lnRR_no_missingES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 227; method: REML)

  logLik  Deviance       AIC       BIC      AICc   
-25.4123   50.8246   62.8246   83.3478   63.2082   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0000     26     no        paper_ID 
sigma^2.2  0.0230  0.1518    227     no  Observation_ID 
sigma^2.3  0.0000  0.0003     46     no  group_ID_coded 
sigma^2.4  0.0000  0.0000     19     no   population_ID 
sigma^2.5  0.0000  0.0000      7     no    bird_species 

Test for Heterogeneity:
Q(df = 226) = 2282.3305, p-val &lt; .0001

Model Results:

estimate      se    tval   df    pval    ci.lb   ci.ub    
  0.0176  0.0153  1.1527  226  0.2503  -0.0125  0.0478    

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(SA_lnRR_no_missingES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se   ci.lb  ci.ub   pi.lb  pi.ub 
 0.0176 0.0153 -0.0125 0.0478 -0.2830 0.3182 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Now we do this for SMDH</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing new variance-covariance matrix</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_no_missingES <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> SMDH_sin_missingES,</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Running intercept only model</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>SA_SMDH_no_missingES<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_no_missingES, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> SMDH_sin_missingES)</span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_SMDH_no_missingES, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"sensitivity_analysis/SA_SMDH_no_missingES.rds"</span>))</span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the effect now?</span></span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SA_SMDH_no_missingES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 242; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-319.9149   639.8297   651.8297   672.7385   652.1887   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0012     26     no        paper_ID 
sigma^2.2  0.2917  0.5401    242     no  Observation_ID 
sigma^2.3  0.0000  0.0019     47     no  group_ID_coded 
sigma^2.4  0.0000  0.0045     19     no   population_ID 
sigma^2.5  0.0000  0.0002      7     no    bird_species 

Test for Heterogeneity:
Q(df = 241) = 1123.5497, p-val &lt; .0001

Model Results:

estimate      se    tval   df    pval   ci.lb   ci.ub    
  0.1781  0.0696  2.5576  241  0.0112  0.0409  0.3152  * 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(SA_SMDH_no_missingES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se  ci.lb  ci.ub   pi.lb  pi.ub 
 0.1781 0.0696 0.0409 0.3152 -0.8946 1.2508 </code></pre>
</div>
</div></div>
</section>
<section id="sensitivity-analysis-with-flagged-proxies-and-no-missing-es" class="level3">
<h3 class="anchored" data-anchor-id="sensitivity-analysis-with-flagged-proxies-and-no-missing-es">Sensitivity Analysis with flagged proxies and no missing ES</h3>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [15]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing new variance-covariance matrix</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>VCV_flagged_no_missingES <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> lnRR_flagged_no_missingES,</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Running intercept only model</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>SA_lnRR_flagged_no_missingES<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_flagged_no_missingES, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> lnRR_flagged_no_missingES)</span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_lnRR_flagged_no_missingES, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"sensitivity_analysis/SA_lnRR_flagged_no_missingES.rds"</span>))</span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-30"><a href="#cb82-30" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the effect now?</span></span>
<span id="cb82-31"><a href="#cb82-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-32"><a href="#cb82-32" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SA_lnRR_flagged_no_missingES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 248; method: REML)

  logLik  Deviance       AIC       BIC      AICc   
-24.5958   49.1917   61.1917   82.2480   61.5417   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0001     28     no        paper_ID 
sigma^2.2  0.0224  0.1497    248     no  Observation_ID 
sigma^2.3  0.0000  0.0003     52     no  group_ID_coded 
sigma^2.4  0.0000  0.0000     19     no   population_ID 
sigma^2.5  0.0000  0.0000      7     no    bird_species 

Test for Heterogeneity:
Q(df = 247) = 2399.8889, p-val &lt; .0001

Model Results:

estimate      se    tval   df    pval    ci.lb   ci.ub    
  0.0222  0.0147  1.5164  247  0.1307  -0.0066  0.0511    

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(SA_lnRR_flagged_no_missingES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se   ci.lb  ci.ub   pi.lb  pi.ub 
 0.0222 0.0147 -0.0066 0.0511 -0.2740 0.3185 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="do">## with SMDH</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing new variance-covariance matrix</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_flagged_no_missingES <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> SMDH_flagged_no_missingES,</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Running intercept only model</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>SA_SMDH_flagged_no_missingES<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_flagged_no_missingES, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> SMDH_flagged_no_missingES)</span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_SMDH_flagged_no_missingES, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"sensitivity_analysis/SA_SMDH_flagged_no_missingES.rds"</span>))</span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the effect now?</span></span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SA_SMDH_flagged_no_missingES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 263; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-339.6297   679.2593   691.2593   712.6694   691.5887   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0003     28     no        paper_ID 
sigma^2.2  0.2772  0.5265    263     no  Observation_ID 
sigma^2.3  0.0001  0.0085     53     no  group_ID_coded 
sigma^2.4  0.0000  0.0001     19     no   population_ID 
sigma^2.5  0.0000  0.0000      7     no    bird_species 

Test for Heterogeneity:
Q(df = 262) = 1193.7544, p-val &lt; .0001

Model Results:

estimate      se    tval   df    pval   ci.lb   ci.ub     
  0.1914  0.0657  2.9124  262  0.0039  0.0620  0.3208  ** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(SA_SMDH_flagged_no_missingES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se  ci.lb  ci.ub   pi.lb  pi.ub 
 0.1914 0.0657 0.0620 0.3208 -0.8535 1.2363 </code></pre>
</div>
</div></div>
</section>
<section id="sensitivity-analysis-only-using-effect-sizes-calculated-from-means-sds-and-ns" class="level3">
<h3 class="anchored" data-anchor-id="sensitivity-analysis-only-using-effect-sizes-calculated-from-means-sds-and-ns">Sensitivity analysis only using effect sizes calculated from means, SDs, and ns</h3>
<p>(i.e., excluding any effect sizes calculated from inferential statistics)</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [16]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing new variance-covariance matrix</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_no_inferential <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> SMDH_no_inferential,</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Running intercept only model</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>SA_SMDH_no_inferential<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_no_inferential, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> SMDH_no_inferential)</span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb90-28"><a href="#cb90-28" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_SMDH_no_inferential, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"sensitivity_analysis/SA_SMDH_no_inferential.rds"</span>))</span>
<span id="cb90-29"><a href="#cb90-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-30"><a href="#cb90-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-31"><a href="#cb90-31" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the effect now?</span></span>
<span id="cb90-32"><a href="#cb90-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-33"><a href="#cb90-33" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SA_SMDH_no_inferential)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 250; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-322.7054   645.4108   657.4108   678.5155   657.7579   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0048     26     no        paper_ID 
sigma^2.2  0.2623  0.5122    250     no  Observation_ID 
sigma^2.3  0.0001  0.0088     46     no  group_ID_coded 
sigma^2.4  0.0004  0.0204     19     no   population_ID 
sigma^2.5  0.0000  0.0013      7     no    bird_species 

Test for Heterogeneity:
Q(df = 249) = 1110.1810, p-val &lt; .0001

Model Results:

estimate      se    tval   df    pval   ci.lb   ci.ub    
  0.1721  0.0680  2.5298  249  0.0120  0.0381  0.3061  * 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(SA_SMDH_no_inferential)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se  ci.lb  ci.ub   pi.lb  pi.ub 
 0.1721 0.0680 0.0381 0.3061 -0.8465 1.1907 </code></pre>
</div>
</div></div>
</section>
<section id="sensitivity-analysis-excluding-the-parasite-and-pathogen-load-fitness-proxies" class="level3">
<h3 class="anchored" data-anchor-id="sensitivity-analysis-excluding-the-parasite-and-pathogen-load-fitness-proxies">Sensitivity Analysis excluding the parasite and pathogen load fitness proxies</h3>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [17]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For the lnRR effect size...</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_no_PCH<span class="ot">&lt;-</span>dataset_lnRR<span class="sc">%&gt;%</span><span class="fu">filter</span>(Hypothesis<span class="sc">!=</span><span class="st">"PCH"</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="do">## The dataset is reduced to almost half</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(dataset_lnRR)<span class="sc">-</span><span class="fu">nrow</span>(dataset_lnRR_no_PCH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 109</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_no_PCH <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_no_PCH,</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>SA_lnRR_no_PCH<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_no_PCH, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> dataset_lnRR_no_PCH)</span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a><span class="do">## For the SMDH effect size..</span></span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_no_PCH<span class="ot">&lt;-</span>dataset_SMDH<span class="sc">%&gt;%</span><span class="fu">filter</span>(Hypothesis<span class="sc">!=</span><span class="st">"PCH"</span>)</span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a><span class="do">## The dataset is reduced to almost half</span></span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(dataset_SMDH)<span class="sc">-</span><span class="fu">nrow</span>(dataset_SMDH_no_PCH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 118</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_no_PCH <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_no_PCH,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>SA_SMDH_no_PCH<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_no_PCH, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> dataset_SMDH_no_PCH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
</section>
<section id="sensitivity-analysis-for-excluding-non-aromatic-and-blank-the-two-control-group-comparison" class="level3">
<h3 class="anchored" data-anchor-id="sensitivity-analysis-for-excluding-non-aromatic-and-blank-the-two-control-group-comparison">Sensitivity Analysis for excluding non-aromatic and blank (the two control group comparison)</h3>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [18]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For the lnRR effect size...</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_no_comp3<span class="ot">&lt;-</span>dataset_lnRR<span class="sc">%&gt;%</span><span class="fu">filter</span>(comparision_type<span class="sc">!=</span><span class="dv">3</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Only some rows are removed... </span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(dataset_lnRR)<span class="sc">-</span><span class="fu">nrow</span>(dataset_lnRR_no_comp3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 27</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_no_comp3 <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_no_comp3,</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>SA_lnRR_no_PCH<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_no_PCH, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> dataset_lnRR_no_PCH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
</section>
<section id="different-values-of-sampling-variance-correlation" class="level3">
<h3 class="anchored" data-anchor-id="different-values-of-sampling-variance-correlation">Different values of sampling variance correlation</h3>
<p><u><strong>Robust variance estimation to guard against arbitary value of sampling correlation</strong></u> - ‘robust()’ function from R package ‘metafor’ (Viechtbauer 2010) using ‘CR2’ (bias reduced linearization correction) from the R package ‘clubSandwich’ (Pustejovsky 2024) for small-sample size adjustment.</p>
<p>At the moment, this is not working..</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [19]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">#MLMA_lnRR_RVE&lt;- robust(MLMA_lnRR_VCV,</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                        cluster = paper_ID,</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                        clubSandwich = TRUE,</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                        verbose=T)</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # summary(MLMA_lnRR_RVE)</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="co"># I2_CI &lt;- i2_ml(MLMA_lnRR_RVE) # Relative heterogeneity</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="co"># round(I2_CI,2) # absolute heterogeneity is reported in the summary of the model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sensitivity Analysis</p>
<p>We will also perform a sensitivity analysis using 0.3 and 0.7 correlation between the sampling variances from the same paper_ID and report it in the supplementary materials. If this sensitivity analysis shows large differences in conclusions for the intercept-only model, we will proceed to perform such sensitivity analysis for the meta-regressions.</p>
</div>
</div>
<p>First, set a series of ρs (i.e., 0.3, 0.5, 0.7) (we assume these values arbitrarily):</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [20]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rho_range &lt;- c(0.3, 0.5, 0.7)</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="co"># MLMAlnRR_VCV_range &lt;- list() # repeatedly run the specified model with varying rho</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:length(rho_range))</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="co"># {VCV_range &lt;- vcalc(vi = lnRR_variance,</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                   cluster = paper_ID,</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                   subgroup = group_ID,</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                   obs = Observation_ID,</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                   data = dataset_lnRR,</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                    rho = rho_range[i],</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                     ) # impute sampling variance covariance matrix with varying rho</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a><span class="co"># MLMAlnRR_VCV_range[[i]] &lt;- rma.mv(yi = lnRR_sign,</span></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                                   V = VCV_range, # sampling variance covariance matrix with varying values of rho.</span></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  random = list(~ 1 | paper_ID,</span></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                                   ~ 1 | Observation_ID,</span></span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a><span class="co">#                                   ~ 1 | experiment_ID,</span></span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a><span class="co">#                                   ~ 1 | group_ID,</span></span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a><span class="co">#                                   ~ 1 | repeated_trait_ID),</span></span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a><span class="co">#                                   method = "REML",</span></span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a><span class="co">#                                   data = dataset_lnRR # run the model with varying rho</span></span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb103-24"><a href="#cb103-24" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb103-25"><a href="#cb103-25" aria-hidden="true" tabindex="-1"></a><span class="co"># save(VCV_range, file = here::here("GNM/figures/VCV_range.Rdata"))</span></span>
<span id="cb103-26"><a href="#cb103-26" aria-hidden="true" tabindex="-1"></a><span class="co"># save(MLMAlnRR_VCV_range, file = here::here("GNM/figures/MLMAlnRR_VCV_range.Rdata"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [21]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># t4 &lt;- data.frame(rho  = rho_range,</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                  "overall effect"  = sapply(MLMAlnRR_VCV_range, function(x) coef(x)),</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                  "standard error" = sapply(MLMAlnRR_VCV_range, function(x) x$se),</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                  "p-value" = sapply(MLMAlnRR_VCV_range, function(x) x$pval),</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                  "Lower CI" = sapply(MLMAlnRR_VCV_range, function(x) x$ci.lb),</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                  "Upper CI" = sapply(MLMAlnRR_VCV_range, function(x) x$ci.ub),</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                  "Log-likehood" = sapply(MLMAlnRR_VCV_range, function(x) fitstats(x)[1,1]),</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                  "AIC" = sapply(MLMAlnRR_VCV_range, function(x) fitstats(x)[3,1]),</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                  "BIC" = sapply(MLMAlnRR_VCV_range, function(x) fitstats(x)[4,1]),</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                  "AICc" = sapply(MLMAlnRR_VCV_range, function(x) fitstats(x)[5,1]))</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(t4) &lt;- c("Sampling correlation", "Overall effect (lnRR)", "Standard error", "p-value", "Lower CI", "Upper CI", "Log-likehood", "AIC", "BIC", "AICc")</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a><span class="co"># t4 %&gt;% dfround(4) %&gt;% DT::datatable()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
</section>
</section>
<section id="mechanistic-hypothesis" class="level1">
<h1>Mechanistic Hypothesis</h1>
<p>To address our secondary questions “Does the addition of green nest material by birds increase their reproductive success? (Courtship hypothesis)” and “Does the addition of green nest material have protective effects and health benefits for the nestlings? (Parental care hypothesis)”, we will make use of the unimoderator multilevel meta-regressions hypothesis type (levels: CH, PCH, Both) as the moderator.</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [22]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>lnRR_hypothesis <span class="ot">&lt;-</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> Hypothesis,</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR)</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_hypothesis, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_hypothesis.rds"</span>))</span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>lnRR_hypothesis_R2 <span class="ot">&lt;-</span> <span class="fu">r2_ml</span>(lnRR_hypothesis)</span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(lnRR_hypothesis_R2 <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   R2_marginal R2_conditional 
           1.7            1.7 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>SMDH_hypothesis <span class="ot">&lt;-</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> Hypothesis,</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH)</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_hypothesis, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_hypothesis.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
</section>
<section id="exploratory-analysis" class="level1">
<h1>Exploratory Analysis</h1>
<p>For our exploratory analyses (see section Exploratory Analyses), we will run unimoderator multilevel meta-regressions using the following moderators:</p>
<section id="type-of-parasites" class="level4">
<h4 class="anchored" data-anchor-id="type-of-parasites">Type of parasites</h4>
<p>(levels: arthropods, micro-organisms)&nbsp;</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [23]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This analysis only includes dataset that has a proxy relating to parasite or pathogen</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_parasite <span class="ot">&lt;-</span> dataset_lnRR<span class="sc">%&gt;%</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(parasite_type))<span class="sc">%&gt;%</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">parasite_type=</span><span class="fu">as.factor</span>(parasite_type),</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">paper_ID=</span><span class="fu">as.factor</span>(paper_ID),</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Observation_ID=</span><span class="fu">as.factor</span>(Observation_ID),</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">group_ID_coded=</span><span class="fu">as.factor</span>(group_ID_coded),</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">bird_species=</span><span class="fu">as.factor</span>(bird_species))</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_parasite <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_parasite,</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>lnRR_parasite <span class="ot">&lt;-</span></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_parasite,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> parasite_type,</span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a>                   <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb108-28"><a href="#cb108-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb108-29"><a href="#cb108-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_parasite)</span>
<span id="cb108-30"><a href="#cb108-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-31"><a href="#cb108-31" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>( lnRR_parasite, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_parasite.rds"</span>))</span>
<span id="cb108-32"><a href="#cb108-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-33"><a href="#cb108-33" aria-hidden="true" tabindex="-1"></a><span class="do">### Similiarly for SMDH as well selecting the dataset with parasite type</span></span>
<span id="cb108-34"><a href="#cb108-34" aria-hidden="true" tabindex="-1"></a><span class="co"># This analysis only includes dataset that has a proxy relating to parasite or pathogen</span></span>
<span id="cb108-35"><a href="#cb108-35" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_parasite <span class="ot">&lt;-</span> dataset_SMDH<span class="sc">%&gt;%</span></span>
<span id="cb108-36"><a href="#cb108-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(parasite_type))</span>
<span id="cb108-37"><a href="#cb108-37" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_parasite <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb108-38"><a href="#cb108-38" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb108-39"><a href="#cb108-39" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb108-40"><a href="#cb108-40" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_parasite,</span>
<span id="cb108-41"><a href="#cb108-41" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb108-42"><a href="#cb108-42" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb108-43"><a href="#cb108-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-44"><a href="#cb108-44" aria-hidden="true" tabindex="-1"></a>SMDH_parasite <span class="ot">&lt;-</span></span>
<span id="cb108-45"><a href="#cb108-45" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb108-46"><a href="#cb108-46" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_parasite,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb108-47"><a href="#cb108-47" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> parasite_type,</span>
<span id="cb108-48"><a href="#cb108-48" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb108-49"><a href="#cb108-49" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb108-50"><a href="#cb108-50" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb108-51"><a href="#cb108-51" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb108-52"><a href="#cb108-52" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb108-53"><a href="#cb108-53" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb108-54"><a href="#cb108-54" aria-hidden="true" tabindex="-1"></a>                   <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb108-55"><a href="#cb108-55" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb108-56"><a href="#cb108-56" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_parasite)</span>
<span id="cb108-57"><a href="#cb108-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-58"><a href="#cb108-58" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb108-59"><a href="#cb108-59" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_parasite, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_parasite.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
</section>
<section id="time-of-addition-of-green-nest-material" class="level4">
<h4 class="anchored" data-anchor-id="time-of-addition-of-green-nest-material">Time of addition of green nest material</h4>
<p>(levels: before egg hatching, after egg hatching, continuously throughout the nesting phase).</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [24]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="do">## We use the complete dataset in this case</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>lnRR_time_gnm_addition <span class="ot">&lt;-</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR,<span class="co"># specify lnRR's sampling variance using the variance-covariance matrix we created for the intercept-only model since the whole dataset is being used in this case as well</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> time_of_gnm_addition,</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR)</span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_time_gnm_addition, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_time_gnm_addition.rds"</span>))</span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Now similarly for the SMDH effect size using the complete dataset</span></span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>SMDH_time_gnm_addition <span class="ot">&lt;-</span></span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH,<span class="co"># specify lnRR's sampling variance using the variance-covariance matrix we created for the intercept-only model since the whole dataset is being used in this case as well</span></span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> time_of_gnm_addition,</span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb109-28"><a href="#cb109-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb109-29"><a href="#cb109-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb109-30"><a href="#cb109-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb109-31"><a href="#cb109-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH)</span>
<span id="cb109-32"><a href="#cb109-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-33"><a href="#cb109-33" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_time_gnm_addition, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_time_gnm_addition.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
</section>
<section id="type-of-experimental-design" class="level4">
<h4 class="anchored" data-anchor-id="type-of-experimental-design">Type of experimental design</h4>
<p>(levels: 1 = non-aromatic vs.&nbsp;aromatic, 2 = no added material vs.&nbsp;aromatic, 3 = no added material vs.&nbsp;non-aromatic).</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [25]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This analysis only includes dataset that has a proxy relating to comaparision type</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_design <span class="ot">&lt;-</span> dataset_lnRR <span class="sc">%&gt;%</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comparision_type=</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(comparision_type) <span class="sc">~</span> <span class="dv">4</span>, <span class="cn">TRUE</span> <span class="sc">~</span> comparision_type))</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_design <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_design,</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>lnRR_design <span class="ot">&lt;-</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_design ,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">as.factor</span>(comparision_type),</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_design )</span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-25"><a href="#cb110-25" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_design, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_design.rds"</span>))</span>
<span id="cb110-26"><a href="#cb110-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-27"><a href="#cb110-27" aria-hidden="true" tabindex="-1"></a><span class="co"># This analysis only includes dataset that has a proxy relating to comaparision type</span></span>
<span id="cb110-28"><a href="#cb110-28" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_design <span class="ot">&lt;-</span> dataset_SMDH <span class="sc">%&gt;%</span></span>
<span id="cb110-29"><a href="#cb110-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comparision_type=</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(comparision_type) <span class="sc">~</span> <span class="dv">4</span>, <span class="cn">TRUE</span> <span class="sc">~</span> comparision_type))</span>
<span id="cb110-30"><a href="#cb110-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-31"><a href="#cb110-31" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_design <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb110-32"><a href="#cb110-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb110-33"><a href="#cb110-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb110-34"><a href="#cb110-34" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_design,</span>
<span id="cb110-35"><a href="#cb110-35" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb110-36"><a href="#cb110-36" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb110-37"><a href="#cb110-37" aria-hidden="true" tabindex="-1"></a>SMDH_design <span class="ot">&lt;-</span></span>
<span id="cb110-38"><a href="#cb110-38" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb110-39"><a href="#cb110-39" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_design ,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb110-40"><a href="#cb110-40" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">as.factor</span>(comparision_type),</span>
<span id="cb110-41"><a href="#cb110-41" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb110-42"><a href="#cb110-42" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb110-43"><a href="#cb110-43" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb110-44"><a href="#cb110-44" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb110-45"><a href="#cb110-45" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb110-46"><a href="#cb110-46" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb110-47"><a href="#cb110-47" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb110-48"><a href="#cb110-48" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb110-49"><a href="#cb110-49" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_design )</span>
<span id="cb110-50"><a href="#cb110-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-51"><a href="#cb110-51" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_design, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_design.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p>Let me try to do a sensitivity analysis to see what happens when I remove the control condition of 3 in the overall model since that is expected to not have an effect according to the authors as well.. i.e.&nbsp;it is a double control..</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [26]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_remove3<span class="ot">&lt;-</span>dataset_lnRR<span class="sc">%&gt;%</span><span class="fu">filter</span>(<span class="fu">is.na</span>(comparision_type) <span class="sc">|</span> comparision_type<span class="sc">!=</span><span class="st">"3"</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_remove3 <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_remove3,</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>lnRR_remove3 <span class="ot">&lt;-</span></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_remove3 ,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb111-22"><a href="#cb111-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_remove3 )</span>
<span id="cb111-23"><a href="#cb111-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-24"><a href="#cb111-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Now for SMDH</span></span>
<span id="cb111-25"><a href="#cb111-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-26"><a href="#cb111-26" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_remove3<span class="ot">&lt;-</span>dataset_SMDH<span class="sc">%&gt;%</span><span class="fu">filter</span>(<span class="fu">is.na</span>(comparision_type) <span class="sc">|</span> comparision_type<span class="sc">!=</span><span class="st">"3"</span>)</span>
<span id="cb111-27"><a href="#cb111-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-28"><a href="#cb111-28" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_remove3 <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb111-29"><a href="#cb111-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb111-30"><a href="#cb111-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb111-31"><a href="#cb111-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_remove3,</span>
<span id="cb111-32"><a href="#cb111-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb111-33"><a href="#cb111-33" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb111-34"><a href="#cb111-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-35"><a href="#cb111-35" aria-hidden="true" tabindex="-1"></a>SMDH_remove3 <span class="ot">&lt;-</span></span>
<span id="cb111-36"><a href="#cb111-36" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb111-37"><a href="#cb111-37" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_remove3 ,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb111-38"><a href="#cb111-38" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb111-39"><a href="#cb111-39" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb111-40"><a href="#cb111-40" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb111-41"><a href="#cb111-41" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb111-42"><a href="#cb111-42" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb111-43"><a href="#cb111-43" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb111-44"><a href="#cb111-44" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb111-45"><a href="#cb111-45" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb111-46"><a href="#cb111-46" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb111-47"><a href="#cb111-47" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_remove3 )</span>
<span id="cb111-48"><a href="#cb111-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-49"><a href="#cb111-49" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SMDH_remove3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 246; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-287.7625   575.5250   587.5250   608.5326   587.8779   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0002     26     no        paper_ID 
sigma^2.2  0.2338  0.4836    246     no  Observation_ID 
sigma^2.3  0.0000  0.0008     47     no  group_ID_coded 
sigma^2.4  0.0000  0.0002     19     no   population_ID 
sigma^2.5  0.0000  0.0000      7     no    bird_species 

Test for Heterogeneity:
Q(df = 245) = 1048.0795, p-val &lt; .0001

Model Results:

estimate      se    tval   df    pval   ci.lb   ci.ub    
  0.1415  0.0654  2.1618  245  0.0316  0.0126  0.2703  * 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div></div>
<p>Results remain practically the same irrespective..</p>
</section>
<section id="bird-species" class="level4">
<h4 class="anchored" data-anchor-id="bird-species">Bird species</h4>
<p>(levels: Cyanistes caeruleus, Sturnus unicolor, Tachycineta bicolor, Sturnus vulgaris; note that these levels reflect the list of species studied in our current database, which may increase after updating our search and/or receiving unpublished data from authors)</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [27]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>lnRR_birds <span class="ot">&lt;-</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> bird_species,</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR)</span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_birds, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_birds.rds"</span>))</span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Now doing this for SMDH</span></span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>SMDH_birds <span class="ot">&lt;-</span></span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> bird_species,</span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb113-29"><a href="#cb113-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb113-30"><a href="#cb113-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb113-31"><a href="#cb113-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH)</span>
<span id="cb113-32"><a href="#cb113-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-33"><a href="#cb113-33" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_birds, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_birds.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
</section>
<section id="type-of-trait-studied" class="level4">
<h4 class="anchored" data-anchor-id="type-of-trait-studied">Type of trait studied</h4>
<p>(levels:physiology, morphology, reproduction, behaviour, parasite and pathogenic load, phenology)</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [28]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>lnRR_trait <span class="ot">&lt;-</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> trait_type,</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR)</span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_trait, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_trait.rds"</span>))</span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Now similarly for SMDH</span></span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a>SMDH_trait <span class="ot">&lt;-</span></span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> trait_type,</span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb114-30"><a href="#cb114-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb114-31"><a href="#cb114-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH)</span>
<span id="cb114-32"><a href="#cb114-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-33"><a href="#cb114-33" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_trait, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_trait.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
</section>
</section>
<section id="sensitivity-analyses-robustness-checks" class="level1">
<h1><strong>Sensitivity analyses / robustness checks</strong></h1>
<p>We will run several sensitivity analyses using the same random effect structure as described above aimed at ensuring the robustness of our results.&nbsp;</p>
<ol start="3" type="1">
<li><p>We will re-run our intercept-only multivariate meta-analysis (with both lnRR and SMDH as effect sizes) using 0.3 and 0.7 correlation (ρs) between sampling variances from the same paper_ID. If we find large differences in conclusions depending on ρs, we will run the corresponding sensitivity analyses for all our meta-regressions as well.</p></li>
<li><p>If during our analyses we notice the need to run additional sensitivity analyses to ensure the robustness of our results, we will label those analyses as non-pre-registered and report them in the supplementary materials of the eventual manuscript.</p></li>
</ol>
<section id="risk-of-bias" class="level3">
<h3 class="anchored" data-anchor-id="risk-of-bias">Risk of Bias</h3>
<p>6. Blinding: (Levels: yes, no(</p>
<p>7. Random Assignment: (Levels: yes, no)</p>
<p>8. Missing Data: (Levels: yes, no)</p>
<p>Note that the specific subset of data for each meta-regression may differ based on the data availability (e.g., information about the type of parasites is only available for effect sizes based on parasite/pathogen related fitness proxy). We will conduct meta-regression on suitable subsets of data for each analysis, provided we have sufficient effect sizes per moderator level (i.e., at least 5 effect sizes per moderator level).</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Phylogenetic Effects
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note also that if we obtain additional effect sizes for other bird species after we update our search and/or contact authors, our models may need to account for phylogenetic nonindependence via the inclusion of two additional random effects: “species” and “phylogeny” following Cinar et al.&nbsp;(2022).</p>
</div>
</div>
</section>
<section id="other-analysis" class="level2">
<h2 class="anchored" data-anchor-id="other-analysis">Other Analysis</h2>
<section id="risk-of-bias-assessment" class="level3">
<h3 class="anchored" data-anchor-id="risk-of-bias-assessment">Risk of Bias Assessment</h3>
<ul>
<li>RoB - The outcome will be presented in the form of a <u><strong>summary table</strong></u>. We will conduct uni-moderator meta-regressions using these variables.</li>
</ul>
</section>
</section>
<section id="publication-bias" class="level2">
<h2 class="anchored" data-anchor-id="publication-bias">Publication Bias</h2>
<p>Small study effects:</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [29]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_published<span class="ot">&lt;-</span>dataset_lnRR_published<span class="sc">%&gt;%</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">effective_n_inv=</span><span class="dv">1</span><span class="sc">/</span>((<span class="dv">4</span><span class="sc">*</span>effective_n_experiment<span class="sc">*</span>effective_n_control)<span class="sc">/</span>(effective_n_experiment<span class="sc">+</span>effective_n_control)))<span class="sc">%&gt;%</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sqrt_effective_n_inv=</span><span class="fu">sqrt</span>(effective_n_inv))</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>lnRR_small_study <span class="ot">&lt;-</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_published,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span>sqrt_effective_n_inv,</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_published)</span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_small_study, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_small_study.rds"</span>))</span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lnRR_small_study)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 226; method: REML)

  logLik  Deviance       AIC       BIC      AICc   
-18.6565   37.3131   51.3131   75.1946   51.8316   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0003     24     no        paper_ID 
sigma^2.2  0.0231  0.1520    226     no  Observation_ID 
sigma^2.3  0.0000  0.0001     44     no  group_ID_coded 
sigma^2.4  0.0000  0.0002     17     no   population_ID 
sigma^2.5  0.0000  0.0000      6     no    bird_species 

Test for Residual Heterogeneity:
QE(df = 224) = 2237.9769, p-val &lt; .0001

Test of Moderators (coefficient 2):
F(df1 = 1, df2 = 224) = 0.2422, p-val = 0.6231

Model Results:

                      estimate      se    tval   df    pval    ci.lb   ci.ub    
intrcpt                 0.0035  0.0338  0.1037  224  0.9175  -0.0630  0.0700    
sqrt_effective_n_inv    0.0705  0.1433  0.4921  224  0.6231  -0.2119  0.3530    

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">r2_ml</span>(lnRR_small_study)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   R2_marginal R2_conditional 
          0.28           0.28 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Now for SMDH model</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_published<span class="ot">&lt;-</span>dataset_SMDH_published<span class="sc">%&gt;%</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">effective_n_inv=</span><span class="dv">1</span><span class="sc">/</span>((<span class="dv">4</span><span class="sc">*</span>effective_n_experiment<span class="sc">*</span>effective_n_control)<span class="sc">/</span>(effective_n_experiment<span class="sc">+</span>effective_n_control)))<span class="sc">%&gt;%</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sqrt_effective_n_inv=</span><span class="fu">sqrt</span>(effective_n_inv))</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>SMDH_small_study <span class="ot">&lt;-</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_published,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span>sqrt_effective_n_inv,</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_published)</span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_small_study, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_small_study.rds"</span>))</span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SMDH_small_study)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 240; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-310.2823   620.5646   634.5646   658.8705   635.0515   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0004     24     no        paper_ID 
sigma^2.2  0.2683  0.5180    240     no  Observation_ID 
sigma^2.3  0.0000  0.0011     45     no  group_ID_coded 
sigma^2.4  0.0000  0.0005     17     no   population_ID 
sigma^2.5  0.0000  0.0001      6     no    bird_species 

Test for Residual Heterogeneity:
QE(df = 238) = 1100.1351, p-val &lt; .0001

Test of Moderators (coefficient 2):
F(df1 = 1, df2 = 238) = 2.8479, p-val = 0.0928

Model Results:

                      estimate      se     tval   df    pval    ci.lb   ci.ub 
intrcpt                -0.0290  0.1434  -0.2022  238  0.8399  -0.3114  0.2535 
sqrt_effective_n_inv    1.3096  0.7760   1.6876  238  0.0928  -0.2191  2.8383 
                        
intrcpt                 
sqrt_effective_n_inv  . 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">r2_ml</span>(SMDH_small_study)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   R2_marginal R2_conditional 
          7.46           7.46 </code></pre>
</div>
</div></div>
<p>Decline effects (Time lag bias)</p>
<p>Next, run a uni-moderator meta-regression to test for evidence of decline effects (also known as time-lag bias) which includes year of publication (mean-centered) as the only moderator, and whose slope would provide information about whether the overall effect size has changed (decline) over time (Nakagawa et al.&nbsp;2022; Sánchez-Tójar et al.&nbsp;2018).</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [30]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_published<span class="ot">&lt;-</span>dataset_lnRR_published<span class="sc">%&gt;%</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_MeanCenter=</span><span class="fu">scale</span>(<span class="fu">as.numeric</span>(year_publication),<span class="at">scale=</span>F)[,<span class="dv">1</span>])</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>lnRR_decline_eff <span class="ot">&lt;-</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_published,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> year_MeanCenter,</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_published)</span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_decline_eff, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_decline_eff.rds"</span>))</span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lnRR_decline_eff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 226; method: REML)

  logLik  Deviance       AIC       BIC      AICc   
-18.0408   36.0815   50.0815   73.9630   50.6000   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0001     24     no        paper_ID 
sigma^2.2  0.0222  0.1491    226     no  Observation_ID 
sigma^2.3  0.0000  0.0002     44     no  group_ID_coded 
sigma^2.4  0.0000  0.0001     17     no   population_ID 
sigma^2.5  0.0000  0.0000      6     no    bird_species 

Test for Residual Heterogeneity:
QE(df = 224) = 1999.1758, p-val &lt; .0001

Test of Moderators (coefficient 2):
F(df1 = 1, df2 = 224) = 1.5457, p-val = 0.2151

Model Results:

                 estimate      se     tval   df    pval    ci.lb   ci.ub    
intrcpt            0.0193  0.0154   1.2529  224  0.2116  -0.0111  0.0497    
year_MeanCenter   -0.0018  0.0015  -1.2433  224  0.2151  -0.0047  0.0011    

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">r2_ml</span>(lnRR_decline_eff)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   R2_marginal R2_conditional 
          1.81           1.81 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="do">## --- Now for SMDH -----</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_published<span class="ot">&lt;-</span>dataset_SMDH_published<span class="sc">%&gt;%</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_MeanCenter=</span><span class="fu">scale</span>(<span class="fu">as.numeric</span>(year_publication),<span class="at">scale=</span>F)[,<span class="dv">1</span>])</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>SMDH_decline_eff <span class="ot">&lt;-</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_published,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> year_MeanCenter,</span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_published)</span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb127-21"><a href="#cb127-21" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_decline_eff, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_decline_eff.rds"</span>))</span>
<span id="cb127-22"><a href="#cb127-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-23"><a href="#cb127-23" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SMDH_decline_eff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 240; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-311.0891   622.1783   636.1783   660.4842   636.6652   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0014     24     no        paper_ID 
sigma^2.2  0.2678  0.5175    240     no  Observation_ID 
sigma^2.3  0.0000  0.0030     45     no  group_ID_coded 
sigma^2.4  0.0229  0.1513     17     no   population_ID 
sigma^2.5  0.0000  0.0001      6     no    bird_species 

Test for Residual Heterogeneity:
QE(df = 238) = 1101.7199, p-val &lt; .0001

Test of Moderators (coefficient 2):
F(df1 = 1, df2 = 238) = 1.1225, p-val = 0.2905

Model Results:

                 estimate      se     tval   df    pval    ci.lb   ci.ub    
intrcpt            0.2056  0.0802   2.5637  238  0.0110   0.0476  0.3636  * 
year_MeanCenter   -0.0087  0.0082  -1.0595  238  0.2905  -0.0250  0.0075    

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">r2_ml</span>(SMDH_decline_eff)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   R2_marginal R2_conditional 
          3.06          10.70 </code></pre>
</div>
</div></div>
<p>Last, run an all-in meta-regression including both the (square root of the) inverse of the ‘effective sample size’ and the mean-centered year of publication as well as all the other moderators tested in our study to estimate how much heterogeneity is explained by all moderators combined as well as to explore whether evidence remains similar after accounting for all the other moderators (see equation 29 in Nakagawa et al.&nbsp;2022 for more information about this approach).&nbsp;</p>
</section>
<section id="all-in-model-for-heterogeneity" class="level2">
<h2 class="anchored" data-anchor-id="all-in-model-for-heterogeneity">All-in Model for heterogeneity</h2>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [31]:</pre></div><div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For lnRR complete dataset</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="do">## I am changing the year of unpublished studies to 2025 which is to now, assuming that if they were to be published now, what would be the effect. I will keep in mind that in this model if I do find an evidence of publication bias over years, I should keep in mind it is non-independent of the unpublished studies</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_all_in<span class="ot">&lt;-</span>dataset_lnRR<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">year_publication =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(year_publication) <span class="sc">~</span> <span class="dv">2025</span>, <span class="cn">TRUE</span> <span class="sc">~</span> year_publication))<span class="sc">%&gt;%</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_MeanCenter=</span><span class="fu">scale</span>(<span class="fu">as.numeric</span>(year_publication),<span class="at">scale=</span>F)[,<span class="dv">1</span>])<span class="sc">%&gt;%</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">effective_n_inv=</span><span class="dv">1</span><span class="sc">/</span>((<span class="dv">4</span><span class="sc">*</span>effective_n_experiment<span class="sc">*</span>effective_n_control)<span class="sc">/</span>(effective_n_experiment<span class="sc">+</span>effective_n_control)))<span class="sc">%&gt;%</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sqrt_effective_n_inv=</span><span class="fu">sqrt</span>(effective_n_inv))<span class="sc">%&gt;%</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comparision_type=</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(comparision_type) <span class="sc">~</span> <span class="dv">4</span>, <span class="cn">TRUE</span> <span class="sc">~</span> comparision_type))</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_all_in<span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_all_in,</span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>lnRR_all_in <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_all_in, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> time_of_gnm_addition <span class="sc">+</span> </span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a>                      year_MeanCenter <span class="sc">+</span> </span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a>                      sqrt_effective_n_inv <span class="sc">+</span> </span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">as.factor</span>(comparision_type) <span class="sc">+</span> </span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a>                      bird_species <span class="sc">+</span> </span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a>                      trait_type,</span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb131-31"><a href="#cb131-31" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb131-32"><a href="#cb131-32" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb131-33"><a href="#cb131-33" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb131-34"><a href="#cb131-34" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> dataset_lnRR_all_in)</span>
<span id="cb131-35"><a href="#cb131-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-36"><a href="#cb131-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-37"><a href="#cb131-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-38"><a href="#cb131-38" aria-hidden="true" tabindex="-1"></a><span class="do">## For SMDH complete published dataset</span></span>
<span id="cb131-39"><a href="#cb131-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-40"><a href="#cb131-40" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_all_in<span class="ot">&lt;-</span>dataset_SMDH<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">year_publication =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(year_publication) <span class="sc">~</span> <span class="dv">2025</span>, <span class="cn">TRUE</span> <span class="sc">~</span> year_publication))<span class="sc">%&gt;%</span></span>
<span id="cb131-41"><a href="#cb131-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_MeanCenter=</span><span class="fu">scale</span>(<span class="fu">as.numeric</span>(year_publication),<span class="at">scale=</span>F)[,<span class="dv">1</span>])<span class="sc">%&gt;%</span></span>
<span id="cb131-42"><a href="#cb131-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">effective_n_inv=</span><span class="dv">1</span><span class="sc">/</span>((<span class="dv">4</span><span class="sc">*</span>effective_n_experiment<span class="sc">*</span>effective_n_control)<span class="sc">/</span>(effective_n_experiment<span class="sc">+</span>effective_n_control)))<span class="sc">%&gt;%</span></span>
<span id="cb131-43"><a href="#cb131-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sqrt_effective_n_inv=</span><span class="fu">sqrt</span>(effective_n_inv))<span class="sc">%&gt;%</span></span>
<span id="cb131-44"><a href="#cb131-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comparision_type=</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(comparision_type) <span class="sc">~</span> <span class="dv">4</span>, <span class="cn">TRUE</span> <span class="sc">~</span> comparision_type))</span>
<span id="cb131-45"><a href="#cb131-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-46"><a href="#cb131-46" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_all_in<span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb131-47"><a href="#cb131-47" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb131-48"><a href="#cb131-48" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb131-49"><a href="#cb131-49" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_all_in,</span>
<span id="cb131-50"><a href="#cb131-50" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb131-51"><a href="#cb131-51" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb131-52"><a href="#cb131-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-53"><a href="#cb131-53" aria-hidden="true" tabindex="-1"></a>SMDH_all_in<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb131-54"><a href="#cb131-54" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_all_in, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb131-55"><a href="#cb131-55" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> time_of_gnm_addition <span class="sc">+</span> </span>
<span id="cb131-56"><a href="#cb131-56" aria-hidden="true" tabindex="-1"></a>                      year_MeanCenter <span class="sc">+</span> </span>
<span id="cb131-57"><a href="#cb131-57" aria-hidden="true" tabindex="-1"></a>                      sqrt_effective_n_inv <span class="sc">+</span> </span>
<span id="cb131-58"><a href="#cb131-58" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">as.factor</span>(comparision_type) <span class="sc">+</span> </span>
<span id="cb131-59"><a href="#cb131-59" aria-hidden="true" tabindex="-1"></a>                      bird_species <span class="sc">+</span> </span>
<span id="cb131-60"><a href="#cb131-60" aria-hidden="true" tabindex="-1"></a>                      trait_type,</span>
<span id="cb131-61"><a href="#cb131-61" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb131-62"><a href="#cb131-62" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb131-63"><a href="#cb131-63" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb131-64"><a href="#cb131-64" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb131-65"><a href="#cb131-65" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb131-66"><a href="#cb131-66" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb131-67"><a href="#cb131-67" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb131-68"><a href="#cb131-68" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb131-69"><a href="#cb131-69" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> dataset_SMDH_all_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
</section>
</section>
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>  </div> <!-- /content -->  <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script> 
  
</body></html>