<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.6.40">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <meta name="author" content="Shreya D.">
    <meta name="dcterms.date" content="2025-08-16">

    <title>Data Analysis</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      const contentEl = window.document.getElementById('quarto-content');
      for (const child of contentEl.children) {
        child.style.paddingTop = header.clientHeight + "px";
        child.style.marginTop = "1em";
      }

      // Use the article root if the `back` call doesn't work. This isn't perfect
      // but should typically work
      window.quartoBackToArticle = () => {
        var currentUrl = window.location.href;
        window.history.back();
        setTimeout(() => {
            // if location was not changed in 100 ms, then there is no history back
            if(currentUrl === window.location.href){              
                // redirect to site root
                window.location.href = "../index.html";
            }
        }, 100);
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="../site_libs/manuscript-notebook/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-81e35ebdb4125010edbabe6010586085.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
     <script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>   <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script> 
      </head>

  <body class="quarto-notebook">
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      
      <a onclick="window.quartoBackToArticle(); return false;" class="btn btn-primary quarto-back-link" href=""><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> Data Analysis</h6>

            <a href="../code/07_data_analysis.Rmd" class="btn btn-primary quarto-download-embed" download="07_data_analysis.Rmd">Download Notebook</a>
          </div>

     <header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Data Analysis</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
        
        <div class="quarto-title-meta">

                <div>
            <div class="quarto-title-meta-heading">Author</div>
            <div class="quarto-title-meta-contents">
                        <p>Shreya D. </p>
                      </div>
          </div>
                
                <div>
            <div class="quarto-title-meta-heading">Published</div>
            <div class="quarto-title-meta-contents">
              <p class="date">August 16, 2025</p>
            </div>
          </div>
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>



    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#loading-data-for-analysis" id="toc-loading-data-for-analysis" class="nav-link active" data-scroll-target="#loading-data-for-analysis">Loading Data for analysis</a>
  <ul class="collapse">
  <li><a href="#creating-phylogeny-for-the-plot" id="toc-creating-phylogeny-for-the-plot" class="nav-link" data-scroll-target="#creating-phylogeny-for-the-plot">Creating Phylogeny for the plot</a></li>
  <li><a href="#visualizing-random-effects-structure" id="toc-visualizing-random-effects-structure" class="nav-link" data-scroll-target="#visualizing-random-effects-structure">Visualizing random effects structure</a></li>
  </ul></li>
  <li><a href="#preparing-datasets" id="toc-preparing-datasets" class="nav-link" data-scroll-target="#preparing-datasets">Preparing datasets</a></li>
  <li><a href="#overall-effect-intercept-only-meta-analytic-model" id="toc-overall-effect-intercept-only-meta-analytic-model" class="nav-link" data-scroll-target="#overall-effect-intercept-only-meta-analytic-model">Overall effect : Intercept-only meta-analytic model</a>
  <ul class="collapse">
  <li><a href="#using-lnrr" id="toc-using-lnrr" class="nav-link" data-scroll-target="#using-lnrr">using lnRR</a></li>
  <li><a href="#using-smdh" id="toc-using-smdh" class="nav-link" data-scroll-target="#using-smdh">using SMDH</a></li>
  <li><a href="#smdh-heterogeneity" id="toc-smdh-heterogeneity" class="nav-link" data-scroll-target="#smdh-heterogeneity">SMDH-heterogeneity</a></li>
  <li><a href="#bivariate-meta-analytical-model" id="toc-bivariate-meta-analytical-model" class="nav-link" data-scroll-target="#bivariate-meta-analytical-model">Bivariate Meta-analytical model</a></li>
  </ul></li>
  <li><a href="#sensitivity-analysis" id="toc-sensitivity-analysis" class="nav-link" data-scroll-target="#sensitivity-analysis">Sensitivity Analysis</a>
  <ul class="collapse">
  <li><a href="#with-published-data-only" id="toc-with-published-data-only" class="nav-link" data-scroll-target="#with-published-data-only">With published data only</a></li>
  <li><a href="#with-flagged-proxies" id="toc-with-flagged-proxies" class="nav-link" data-scroll-target="#with-flagged-proxies">With flagged proxies</a></li>
  <li><a href="#without-0-es" id="toc-without-0-es" class="nav-link" data-scroll-target="#without-0-es">Without 0 ES</a></li>
  <li><a href="#with-flagged-proxies-and-no-missing-es" id="toc-with-flagged-proxies-and-no-missing-es" class="nav-link" data-scroll-target="#with-flagged-proxies-and-no-missing-es">With flagged proxies and no missing ES</a></li>
  <li><a href="#no-inferential-stats-for-smdh-effect-sizes-calculated-from-means-sds-and-sample-size" id="toc-no-inferential-stats-for-smdh-effect-sizes-calculated-from-means-sds-and-sample-size" class="nav-link" data-scroll-target="#no-inferential-stats-for-smdh-effect-sizes-calculated-from-means-sds-and-sample-size">No inferential stats for SMDH: effect sizes calculated from means, SDs, and sample size</a></li>
  <li><a href="#exluding-failed-gearys-test-for-lnrr" id="toc-exluding-failed-gearys-test-for-lnrr" class="nav-link" data-scroll-target="#exluding-failed-gearys-test-for-lnrr">Exluding failed geary’s test for lnRR</a></li>
  <li><a href="#excluding-the-parasite-and-pathogen-load-fitness-proxies" id="toc-excluding-the-parasite-and-pathogen-load-fitness-proxies" class="nav-link" data-scroll-target="#excluding-the-parasite-and-pathogen-load-fitness-proxies">Excluding the parasite and pathogen load fitness proxies</a></li>
  <li><a href="#different-values-of-sampling-variance-correlation" id="toc-different-values-of-sampling-variance-correlation" class="nav-link" data-scroll-target="#different-values-of-sampling-variance-correlation">Different values of sampling variance correlation</a></li>
  </ul></li>
  <li><a href="#mechanistic-hypothesis" id="toc-mechanistic-hypothesis" class="nav-link" data-scroll-target="#mechanistic-hypothesis">Mechanistic Hypothesis</a></li>
  <li><a href="#meta-regressions" id="toc-meta-regressions" class="nav-link" data-scroll-target="#meta-regressions">Meta-regressions</a>
  <ul class="collapse">
  <li><a href="#type-of-experimental-design" id="toc-type-of-experimental-design" class="nav-link" data-scroll-target="#type-of-experimental-design">Type of experimental design</a>
  <ul class="collapse">
  <li><a href="#excluding-non-aromatic-and-blank-comparison-i.e.-the-two-control-group-comparison" id="toc-excluding-non-aromatic-and-blank-comparison-i.e.-the-two-control-group-comparison" class="nav-link" data-scroll-target="#excluding-non-aromatic-and-blank-comparison-i.e.-the-two-control-group-comparison">Excluding non-aromatic and blank comparison (i.e.&nbsp;the two control group comparison)</a></li>
  </ul></li>
  <li><a href="#time-of-addition-of-green-nest-material" id="toc-time-of-addition-of-green-nest-material" class="nav-link" data-scroll-target="#time-of-addition-of-green-nest-material">Time of addition of green nest material</a></li>
  <li><a href="#type-of-parasites" id="toc-type-of-parasites" class="nav-link" data-scroll-target="#type-of-parasites">Type of parasites</a></li>
  </ul></li>
  <li><a href="#sensitivity-analysis-excluding-non-aromatic-vs.-aromatic" id="toc-sensitivity-analysis-excluding-non-aromatic-vs.-aromatic" class="nav-link" data-scroll-target="#sensitivity-analysis-excluding-non-aromatic-vs.-aromatic">Sensitivity Analysis: Excluding Non-aromatic Vs. Aromatic</a></li>
  <li><a href="#risk-of-bias" id="toc-risk-of-bias" class="nav-link" data-scroll-target="#risk-of-bias">Risk of Bias</a></li>
  <li><a href="#publication-bias" id="toc-publication-bias" class="nav-link" data-scroll-target="#publication-bias">Publication Bias</a>
  <ul class="collapse">
  <li><a href="#all-in-model-for-heterogeneity" id="toc-all-in-model-for-heterogeneity" class="nav-link" data-scroll-target="#all-in-model-for-heterogeneity">All-in Model for heterogeneity</a></li>
  </ul></li>
  <li><a href="#pair-wise-comparison-for-meta-regression" id="toc-pair-wise-comparison-for-meta-regression" class="nav-link" data-scroll-target="#pair-wise-comparison-for-meta-regression">Pair-wise comparison for meta-regression</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">      

       <section id="loading-data-for-analysis" class="level1">
<h1>Loading Data for analysis</h1>
<div class="cell-container"><div class="cell-decorator"><pre>In [1]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting up workspace</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># For plotting trees, and although not strictly necessary, we may need the `ggtree` R package, which you should be able to install by running:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"BiocManager"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">install.packages</span>(<span class="st">"BiocManager"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Bioconductor version '3.20' is out-of-date; the current release version '3.21'
  is available with R version '4.5'; see https://bioconductor.org/install</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a> BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">"ggtree"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Bioconductor version 3.20 (BiocManager 1.30.26), R 4.4.2 (2024-10-31)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package(s) not installed when version(s) same as or greater than current; use
  `force = TRUE` to re-install: 'ggtree'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"orchaRd"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"daniel1noble/orchaRd"</span>, <span class="at">ref =</span> <span class="st">"main"</span>, <span class="at">force =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Loading the 'orchaRd' package (version 2.0). For an
introduction and vignette to the package please see: https://daniel1noble.github.io/orchaRd/</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(here,tidyverse,metafor,ggpubr,orchaRd,ggpubfigs,readr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggpubfigs' is not available for this version of R

A version of this package for your version of R might be available elsewhere,
see the ideas at
https://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Installing-packages</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in p_install(package, character.only = TRUE, ...):</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in library(package, lib.loc = lib.loc, character.only = TRUE,
logical.return = TRUE, : there is no package called 'ggpubfigs'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in pacman::p_load(here, tidyverse, metafor, ggpubr, orchaRd, ggpubfigs, : Failed to install/load:
ggpubfigs</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Packages needed</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="do">## cleaning up</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">430</span>) <span class="co">#set seed for reproducibility (for random number generation)</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Functions needed</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># function to estimate typical sampling error variance obtained from </span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># https://github.com/Yefeng0920/heterogeneity_ecoevo/tree/main/function</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>sigma2_v <span class="ot">&lt;-</span> <span class="cf">function</span>(mod){</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  sigma2_v <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="dv">1</span> <span class="sc">/</span> mod<span class="sc">$</span>vi) <span class="sc">*</span> (mod<span class="sc">$</span>k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">sum</span>(<span class="dv">1</span> <span class="sc">/</span> mod<span class="sc">$</span>vi)<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="fu">sum</span>((<span class="dv">1</span> <span class="sc">/</span> mod<span class="sc">$</span>vi)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sigma2_v)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading cleaned dataset</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------------------------</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>dataset_analysis<span class="ot">&lt;-</span><span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/dataset_analysis.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 274 Columns: 71</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (35): paper_ID, fulltext_screening, variable_note, authors, population_l...
dbl (35): year_publication, Observation_ID, experiment_ID, group_ID, repeate...
lgl  (1): fulltext_notes

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>dataset_lnRR<span class="ot">&lt;-</span><span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/dataset_lnRR.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 259 Columns: 71
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (34): paper_ID, fulltext_screening, variable_note, authors, population_l...
dbl (32): year_publication, Observation_ID, experiment_ID, group_ID, repeate...
lgl  (5): fulltext_notes, test_statistics_type, sign_relationship, total_sam...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>dataset_SMDH<span class="ot">&lt;-</span><span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/dataset_SMDH.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 274 Columns: 71
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (35): paper_ID, fulltext_screening, variable_note, authors, population_l...
dbl (35): year_publication, Observation_ID, experiment_ID, group_ID, repeate...
lgl  (1): fulltext_notes

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div></div>
<section id="creating-phylogeny-for-the-plot" class="level3">
<h3 class="anchored" data-anchor-id="creating-phylogeny-for-the-plot">Creating Phylogeny for the plot</h3>
<div class="cell-container"><div class="cell-decorator"><pre>In [2]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # install.packages("pacman")</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # load packages</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pacman::p_load(rotl,</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                ape,</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                ggtree)</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # We have 7 bird species in the dataset</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># bird_species &lt;- unique(dataset_analysis$bird_species)</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co"># # extracting taxonomic information</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co"># taxa &lt;- rotl::tnrs_match_names(names = bird_species)</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co"># taxa</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co"># # check approximate matches</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co"># taxa[taxa$approximate_match==TRUE &amp; !(is.na(taxa$approximate_match)),]</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="co"># # phylogenetic information for our species from the Open Tree of Life</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="co"># tree &lt;- rotl::tol_induced_subtree(ott_ids = taxa[["ott_id"]], label_format = "name")</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="co"># ape::is.binary(tree)</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="co"># # here are the species included in the tree</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="co"># sort(tree$tip.label)</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="co"># # removing the underscore "_" from the tree tip.label</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a><span class="co"># tree$tip.label &lt;- gsub("_"," ", tree$tip.label)</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a><span class="co"># sort(tree$tip.label)</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a><span class="co"># # compute branch lengths of tree</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a><span class="co"># phylo_branch &lt;- compute.brlen(tree, method = "Grafen", power = 1)</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a><span class="co"># # check tree is ultrametric</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a><span class="co"># is.ultrametric(phylo_branch) # TRUE</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a><span class="co"># # matrix to be included in the models</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a><span class="co"># bird_phylo &lt;- vcv(phylo_branch, cor = T)</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a><span class="co"># bird_phylo</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(tree) #check: https://www.rdocumentation.org/packages/ape/versions/5.3/topics/plot.phylo</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</section>
<section id="visualizing-random-effects-structure" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-random-effects-structure">Visualizing random effects structure</h3>
<div class="cell-container"><div class="cell-decorator"><pre>In [3]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("devtools")</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"davidsjoberg/ggsankey"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Using GitHub PAT from the git credential store.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Skipping install of 'ggsankey' from a github remote, the SHA1 (b675d0d5) has not changed since last install.
  Use `force = TRUE` to force installation</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggsankey)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>sankey_data <span class="ot">&lt;-</span> dataset_analysis <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Observation_ID, repeated_trait_ID_coded, paper_ID, experiment_ID_coded, group_ID_coded)<span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(Observation_ID, repeated_trait_ID_coded, paper_ID, experiment_ID_coded, group_ID_coded), as.factor)) <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_long</span>(Observation_ID, repeated_trait_ID_coded, paper_ID, experiment_ID_coded, group_ID_coded)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attributes are not identical across measure variables; they will be
dropped</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>sankey_data <span class="ot">&lt;-</span> dataset_analysis <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(paper_ID, bird_species, population_ID)<span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(paper_ID, bird_species, population_ID), as.factor)) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_long</span>(paper_ID, bird_species, population_ID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attributes are not identical across measure variables; they will be
dropped</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sankey_data, <span class="fu">aes</span>(<span class="at">x =</span> x, </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">next_x =</span> next_x, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">node =</span> node, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">next_node =</span> next_node,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="fu">factor</span>(node))) <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sankey</span>() <span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">drop=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="07_data_analysis_files/figure-html/unnamed-chunk-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="07_data_analysis_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sankey_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">next_x =</span> next_x, <span class="at">node =</span> node, <span class="at">next_node =</span> next_node, <span class="at">fill =</span> <span class="fu">factor</span>(node))) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_alluvial</span>(<span class="at">flow.alpha =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">drop =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_alluvial</span>(<span class="at">base_size =</span> <span class="dv">18</span>) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> .<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="07_data_analysis_files/figure-html/unnamed-chunk-2-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="07_data_analysis_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div></div>
</section>
</section>
<section id="preparing-datasets" class="level1">
<h1>Preparing datasets</h1>
<div class="cell-container"><div class="cell-decorator"><pre>In [4]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's just quickly ensure all the important variables are </span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># in the correct data type</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>dataset_analysis<span class="ot">&lt;-</span> dataset_analysis<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(paper_ID, Observation_ID, repeated_trait_ID_coded, paper_ID, experiment_ID_coded, group_ID_coded, comparision_type,Hypothesis,trait_type,parasite_type,time_of_gnm_addition, blinding, random_assignment, missing_data, population_ID,bird_species), as.factor))</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>dataset_lnRR<span class="ot">&lt;-</span> dataset_lnRR<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(paper_ID, Observation_ID, repeated_trait_ID_coded, paper_ID, experiment_ID_coded, group_ID_coded, comparision_type,Hypothesis,trait_type,parasite_type,time_of_gnm_addition, blinding, random_assignment, missing_data, population_ID, bird_species), as.factor))</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>dataset_SMDH<span class="ot">&lt;-</span> dataset_SMDH<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(paper_ID, Observation_ID, repeated_trait_ID_coded, paper_ID, experiment_ID_coded, group_ID_coded, comparision_type,Hypothesis,trait_type,parasite_type,time_of_gnm_addition, blinding, random_assignment, missing_data, population_ID,bird_species), as.factor))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [5]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For lnRR (or simply load dataset as provided)</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>dataset_lnRR<span class="ot">&lt;-</span>dataset_analysis<span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(lnRR_sign <span class="sc">!=</span> <span class="st">"NA"</span> <span class="sc">|</span> lnRR_variance <span class="sc">!=</span> <span class="st">"NA"</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting dataset which are not flagged</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>dataset_lnRR<span class="ot">&lt;-</span>dataset_lnRR<span class="sc">%&gt;%</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(proxy_decision <span class="sc">==</span> <span class="st">"include"</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting only published dataset</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_published<span class="ot">&lt;-</span>dataset_lnRR<span class="sc">%&gt;%</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(year_publication))</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting dataset which are flagged</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>lnRR_con_flagged<span class="ot">&lt;-</span>dataset_analysis<span class="sc">%&gt;%</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(lnRR_sign <span class="sc">!=</span> <span class="st">"NA"</span> <span class="sc">|</span> lnRR_variance <span class="sc">!=</span> <span class="st">"NA"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(proxy_decision <span class="sc">!=</span> <span class="st">"SMDH only"</span> <span class="sc">|</span> proxy_decision <span class="sc">!=</span> <span class="st">"contingency table"</span> )</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting dataset without those using 0 as ES because authors reported no effect</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>lnRR_sin_missingES <span class="ot">&lt;-</span> dataset_lnRR <span class="sc">%&gt;%</span> </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="sc">!</span>proxy_comment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"use 0 as ES"</span>))</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>lnRR_flagged_no_missingES<span class="ot">&lt;-</span> lnRR_con_flagged <span class="sc">%&gt;%</span> </span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="sc">!</span>proxy_comment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"use 0 as ES"</span>))</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting only dataset that passes geary's test</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>lnRR_geary_passed<span class="ot">&lt;-</span>dataset_lnRR<span class="sc">%&gt;%</span><span class="fu">filter</span>(geary_test<span class="sc">==</span><span class="st">"pass"</span>)</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a><span class="do">## For SMDH</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting dataset which are not flagged</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>dataset_SMDH<span class="ot">&lt;-</span>dataset_analysis<span class="sc">%&gt;%</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(proxy_decision <span class="sc">!=</span> <span class="st">"sensitivity-analysis"</span> <span class="sc">|</span> <span class="fu">is.na</span>(proxy_decision))</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting only published dataset</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_published<span class="ot">&lt;-</span>dataset_SMDH<span class="sc">%&gt;%</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(year_publication))</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting dataset which are flagged</span></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>SMDH_con_flagged<span class="ot">&lt;-</span>dataset_analysis<span class="sc">%&gt;%</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(SMDH_sign <span class="sc">!=</span> <span class="st">"NA"</span>)</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting dataset without those using 0 as ES because authors reported no effect</span></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>SMDH_sin_missingES <span class="ot">&lt;-</span> dataset_SMDH <span class="sc">%&gt;%</span> </span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="sc">!</span>proxy_comment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"use 0 as ES"</span>))</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>SMDH_flagged_no_missingES<span class="ot">&lt;-</span> SMDH_con_flagged <span class="sc">%&gt;%</span> </span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="sc">!</span>proxy_comment <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"use 0 as ES"</span>))</span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting dataset which are not flagged but without the SMDH calculated from inferential statistics </span></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>SMDH_no_inferential<span class="ot">&lt;-</span>dataset_analysis<span class="sc">%&gt;%</span></span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(proxy_decision <span class="sc">==</span> <span class="st">"include"</span>)<span class="sc">%&gt;%</span> <span class="fu">filter</span>(SMDH_sign <span class="sc">!=</span> <span class="st">"NA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</section>
<section id="overall-effect-intercept-only-meta-analytic-model" class="level1">
<h1>Overall effect : Intercept-only meta-analytic model</h1>
<p><em>“Does adding green material to the nest have an adaptive function across the bird species that perform this behaviour?”</em></p>
<section id="using-lnrr" class="level2">
<h2 class="anchored" data-anchor-id="using-lnrr">using lnRR</h2>
<div class="cell-container"><div class="cell-decorator"><pre>In [6]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>VCV_lnRR<span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>intercept_lnRR<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> dataset_lnRR)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a> <span class="fu">saveRDS</span>(intercept_lnRR, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/intercept_lnRR.rds"</span>))</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a> <span class="fu">write.csv</span>(dataset_lnRR,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/intercept_lnRR.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<section id="exploring-heterogeneity-in-intercept-only-model" class="level4">
<h4 class="anchored" data-anchor-id="exploring-heterogeneity-in-intercept-only-model">Exploring heterogeneity in intercept only model</h4>
<p>This is the function from Yefeng’s Github for interpreting heterogeneity. I have to download the data used for this function to be able to use it.</p>
<p>I am using the values from the table directly..</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [7]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ## Function is from the Pluralistic approach to heterogeneity from Yefeng's Pre-print repository from GitHub</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># #-----------------------heterogeneity interpretation-----------------------#</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># het_interpret &lt;- function(observed_value, het_type, es_type, data) {</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   if (!het_type %in% c("I2", "CVH", "M", "sigma2", "V_bar")) {</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     stop("Invalid heterogeneity type. Choose from 'I2', 'CVH', 'M', 'sigma2', or 'V_bar'.")</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   if (!es_type %in% unique(data$es.type)) {</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     stop("Invalid effect size type. Check the levels of 'es.type'.")</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   filtered_data &lt;- data %&gt;% filter(es.type == es_type)</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   if (nrow(filtered_data) == 0) {</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     stop("No data available for the selected effect size type.")</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   het_values &lt;- filtered_data[[het_type]]</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   percentiles &lt;- quantile(het_values, probs = seq(0, 1, by = 0.05), na.rm = TRUE)</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   lower_bound &lt;- max(percentiles[percentiles &lt;= observed_value], na.rm = TRUE)</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   upper_bound &lt;- min(percentiles[percentiles &gt;= observed_value], na.rm = TRUE)</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   lower_percentile &lt;- names(percentiles)[percentiles == lower_bound]</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   upper_percentile &lt;- names(percentiles)[percentiles == upper_bound]</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   percentile_range &lt;- paste0(lower_percentile, "-", upper_percentile, "th percentile")</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="co">#   # return the results</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   return(tibble::tibble(</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a><span class="co">#     observed_value = observed_value,</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a><span class="co">#     het_type = het_type,</span></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     es_type = es_type,</span></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a><span class="co">#     percentile_range = percentile_range</span></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a><span class="co">#   ))</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a><span class="co"># x&lt;-het_interpret(observed_value= I2_main_model_vector[1], </span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a><span class="co">#                  het_type = "I2", </span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a><span class="co">#                  es_type = "lnRR_sign", </span></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a><span class="co">#                  data= intercept_lnRR)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<p>Let us look at the heterogeneity in lnRR intercept-only model</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [8]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Then also:</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # Typical sampling variance (which captures the statistical noise of the data, </span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # but is rarely reported in the current meta-analytic practice):</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sigma2_v</span>(intercept_lnRR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0003277551</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To calculate heterogeneity, these are the functions from orchaRd:</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # I2, CV and M</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>sigma2_main_model_vector <span class="ot">&lt;-</span> <span class="fu">sum</span>(intercept_lnRR<span class="sc">$</span>sigma2)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.11, 0.27, and 0.57 for lnRR</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>I2_main_model_vector <span class="ot">&lt;-</span> orchaRd<span class="sc">::</span><span class="fu">i2_ml</span>(intercept_lnRR)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.88, 0.95, and 0.99 for lnRR</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>CV2_main_model_vector <span class="ot">&lt;-</span> orchaRd<span class="sc">::</span><span class="fu">cvh2_ml</span>(intercept_lnRR)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>CV1_main_model_vector <span class="ot">&lt;-</span> orchaRd<span class="sc">::</span><span class="fu">cvh1_ml</span>(intercept_lnRR)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co"># CVH2 (CVH1) - 1.36 (1.16), 3.76 (1.94), and 12.1 (3.48) for lnRR</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>M2_main_model_vector <span class="ot">&lt;-</span> orchaRd<span class="sc">::</span><span class="fu">m2_ml</span>(intercept_lnRR)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>M1_main_model_vector <span class="ot">&lt;-</span> orchaRd<span class="sc">::</span><span class="fu">m1_ml</span>(intercept_lnRR)</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="co"># M2(M1) - 0.58 (0.54), 0.79 (0.66), and 0.78 for lnRR;</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="co"># # # Total unstandardized raw variance (i.e. total heterogeneity)</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sum</span>(intercept_lnRR<span class="sc">$</span>sigma2), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.023</code></pre>
</div>
</div></div>
</section>
</section>
<section id="using-smdh" class="level2">
<h2 class="anchored" data-anchor-id="using-smdh">using SMDH</h2>
<p>We are only running these analysis for the fitness proxy labelled “included”. Some proxies have been flagged and we will run them in a sensitivity analysis only</p>
<p>The sampling variances will be fitted as variance–covariance matrices assuming a 0.5 correlation (ρs) between sampling variances from the same paper_ID (Noble et al.&nbsp;2017).</p>
<p>The MLMA using SMDH as the effect size measure incorporate the imputed sampling variance</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [9]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>VCV_SMDH <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>intercept_SMDH<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify SMDH as the effect size measure;</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH, <span class="co"># specify SMDH's sampling variance-covariance matrix;</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> dataset_SMDH)</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a> <span class="fu">saveRDS</span>(intercept_SMDH, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/intercept_SMDH.rds"</span>))</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a> <span class="fu">write.csv</span>(dataset_SMDH,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/intercept_SMDH.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</section>
<section id="smdh-heterogeneity" class="level2">
<h2 class="anchored" data-anchor-id="smdh-heterogeneity">SMDH-heterogeneity</h2>
<p>Now looking at the intercept only model</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [10]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(intercept_SMDH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 253; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-324.4948   648.9896   660.9896   682.1662   661.3325   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0008     26     no        paper_ID 
sigma^2.2  0.2578  0.5077    253     no  Observation_ID 
sigma^2.3  0.0000  0.0013     47     no  group_ID_coded 
sigma^2.4  0.0000  0.0002     17     no   population_ID 
sigma^2.5  0.0000  0.0001      7     no    bird_species 

Test for Heterogeneity:
Q(df = 252) = 1114.7203, p-val &lt; .0001

Model Results:

estimate      se    tval   df    pval   ci.lb   ci.ub     
  0.1793  0.0665  2.6948  252  0.0075  0.0483  0.3104  ** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(intercept_SMDH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se  ci.lb  ci.ub   pi.lb  pi.ub 
 0.1793 0.0665 0.0483 0.3104 -0.8292 1.1879 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Then also:</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # Typical sampling variance (which captures the statistical noise of the data, </span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # but is rarely reported in the current meta-analytic practice):</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sigma2_v</span>(intercept_SMDH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1319841</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To calculate heterogeneity, these are the functions from orchaRd:</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # I2, CV and M</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>sigma2_main_model_vector <span class="ot">&lt;-</span> <span class="fu">sum</span>(intercept_SMDH<span class="sc">$</span>sigma2)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.54, 1.25, and 3.03 for SMD;</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>I2_main_model_vector <span class="ot">&lt;-</span> orchaRd<span class="sc">::</span><span class="fu">i2_ml</span>(intercept_SMDH)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.78, 0.89, and 0.96 for SMD</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.88, 0.95, and 0.99 for lnRR</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>CV2_main_model_vector <span class="ot">&lt;-</span> orchaRd<span class="sc">::</span><span class="fu">cvh2_ml</span>(intercept_SMDH)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>CV1_main_model_vector <span class="ot">&lt;-</span> orchaRd<span class="sc">::</span><span class="fu">cvh1_ml</span>(intercept_SMDH)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co"># CVH2 (CVH1) - 1.36 (1.16), 3.76 (1.94), and 12.1 (3.48) for lnRR</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>M2_main_model_vector <span class="ot">&lt;-</span> orchaRd<span class="sc">::</span><span class="fu">m2_ml</span>(intercept_SMDH)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>M1_main_model_vector <span class="ot">&lt;-</span> orchaRd<span class="sc">::</span><span class="fu">m1_ml</span>(intercept_SMDH)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co"># M2 (M1) - 0.58 (0.54), 0.79 (0.66), and 0.78 for lnRR</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="co"># # # Total unstandardized raw variance (i.e. total heterogeneity)</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sum</span>(intercept_SMDH<span class="sc">$</span>sigma2), <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.258</code></pre>
</div>
</div></div>
</section>
<section id="bivariate-meta-analytical-model" class="level2">
<h2 class="anchored" data-anchor-id="bivariate-meta-analytical-model">Bivariate Meta-analytical model</h2>
<p>For the overall effect size (i.e., the meta-analytical mean), we will run the bivariate multilevel meta-analytic model suggested by Yang et al.&nbsp;(2024), which models both lnRR and SMD(H) simultaneously (i.e., including them both as response variables and estimating their correlation; random).</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [11]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>dataset_bivariate <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">paper_ID =</span> <span class="fu">c</span>(dataset_lnRR<span class="sc">$</span>paper_ID, dataset_SMDH<span class="sc">$</span>paper_ID),</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Observation_ID =</span> <span class="fu">c</span>(dataset_lnRR<span class="sc">$</span>Observation_ID, dataset_SMDH<span class="sc">$</span>Observation_ID),</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">group_ID_coded =</span> <span class="fu">c</span>(dataset_lnRR<span class="sc">$</span>group_ID_coded, dataset_SMDH<span class="sc">$</span>group_ID_coded),</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">population_ID =</span> <span class="fu">c</span>(dataset_lnRR<span class="sc">$</span>population_ID, dataset_SMDH<span class="sc">$</span>population_ID),</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">bird_species =</span> <span class="fu">c</span>(dataset_lnRR<span class="sc">$</span>bird_species, dataset_SMDH<span class="sc">$</span>bird_species),</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ES =</span> <span class="fu">c</span>(dataset_lnRR<span class="sc">$</span>lnRR_sign, dataset_SMDH<span class="sc">$</span>SMDH_sign),</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">V_ES =</span> <span class="fu">c</span>(dataset_lnRR<span class="sc">$</span>lnRR_variance, dataset_SMDH<span class="sc">$</span>SMDH_variance),</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ES_measure =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"lnRR"</span>, <span class="fu">nrow</span>(dataset_lnRR)), <span class="fu">rep</span>(<span class="st">"SMDH"</span>, <span class="fu">nrow</span>(dataset_SMDH)))</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>VCV_bivariate <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> V_ES, <span class="co"># sampling variances of lnRR and SMD that are correlated within the same study;</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">cluster =</span> paper_ID, <span class="co"># study identity;</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">type =</span> ES_measure, <span class="co"># different types of effect size measures underlying the observed effect sizes;</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> dataset_bivariate, <span class="co"># the long format data frame;</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">rho =</span> <span class="fl">0.2</span>, <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5.</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">nearpd =</span> <span class="cn">TRUE</span> <span class="co"># specify whether impose the non positive definite VCV matrix (not invertible) to the nearest positive semi-definite matrix </span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>Bivariate_model <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> ES, <span class="co"># specify the effect size estimate (the variable ES in our case);</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">V =</span> VCV_bivariate, <span class="co"># specify the imputed variance-covariance matrix;</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">mods =</span> <span class="sc">~</span> ES_measure <span class="sc">-</span> <span class="dv">1</span>, <span class="co"># specify the variable "ES_measure" indicating the types of effect size measures;</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> ES_measure <span class="sc">|</span> paper_ID, </span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">~</span> ES_measure <span class="sc">|</span> Observation_ID,</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>                              ), <span class="co"># add correlated random effects corresponding to the lnRR and SMD parameters in the same study;</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">struct =</span> <span class="st">"UN"</span>, <span class="co"># impose an unstructured variance-covariance of the study-specific random effects;</span></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">test =</span> <span class="st">"t"</span>, <span class="co"># t distribution is specified to test the overall effect against the null hypothesis and construct confidence intervals;</span></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">method =</span> <span class="st">"REML"</span>, <span class="co"># restricted likelihood maximum is assigned as the estimator for variance components as suggested;</span></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> dataset_bivariate, <span class="co"># the long format dataset</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">sparse =</span> T</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>               )</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(Bivariate_model, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/sensitivity_analysis/bivariate_model.rds"</span>))</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_bivariate,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/05_data_sensitivity_analysis/dataset_bivariate.csv"</span>))</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Bivariate_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 491; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-480.9777   961.9555   983.9555  1030.0715   984.5089   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0000     47     no  group_ID_coded 
sigma^2.2  0.0000  0.0000     17     no   population_ID 
sigma^2.3  0.0000  0.0000      7     no    bird_species 

outer factor: paper_ID   (nlvls = 26)
inner factor: ES_measure (nlvls = 2)

            estim    sqrt  k.lvl  fixed  level 
tau^2.1    0.0013  0.0360     26     no   lnRR 
tau^2.2    0.1525  0.3906     26     no   SMDH 

      rho.lnRR  rho.SMDH    lnRR  SMDH 
lnRR         1                 -    26 
SMDH   -1.0000         1      no     - 

outer factor: Observation_ID (nlvls = 253)
inner factor: ES_measure     (nlvls = 2)

              estim    sqrt  k.lvl  fixed  level 
gamma^2.1    0.1291  0.3593    238     no   lnRR 
gamma^2.2    1.2735  1.1285    253     no   SMDH 

      phi.lnRR  phi.SMDH    lnRR  SMDH 
lnRR         1    0.5218       -   238 
SMDH    0.5218         1      no     - 

Test for Residual Heterogeneity:
QE(df = 489) = 16178103560.6237, p-val &lt; .0001

Test of Moderators (coefficients 1:2):
F(df1 = 2, df2 = 489) = 1.8862, p-val = 0.1527

Model Results:

                estimate      se     tval   df    pval    ci.lb   ci.ub    
ES_measurelnRR   -0.0152  0.0309  -0.4898  489  0.6245  -0.0760  0.0456    
ES_measureSMDH    0.2496  0.1367   1.8257  489  0.0685  -0.0190  0.5182  . 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [12]:</pre></div><div class="cell" data-warning="false">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(ellipse)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>ab.l <span class="ot">&lt;-</span> <span class="fu">matreg</span>(<span class="at">y=</span><span class="dv">2</span>, <span class="at">x=</span><span class="dv">1</span>, <span class="at">R=</span>Bivariate_model<span class="sc">$</span>G, <span class="at">cov=</span><span class="cn">TRUE</span>, <span class="at">means=</span><span class="fu">coef</span>(Bivariate_model), <span class="at">n=</span>Bivariate_model<span class="sc">$</span>g.levels.comb.k) <span class="co"># fit regression model</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">ellipse</span>(Bivariate_model<span class="sc">$</span>G, <span class="at">centre=</span><span class="fu">coef</span>(Bivariate_model), <span class="at">level=</span><span class="fl">0.95</span>) <span class="co"># get 95% coverage region</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>ellipse_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> xy[, <span class="dv">1</span>], <span class="at">y =</span> xy[, <span class="dv">2</span>]) <span class="co"># convert it int dataframe so that we can use ggplot to make a figure</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_wider</span>(dataset_bivariate, <span class="at">names_from =</span> ES_measure, <span class="at">values_from =</span> <span class="fu">c</span>(ES, V_ES)) <span class="sc">%&gt;%</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> ES_lnRR, <span class="at">y =</span> ES_SMDH, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(V_ES_lnRR)), <span class="at">color =</span> <span class="st">"#1B9E77"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">coef</span>(Bivariate_model)[<span class="dv">1</span>], <span class="at">y =</span> <span class="fu">coef</span>(Bivariate_model)[<span class="dv">2</span>]), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> ab.l<span class="sc">$</span>tab<span class="sc">$</span>beta[<span class="dv">1</span>], <span class="at">slope =</span> ab.l<span class="sc">$</span>tab<span class="sc">$</span>beta[<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> ellipse_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_x_continuous(limits = c(-2.5, 2.5)) + </span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_y_continuous(limits = c(-2.5, 2.5)) + </span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">size =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"lnRR"</span>, <span class="at">y =</span> <span class="st">"SMD"</span>) <span class="sc">+</span> </span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_point(aes(x = coef(Bivariate_model)[1], y = coef(Bivariate_model)[2]), : All aesthetics have length 1, but the data has 253 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 15 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="07_data_analysis_files/figure-html/unnamed-chunk-7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="07_data_analysis_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div></div>
<p>There is a very high negative correlation between the two effect sizes. This probably is an artifact of the data and not a true correlation. If you look at the model summary, the <span class="math inline">\(tau^2\)</span> for lnRR, it is extremely small 0.0008, i.e., there is very little variance. This could also be stemming from the fact that the log values in the dataset could be causing this. For SMDH on the other hand, the <span class="math inline">\(tau^2\)</span> is 0.1681 that is much larger. This difference in the variance estimate itself could be causing this artifact of the model. I will only go ahead to present this model as a senstivity analysis because I am not completely convinced by it’s robustness.</p>
</section>
</section>
<section id="sensitivity-analysis" class="level1">
<h1>Sensitivity Analysis</h1>
<section id="with-published-data-only" class="level3">
<h3 class="anchored" data-anchor-id="with-published-data-only">With published data only</h3>
<div class="cell-container"><div class="cell-decorator"><pre>In [13]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for lnRR as Effect Size</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing new variance-covariance matrix</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_published <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_published,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Running intercept only model</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>SA_lnRR_published<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_published, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> dataset_lnRR_published)</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_lnRR_published, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/sensitivity_analysis/SA_lnRR_published.rds"</span>))</span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_lnRR_published,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/05_data_sensitivity_analysis/dataset_lnRR_published.csv"</span>))</span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the effect now?</span></span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SA_lnRR_published)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 221; method: REML)

  logLik  Deviance       AIC       BIC      AICc   
-22.5653   45.1306   57.1306   77.4923   57.5249   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0003     24     no        paper_ID 
sigma^2.2  0.0244  0.1563    221     no  Observation_ID 
sigma^2.3  0.0000  0.0001     44     no  group_ID_coded 
sigma^2.4  0.0000  0.0000     15     no   population_ID 
sigma^2.5  0.0000  0.0000      6     no    bird_species 

Test for Heterogeneity:
Q(df = 220) = 2253.0536, p-val &lt; .0001

Model Results:

estimate      se    tval   df    pval    ci.lb   ci.ub    
  0.0197  0.0164  1.2034  220  0.2301  -0.0126  0.0519    

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(SA_lnRR_published)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se   ci.lb  ci.ub   pi.lb  pi.ub 
 0.0197 0.0164 -0.0126 0.0519 -0.2900 0.3293 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for SMDH as Effect Size</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing new variance-covariance matrix</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_published <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_published,</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Running intercept only model</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>SA_SMDH_published<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_published, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> dataset_SMDH_published)</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_SMDH_published, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/sensitivity_analysis/SA_SMDH_published.rds"</span>))</span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_SMDH_published,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/05_data_sensitivity_analysis/dataset_SMDH_published.csv"</span>))</span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the effect now?</span></span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SA_SMDH_published)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 235; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-308.4661   616.9322   628.9322   649.6641   629.3022   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0010     24     no        paper_ID 
sigma^2.2  0.2740  0.5235    235     no  Observation_ID 
sigma^2.3  0.0000  0.0015     45     no  group_ID_coded 
sigma^2.4  0.0000  0.0002     15     no   population_ID 
sigma^2.5  0.0000  0.0001      6     no    bird_species 

Test for Heterogeneity:
Q(df = 234) = 1092.0602, p-val &lt; .0001

Model Results:

estimate      se    tval   df    pval   ci.lb   ci.ub     
  0.1916  0.0688  2.7849  234  0.0058  0.0561  0.3271  ** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(SA_SMDH_published)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se  ci.lb  ci.ub   pi.lb  pi.ub 
 0.1916 0.0688 0.0561 0.3271 -0.8486 1.2318 </code></pre>
</div>
</div></div>
</section>
<section id="with-flagged-proxies" class="level3">
<h3 class="anchored" data-anchor-id="with-flagged-proxies">With flagged proxies</h3>
<p>Some traits for which the relationship with fitness is unclear or highly debated in the literature</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [14]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for lnRR as Effect Size</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing new variance-covariance matrix</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_flagged <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> lnRR_con_flagged,</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Running intercept only model</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>SA_lnRR_flagged<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_flagged, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> lnRR_con_flagged)</span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_lnRR_flagged, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/sensitivity_analysis/SA_lnRR_flagged.rds"</span>))</span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(lnRR_con_flagged,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/05_data_sensitivity_analysis/dataset_lnRR_con_flagged.csv"</span>))</span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the effect now?</span></span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SA_lnRR_flagged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 259; method: REML)

  logLik  Deviance       AIC       BIC      AICc   
-25.1782   50.3564   62.3564   83.6742   62.6911   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0001     28     no        paper_ID 
sigma^2.2  0.0223  0.1494    259     no  Observation_ID 
sigma^2.3  0.0000  0.0004     52     no  group_ID_coded 
sigma^2.4  0.0000  0.0000     17     no   population_ID 
sigma^2.5  0.0000  0.0000      7     no    bird_species 

Test for Heterogeneity:
Q(df = 258) = 2395.1696, p-val &lt; .0001

Model Results:

estimate      se    tval   df    pval    ci.lb   ci.ub    
  0.0237  0.0149  1.5886  258  0.1134  -0.0057  0.0531    

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(SA_lnRR_flagged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se   ci.lb  ci.ub   pi.lb  pi.ub 
 0.0237 0.0149 -0.0057 0.0531 -0.2720 0.3194 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for SMDH as Effect Size</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing new variance-covariance matrix</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_flagged <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> SMDH_con_flagged,</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Running intercept only model</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>SA_SMDH_flagged<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_flagged, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> SMDH_con_flagged)</span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_SMDH_flagged, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/sensitivity_analysis/SA_SMDH_flagged.rds"</span>))</span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(SMDH_con_flagged,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/05_data_sensitivity_analysis/dataset_SMDH_con_flagged.csv"</span>))</span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the effect now?</span></span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SA_SMDH_flagged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 274; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-344.0150   688.0299   700.0299   721.6868   700.3457   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0014     28     no        paper_ID 
sigma^2.2  0.2487  0.4987    274     no  Observation_ID 
sigma^2.3  0.0000  0.0022     53     no  group_ID_coded 
sigma^2.4  0.0000  0.0001     17     no   population_ID 
sigma^2.5  0.0000  0.0000      7     no    bird_species 

Test for Heterogeneity:
Q(df = 273) = 1184.8136, p-val &lt; .0001

Model Results:

estimate      se    tval   df    pval   ci.lb   ci.ub     
  0.1911  0.0631  3.0269  273  0.0027  0.0668  0.3154  ** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(SA_SMDH_flagged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se  ci.lb  ci.ub   pi.lb  pi.ub 
 0.1911 0.0631 0.0668 0.3154 -0.7985 1.1807 </code></pre>
</div>
</div></div>
</section>
<section id="without-0-es" class="level3">
<h3 class="anchored" data-anchor-id="without-0-es">Without 0 ES</h3>
<div class="cell-container"><div class="cell-decorator"><pre>In [15]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for lnRR as Effect Size</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing new variance-covariance matrix</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_no_missingES <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> lnRR_sin_missingES,</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Running intercept only model</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>SA_lnRR_no_missingES<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_no_missingES, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> lnRR_sin_missingES)</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_lnRR_no_missingES, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/sensitivity_analysis/SA_lnRR_no_missingES.rds"</span>))</span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(lnRR_sin_missingES,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/05_data_sensitivity_analysis/dataset_lnRR_sin_missingES.csv"</span>))</span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the effect now?</span></span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SA_lnRR_no_missingES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 222; method: REML)

  logLik  Deviance       AIC       BIC      AICc   
-29.9487   59.8973   71.8973   92.2863   72.2899   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0002     26     no        paper_ID 
sigma^2.2  0.0244  0.1563    222     no  Observation_ID 
sigma^2.3  0.0000  0.0002     46     no  group_ID_coded 
sigma^2.4  0.0000  0.0001     17     no   population_ID 
sigma^2.5  0.0000  0.0000      7     no    bird_species 

Test for Heterogeneity:
Q(df = 221) = 2275.2780, p-val &lt; .0001

Model Results:

estimate      se    tval   df    pval    ci.lb   ci.ub    
  0.0189  0.0160  1.1828  221  0.2381  -0.0126  0.0505    

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(SA_lnRR_no_missingES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se   ci.lb  ci.ub   pi.lb  pi.ub 
 0.0189 0.0160 -0.0126 0.0505 -0.2906 0.3285 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for SMDH as Effect Size</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing new variance-covariance matrix</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_no_missingES <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> SMDH_sin_missingES,</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Running intercept only model</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>SA_SMDH_no_missingES<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_no_missingES, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> SMDH_sin_missingES)</span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_SMDH_no_missingES, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/sensitivity_analysis/SA_SMDH_no_missingES.rds"</span>))</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(SMDH_sin_missingES,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/05_data_sensitivity_analysis/dataset_SMDH_sin_missingES.csv"</span>))</span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the effect now?</span></span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SA_SMDH_no_missingES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 237; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-315.4239   630.8479   642.8479   663.6309   643.2147   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0008     26     no        paper_ID 
sigma^2.2  0.2967  0.5447    237     no  Observation_ID 
sigma^2.3  0.0000  0.0013     47     no  group_ID_coded 
sigma^2.4  0.0000  0.0002     17     no   population_ID 
sigma^2.5  0.0000  0.0001      7     no    bird_species 

Test for Heterogeneity:
Q(df = 236) = 1113.5021, p-val &lt; .0001

Model Results:

estimate      se    tval   df    pval   ci.lb   ci.ub     
  0.1860  0.0701  2.6545  236  0.0085  0.0480  0.3240  ** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(SA_SMDH_no_missingES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se  ci.lb  ci.ub   pi.lb  pi.ub 
 0.1860 0.0701 0.0480 0.3240 -0.8960 1.2680 </code></pre>
</div>
</div></div>
</section>
<section id="with-flagged-proxies-and-no-missing-es" class="level3">
<h3 class="anchored" data-anchor-id="with-flagged-proxies-and-no-missing-es">With flagged proxies and no missing ES</h3>
<div class="cell-container"><div class="cell-decorator"><pre>In [16]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for lnRR as Effect Size</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing new variance-covariance matrix</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>VCV_flagged_no_missingES <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> lnRR_flagged_no_missingES,</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Running intercept only model</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>SA_lnRR_flagged_no_missingES<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_flagged_no_missingES, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> lnRR_flagged_no_missingES)</span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-31"><a href="#cb76-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-32"><a href="#cb76-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb76-33"><a href="#cb76-33" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_lnRR_flagged_no_missingES, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/sensitivity_analysis/SA_lnRR_flagged_no_missingES.rds"</span>))</span>
<span id="cb76-34"><a href="#cb76-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-35"><a href="#cb76-35" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb76-36"><a href="#cb76-36" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(lnRR_flagged_no_missingES,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/05_data_sensitivity_analysis/dataset_lnRR_flagged_no_missingES.csv"</span>))</span>
<span id="cb76-37"><a href="#cb76-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-38"><a href="#cb76-38" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the effect now?</span></span>
<span id="cb76-39"><a href="#cb76-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-40"><a href="#cb76-40" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SA_lnRR_flagged_no_missingES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 243; method: REML)

  logLik  Deviance       AIC       BIC      AICc   
-29.1661   58.3322   70.3322   91.2658   70.6897   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0001     28     no        paper_ID 
sigma^2.2  0.0236  0.1537    243     no  Observation_ID 
sigma^2.3  0.0000  0.0003     52     no  group_ID_coded 
sigma^2.4  0.0000  0.0000     17     no   population_ID 
sigma^2.5  0.0000  0.0000      7     no    bird_species 

Test for Heterogeneity:
Q(df = 242) = 2392.7303, p-val &lt; .0001

Model Results:

estimate      se    tval   df    pval    ci.lb   ci.ub    
  0.0238  0.0153  1.5581  242  0.1205  -0.0063  0.0540    

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(SA_lnRR_flagged_no_missingES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se   ci.lb  ci.ub   pi.lb  pi.ub 
 0.0238 0.0153 -0.0063 0.0540 -0.2804 0.3281 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for SMDH as Effect Size</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing new variance-covariance matrix</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_flagged_no_missingES <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> SMDH_flagged_no_missingES,</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Running intercept only model</span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>SA_SMDH_flagged_no_missingES<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_flagged_no_missingES, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> SMDH_flagged_no_missingES)</span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_SMDH_flagged_no_missingES, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/sensitivity_analysis/SA_SMDH_flagged_no_missingES.rds"</span>))</span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(SMDH_flagged_no_missingES,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/05_data_sensitivity_analysis/dataset_SMDH_flagged_no_missingES.csv"</span>))</span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-38"><a href="#cb80-38" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the effect now?</span></span>
<span id="cb80-39"><a href="#cb80-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-40"><a href="#cb80-40" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SA_SMDH_flagged_no_missingES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 258; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-335.1461   670.2922   682.2922   703.5867   682.6282   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0004     28     no        paper_ID 
sigma^2.2  0.2812  0.5303    258     no  Observation_ID 
sigma^2.3  0.0001  0.0097     53     no  group_ID_coded 
sigma^2.4  0.0000  0.0001     17     no   population_ID 
sigma^2.5  0.0000  0.0000      7     no    bird_species 

Test for Heterogeneity:
Q(df = 257) = 1183.6500, p-val &lt; .0001

Model Results:

estimate      se    tval   df    pval   ci.lb   ci.ub     
  0.1988  0.0661  3.0075  257  0.0029  0.0686  0.3289  ** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(SA_SMDH_flagged_no_missingES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se  ci.lb  ci.ub   pi.lb  pi.ub 
 0.1988 0.0661 0.0686 0.3289 -0.8538 1.2514 </code></pre>
</div>
</div></div>
<p>Are the meta-regression robust to this analysis</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [17]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_design_flagged_no_missingES <span class="ot">&lt;-</span> lnRR_flagged_no_missingES <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(comparision_type))</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_design_flagged_no_missingES <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_design_flagged_no_missingES,</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>lnRR_design_flagged_no_missingE <span class="ot">&lt;-</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_design_flagged_no_missingES ,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> comparision_type,</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_design_flagged_no_missingES)</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a><span class="co"># This analysis only includes dataset that has a proxy relating to comaparision type</span></span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_design_flagged_no_missingES <span class="ot">&lt;-</span>SMDH_flagged_no_missingES <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(comparision_type))</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_design_flagged_no_missingES <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_design_flagged_no_missingES,</span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a>SMDH_design_flagged_no_missingE <span class="ot">&lt;-</span></span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_design_flagged_no_missingES ,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> comparision_type,</span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb84-37"><a href="#cb84-37" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb84-38"><a href="#cb84-38" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb84-39"><a href="#cb84-39" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb84-40"><a href="#cb84-40" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb84-41"><a href="#cb84-41" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb84-42"><a href="#cb84-42" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb84-43"><a href="#cb84-43" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb84-44"><a href="#cb84-44" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_design_flagged_no_missingES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</section>
<section id="no-inferential-stats-for-smdh-effect-sizes-calculated-from-means-sds-and-sample-size" class="level3">
<h3 class="anchored" data-anchor-id="no-inferential-stats-for-smdh-effect-sizes-calculated-from-means-sds-and-sample-size">No inferential stats for SMDH: effect sizes calculated from means, SDs, and sample size</h3>
<p>(i.e., excluding any effect sizes calculated from inferential statistics)</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [18]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for SMDH as Effect Size</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparing new variance-covariance matrix</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_no_inferential <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> SMDH_no_inferential,</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Running intercept only model</span></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>SA_SMDH_no_inferential<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_no_inferential, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb85-28"><a href="#cb85-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> SMDH_no_inferential)</span>
<span id="cb85-29"><a href="#cb85-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-30"><a href="#cb85-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-31"><a href="#cb85-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-32"><a href="#cb85-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb85-33"><a href="#cb85-33" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_SMDH_no_inferential, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/sensitivity_analysis/SA_SMDH_no_inferential.rds"</span>))</span>
<span id="cb85-34"><a href="#cb85-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-35"><a href="#cb85-35" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb85-36"><a href="#cb85-36" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(SMDH_no_inferential,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/05_data_sensitivity_analysis/dataset_SMDH_no_inferential.csv"</span>))</span>
<span id="cb85-37"><a href="#cb85-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-38"><a href="#cb85-38" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the effect now?</span></span>
<span id="cb85-39"><a href="#cb85-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-40"><a href="#cb85-40" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SA_SMDH_no_inferential)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 245; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-319.1347   638.2694   650.2694   671.2524   650.6238   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0005     26     no        paper_ID 
sigma^2.2  0.2716  0.5212    245     no  Observation_ID 
sigma^2.3  0.0000  0.0018     46     no  group_ID_coded 
sigma^2.4  0.0000  0.0001     17     no   population_ID 
sigma^2.5  0.0000  0.0000      7     no    bird_species 

Test for Heterogeneity:
Q(df = 244) = 1105.9021, p-val &lt; .0001

Model Results:

estimate      se    tval   df    pval   ci.lb   ci.ub     
  0.1794  0.0685  2.6193  244  0.0094  0.0445  0.3143  ** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(SA_SMDH_no_inferential)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se  ci.lb  ci.ub   pi.lb  pi.ub 
 0.1794 0.0685 0.0445 0.3143 -0.8560 1.2148 </code></pre>
</div>
</div></div>
</section>
<section id="exluding-failed-gearys-test-for-lnrr" class="level3">
<h3 class="anchored" data-anchor-id="exluding-failed-gearys-test-for-lnrr">Exluding failed geary’s test for lnRR</h3>
<div class="cell-container"><div class="cell-decorator"><pre>In [19]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for  lnRR  as Effect Size</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_geary_passed <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> lnRR_geary_passed,</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>SA_lnRR_geary_passed<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_geary_passed, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> lnRR_geary_passed)</span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_lnRR_geary_passed, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/sensitivity_analysis/SA_lnRR_geary_passed.rds"</span>))</span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(lnRR_geary_passed,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/05_data_sensitivity_analysis/dataset_lnRR_geary_passed.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</section>
<section id="excluding-the-parasite-and-pathogen-load-fitness-proxies" class="level3">
<h3 class="anchored" data-anchor-id="excluding-the-parasite-and-pathogen-load-fitness-proxies">Excluding the parasite and pathogen load fitness proxies</h3>
<p>It excludes all the fitness proxies relating to parasite and pathogen loads/ abundance etc.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [20]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for  lnRR  as Effect Size</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_no_para<span class="ot">&lt;-</span>dataset_lnRR<span class="sc">%&gt;%</span><span class="fu">filter</span>(<span class="fu">is.na</span>(parasite_type))</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="do">## The dataset is reduced to almost half</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(dataset_lnRR)<span class="sc">-</span><span class="fu">nrow</span>(dataset_lnRR_no_para)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 82</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_no_para <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_no_para,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>SA_lnRR_no_para<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_no_para, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> dataset_lnRR_no_para)</span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_lnRR_no_para, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/sensitivity_analysis/SA_lnRR_no_para.rds"</span>))</span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb92-26"><a href="#cb92-26" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_lnRR_no_para,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/05_data_sensitivity_analysis/dataset_lnRR_no_para.csv"</span>))</span>
<span id="cb92-27"><a href="#cb92-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-28"><a href="#cb92-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-29"><a href="#cb92-29" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb92-30"><a href="#cb92-30" aria-hidden="true" tabindex="-1"></a><span class="co"># for  SMDH  as Effect Size</span></span>
<span id="cb92-31"><a href="#cb92-31" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb92-32"><a href="#cb92-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-33"><a href="#cb92-33" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_no_para<span class="ot">&lt;-</span>dataset_SMDH<span class="sc">%&gt;%</span><span class="fu">filter</span>(<span class="fu">is.na</span>(parasite_type))</span>
<span id="cb92-34"><a href="#cb92-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-35"><a href="#cb92-35" aria-hidden="true" tabindex="-1"></a><span class="do">## The dataset is reduced to almost half</span></span>
<span id="cb92-36"><a href="#cb92-36" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(dataset_SMDH)<span class="sc">-</span><span class="fu">nrow</span>(dataset_SMDH_no_para)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 86</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_no_para <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_no_para,</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span>) <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>SA_SMDH_no_para<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_no_para, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> dataset_SMDH_no_para)</span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_SMDH_no_para, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/sensitivity_analysis/SA_SMDH_no_para.rds"</span>))</span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_SMDH_no_para,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/05_data_sensitivity_analysis/dataset_SMDH_no_para.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</section>
<section id="different-values-of-sampling-variance-correlation" class="level2">
<h2 class="anchored" data-anchor-id="different-values-of-sampling-variance-correlation">Different values of sampling variance correlation</h2>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Pre-registered</strong>: We will also perform a sensitivity analysis using 0.3 and 0.7 correlation between the sampling variances from the same paper_ID and report it in the supplementary materials. If this sensitivity analysis shows large differences in conclusions for the intercept-only model, we will proceed to perform such sensitivity analysis for the meta-regressions.</p>
</div>
</div>
<p>First, set a series of ρs (i.e., 0.3, 0.5, 0.7) (we assume these values arbitrarily):</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [21]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rho_range &lt;- c(0.2,0.3, 0.5, 0.7,0.8)</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="co"># SA_lnRR_VCV_range &lt;- list() # repeatedly run the specified model with varying rho</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:length(rho_range)){</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   VCV_range &lt;- vcalc(vi = lnRR_variance,</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                      cluster = paper_ID,</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                      obs = Observation_ID,</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                      data = dataset_lnRR,</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                      rho = rho_range[i])</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   lnRR_VCV_range[[i]] &lt;- rma.mv(yi = lnRR_sign,</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 V = VCV_range,</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 random = list(~ 1 | paper_ID,</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                                               ~ 1 | Observation_ID,</span></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                                               ~ 1 | group_ID_coded,</span></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                                               ~ 1 | population_ID,</span></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a><span class="co">#                                               ~ 1 | bird_species),</span></span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 method = "REML",</span></span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 data = dataset_lnRR)</span></span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a><span class="co"># save(SA_lnRR_VCV_range, file = here::here("model/sensitivity_analysis/SA_lnRR_VCV_range.rds"))</span></span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a><span class="co"># #------------------------------------------------------------------</span></span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a><span class="co"># #-------------Now for SMDH the same SA with diff Rho---------------</span></span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a><span class="co"># #------------------------------------------------------------------</span></span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a><span class="co"># SA_SMDH_VCV_range &lt;- list()</span></span>
<span id="cb95-31"><a href="#cb95-31" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-32"><a href="#cb95-32" aria-hidden="true" tabindex="-1"></a><span class="co"># for (i in 1:length(rho_range)){</span></span>
<span id="cb95-33"><a href="#cb95-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   VCV_range &lt;- vcalc(vi = SMDH_variance,</span></span>
<span id="cb95-34"><a href="#cb95-34" aria-hidden="true" tabindex="-1"></a><span class="co">#                      cluster = paper_ID,</span></span>
<span id="cb95-35"><a href="#cb95-35" aria-hidden="true" tabindex="-1"></a><span class="co">#                      obs = Observation_ID,</span></span>
<span id="cb95-36"><a href="#cb95-36" aria-hidden="true" tabindex="-1"></a><span class="co">#                      data = dataset_SMDH,</span></span>
<span id="cb95-37"><a href="#cb95-37" aria-hidden="true" tabindex="-1"></a><span class="co">#                      rho = rho_range[i])</span></span>
<span id="cb95-38"><a href="#cb95-38" aria-hidden="true" tabindex="-1"></a><span class="co">#   SA_SMDH_VCV_range[[i]] &lt;- rma.mv(yi = SMDH_sign,</span></span>
<span id="cb95-39"><a href="#cb95-39" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 V = VCV_range,</span></span>
<span id="cb95-40"><a href="#cb95-40" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 random = list(~ 1 | paper_ID,</span></span>
<span id="cb95-41"><a href="#cb95-41" aria-hidden="true" tabindex="-1"></a><span class="co">#                                               ~ 1 | Observation_ID,</span></span>
<span id="cb95-42"><a href="#cb95-42" aria-hidden="true" tabindex="-1"></a><span class="co">#                                               ~ 1 | group_ID_coded,</span></span>
<span id="cb95-43"><a href="#cb95-43" aria-hidden="true" tabindex="-1"></a><span class="co">#                                               ~ 1 | population_ID,</span></span>
<span id="cb95-44"><a href="#cb95-44" aria-hidden="true" tabindex="-1"></a><span class="co">#                                               ~ 1 | bird_species),</span></span>
<span id="cb95-45"><a href="#cb95-45" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 method = "REML",</span></span>
<span id="cb95-46"><a href="#cb95-46" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 data = dataset_SMDH)</span></span>
<span id="cb95-47"><a href="#cb95-47" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb95-48"><a href="#cb95-48" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-49"><a href="#cb95-49" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb95-50"><a href="#cb95-50" aria-hidden="true" tabindex="-1"></a><span class="co"># save(SA_SMDH_VCV_range, file = here::here("model/sensitivity_analysis/SA_SMDH_VCV_range.rds"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</section>
</section>
<section id="mechanistic-hypothesis" class="level1">
<h1>Mechanistic Hypothesis</h1>
<p>To address our secondary questions “Does the addition of green nest material by birds increase their reproductive success? (Courtship hypothesis)” and “Does the addition of green nest material have protective effects and health benefits for the nestlings? (Parental care hypothesis)”, we will make use of the unimoderator multilevel meta-regressions hypothesis type (levels: CH, PCH, Both) as the moderator.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [22]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>lnRR_hypothesis <span class="ot">&lt;-</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> Hypothesis,</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR)</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Save model</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_hypothesis, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_hypothesis.rds"</span>))</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_lnRR,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/hypothesis_lnRR.csv"</span>))</span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>lnRR_hypothesis_R2 <span class="ot">&lt;-</span> <span class="fu">r2_ml</span>(lnRR_hypothesis)</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(lnRR_hypothesis_R2 <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   R2_marginal R2_conditional 
           1.6            1.6 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>SMDH_hypothesis <span class="ot">&lt;-</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> Hypothesis,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH)</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Save model</span></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_hypothesis, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_hypothesis.rds"</span>))</span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_SMDH,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/hypothesis_SMDH.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</section>
<section id="meta-regressions" class="level1">
<h1>Meta-regressions</h1>
<p>For understanding the heterogeneity in our intercept-only model, we will run unimoderator multilevel meta-regressions (see section Exploratory Analyses in pre-registration or manuscript) using the following moderators:</p>
<section id="type-of-experimental-design" class="level2">
<h2 class="anchored" data-anchor-id="type-of-experimental-design">Type of experimental design</h2>
<p>(levels: 1 = non-aromatic vs.&nbsp;aromatic, 2 = no added material vs.&nbsp;aromatic, 3 = no added material vs.&nbsp;non-aromatic).</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [23]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This analysis only includes dataset that has a proxy relating to comaparision type</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_design <span class="ot">&lt;-</span> dataset_lnRR <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(comparision_type))</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_design <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_design,</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>lnRR_design <span class="ot">&lt;-</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_design ,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> comparision_type,</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_design )</span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_design, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_design.rds"</span>))</span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_lnRR_design,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/design_lnRR.csv"</span>))</span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a><span class="co"># This analysis only includes dataset that has a proxy relating to comaparision type</span></span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_design <span class="ot">&lt;-</span> dataset_SMDH <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(comparision_type))</span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_design <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb99-36"><a href="#cb99-36" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb99-37"><a href="#cb99-37" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_design,</span>
<span id="cb99-38"><a href="#cb99-38" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb99-39"><a href="#cb99-39" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb99-40"><a href="#cb99-40" aria-hidden="true" tabindex="-1"></a>SMDH_design <span class="ot">&lt;-</span></span>
<span id="cb99-41"><a href="#cb99-41" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb99-42"><a href="#cb99-42" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_design ,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb99-43"><a href="#cb99-43" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> comparision_type,</span>
<span id="cb99-44"><a href="#cb99-44" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb99-45"><a href="#cb99-45" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb99-46"><a href="#cb99-46" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb99-47"><a href="#cb99-47" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb99-48"><a href="#cb99-48" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb99-49"><a href="#cb99-49" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb99-50"><a href="#cb99-50" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb99-51"><a href="#cb99-51" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb99-52"><a href="#cb99-52" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_design )</span>
<span id="cb99-53"><a href="#cb99-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-54"><a href="#cb99-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb99-55"><a href="#cb99-55" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_design, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_design.rds"</span>))</span>
<span id="cb99-56"><a href="#cb99-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-57"><a href="#cb99-57" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb99-58"><a href="#cb99-58" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_SMDH_design,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/design_SMDH.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<p>Let me try to do a sensitivity analysis to see what happens when I remove the control condition of 3 in the overall model since that is expected to not have an effect according to the authors as well.. i.e.&nbsp;it is a double control..</p>
<section id="excluding-non-aromatic-and-blank-comparison-i.e.-the-two-control-group-comparison" class="level3">
<h3 class="anchored" data-anchor-id="excluding-non-aromatic-and-blank-comparison-i.e.-the-two-control-group-comparison">Excluding non-aromatic and blank comparison (i.e.&nbsp;the two control group comparison)</h3>
<div class="cell-container"><div class="cell-decorator"><pre>In [24]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For the lnRR effect size...</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_no_comp3<span class="ot">&lt;-</span>dataset_lnRR<span class="sc">%&gt;%</span><span class="fu">filter</span>(comparision_type<span class="sc">!=</span><span class="dv">3</span> <span class="sc">|</span> <span class="fu">is.na</span>(comparision_type))</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Only some rows are removed... </span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(dataset_lnRR)<span class="sc">-</span><span class="fu">nrow</span>(dataset_lnRR_no_comp3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_no_comp3 <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_no_comp3,</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>SA_lnRR_no_comp3<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_no_comp3, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> dataset_lnRR_no_comp3)</span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_lnRR_no_comp3, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/sensitivity_analysis/SA_lnRR_no_comp3.rds"</span>))</span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_lnRR_no_comp3,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/05_data_sensitivity_analysis/dataset_lnRR_no_comp3.csv"</span>))</span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-29"><a href="#cb102-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-30"><a href="#cb102-30" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb102-31"><a href="#cb102-31" aria-hidden="true" tabindex="-1"></a><span class="co"># for  SMDH  as Effect Size</span></span>
<span id="cb102-32"><a href="#cb102-32" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb102-33"><a href="#cb102-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-34"><a href="#cb102-34" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_no_comp3<span class="ot">&lt;-</span>dataset_SMDH<span class="sc">%&gt;%</span><span class="fu">filter</span>(comparision_type<span class="sc">!=</span><span class="dv">3</span> <span class="sc">|</span> <span class="fu">is.na</span>(comparision_type))</span>
<span id="cb102-35"><a href="#cb102-35" aria-hidden="true" tabindex="-1"></a><span class="do">## Only some rows are removed... </span></span>
<span id="cb102-36"><a href="#cb102-36" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(dataset_SMDH)<span class="sc">-</span><span class="fu">nrow</span>(dataset_SMDH_no_comp3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_no_comp3 <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_no_comp3,</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>SA_SMDH_no_comp3<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_no_comp3, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> dataset_SMDH_no_comp3)</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_SMDH_no_comp3, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/sensitivity_analysis/SA_SMDH_no_comp3.rds"</span>))</span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_SMDH_no_comp3,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/05_data_sensitivity_analysis/dataset_SMDH_no_comp3.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<p>Overall conclusions remain practically the same irrespective.. now what about the meta-regression using Type of Experiment Design</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [25]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_design_SA <span class="ot">&lt;-</span> dataset_lnRR <span class="sc">%&gt;%</span> <span class="fu">filter</span>(comparision_type<span class="sc">!=</span><span class="dv">3</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_design_SA <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_design_SA,</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>lnRR_design_SA <span class="ot">&lt;-</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_design_SA ,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> comparision_type,</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_design_SA )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Redundant predictors dropped from the model.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Now for SMDH</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_design_SA <span class="ot">&lt;-</span> dataset_SMDH <span class="sc">%&gt;%</span> <span class="fu">filter</span>(comparision_type<span class="sc">!=</span><span class="dv">3</span>)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_design_SA <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_design_SA,</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>SMDH_design_SA <span class="ot">&lt;-</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_design_SA ,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> comparision_type,</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_design_SA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Redundant predictors dropped from the model.</code></pre>
</div>
</div></div>
</section>
</section>
<section id="time-of-addition-of-green-nest-material" class="level2">
<h2 class="anchored" data-anchor-id="time-of-addition-of-green-nest-material">Time of addition of green nest material</h2>
<p>(levels: before egg hatching, after egg hatching, continuously throughout the nesting phase).</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [26]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="do">## We use the complete dataset in this case</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>lnRR_time_gnm_addition <span class="ot">&lt;-</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR,<span class="co"># specify lnRR's sampling variance using the variance-covariance matrix we created for the intercept-only model since the whole dataset is being used in this case as well</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> time_of_gnm_addition,</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR)</span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Saving the model</span></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_time_gnm_addition, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_time_gnm_addition.rds"</span>))</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_lnRR,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/time_gnm_lnRR.csv"</span>))</span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Now similarly for the SMDH effect size using the complete dataset</span></span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a>SMDH_time_gnm_addition <span class="ot">&lt;-</span></span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH,<span class="co"># specify lnRR's sampling variance using the variance-covariance matrix we created for the intercept-only model since the whole dataset is being used in this case as well</span></span>
<span id="cb109-28"><a href="#cb109-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> time_of_gnm_addition,</span>
<span id="cb109-29"><a href="#cb109-29" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb109-30"><a href="#cb109-30" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb109-31"><a href="#cb109-31" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb109-32"><a href="#cb109-32" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb109-33"><a href="#cb109-33" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb109-34"><a href="#cb109-34" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb109-35"><a href="#cb109-35" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb109-36"><a href="#cb109-36" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb109-37"><a href="#cb109-37" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH)</span>
<span id="cb109-38"><a href="#cb109-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-39"><a href="#cb109-39" aria-hidden="true" tabindex="-1"></a><span class="do">## Saving the model</span></span>
<span id="cb109-40"><a href="#cb109-40" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_time_gnm_addition, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_time_gnm_addition.rds"</span>))</span>
<span id="cb109-41"><a href="#cb109-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-42"><a href="#cb109-42" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb109-43"><a href="#cb109-43" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_SMDH,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/time_gnm_SMDH.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</section>
<section id="type-of-parasites" class="level2">
<h2 class="anchored" data-anchor-id="type-of-parasites">Type of parasites</h2>
<p>(levels: arthropods, micro-organisms)&nbsp;</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [27]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This analysis only includes dataset that has a proxy relating to parasite or pathogen</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_parasite <span class="ot">&lt;-</span> dataset_lnRR<span class="sc">%&gt;%</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(parasite_type))<span class="sc">%&gt;%</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">parasite_type=</span><span class="fu">as.factor</span>(parasite_type),</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">paper_ID=</span><span class="fu">as.factor</span>(paper_ID),</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Observation_ID=</span><span class="fu">as.factor</span>(Observation_ID),</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">group_ID_coded=</span><span class="fu">as.factor</span>(group_ID_coded),</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">bird_species=</span><span class="fu">as.factor</span>(bird_species))</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_parasite <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_parasite,</span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>lnRR_parasite <span class="ot">&lt;-</span></span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_parasite,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> parasite_type,</span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb110-25"><a href="#cb110-25" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb110-26"><a href="#cb110-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb110-27"><a href="#cb110-27" aria-hidden="true" tabindex="-1"></a>                   <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb110-28"><a href="#cb110-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb110-29"><a href="#cb110-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_parasite)</span>
<span id="cb110-30"><a href="#cb110-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-31"><a href="#cb110-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-32"><a href="#cb110-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb110-33"><a href="#cb110-33" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_parasite, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_parasite.rds"</span>))</span>
<span id="cb110-34"><a href="#cb110-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-35"><a href="#cb110-35" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb110-36"><a href="#cb110-36" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_lnRR_parasite,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/parasite_lnRR.csv"</span>))</span>
<span id="cb110-37"><a href="#cb110-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-38"><a href="#cb110-38" aria-hidden="true" tabindex="-1"></a><span class="do">### Similiarly for SMDH as well selecting the dataset with parasite type</span></span>
<span id="cb110-39"><a href="#cb110-39" aria-hidden="true" tabindex="-1"></a><span class="co"># This analysis only includes dataset that has a proxy relating to parasite or pathogen</span></span>
<span id="cb110-40"><a href="#cb110-40" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_parasite <span class="ot">&lt;-</span> dataset_SMDH<span class="sc">%&gt;%</span></span>
<span id="cb110-41"><a href="#cb110-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(parasite_type))</span>
<span id="cb110-42"><a href="#cb110-42" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_parasite <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb110-43"><a href="#cb110-43" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb110-44"><a href="#cb110-44" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb110-45"><a href="#cb110-45" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_parasite,</span>
<span id="cb110-46"><a href="#cb110-46" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb110-47"><a href="#cb110-47" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb110-48"><a href="#cb110-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-49"><a href="#cb110-49" aria-hidden="true" tabindex="-1"></a>SMDH_parasite <span class="ot">&lt;-</span></span>
<span id="cb110-50"><a href="#cb110-50" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb110-51"><a href="#cb110-51" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_parasite,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb110-52"><a href="#cb110-52" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> parasite_type,</span>
<span id="cb110-53"><a href="#cb110-53" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb110-54"><a href="#cb110-54" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb110-55"><a href="#cb110-55" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb110-56"><a href="#cb110-56" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb110-57"><a href="#cb110-57" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb110-58"><a href="#cb110-58" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb110-59"><a href="#cb110-59" aria-hidden="true" tabindex="-1"></a>                   <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb110-60"><a href="#cb110-60" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb110-61"><a href="#cb110-61" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_parasite)</span>
<span id="cb110-62"><a href="#cb110-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-63"><a href="#cb110-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the model</span></span>
<span id="cb110-64"><a href="#cb110-64" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_parasite, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_parasite.rds"</span>))</span>
<span id="cb110-65"><a href="#cb110-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-66"><a href="#cb110-66" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb110-67"><a href="#cb110-67" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_SMDH_parasite,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/parasite_SMDH.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<section id="bird-species" class="level4">
<h4 class="anchored" data-anchor-id="bird-species">Bird species</h4>
<p>(levels: Cyanistes caeruleus, Sturnus unicolor, Tachycineta bicolor, Sturnus vulgaris; note that these levels reflect the list of species studied in our current database, which may increase after updating our search and/or receiving unpublished data from authors)</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [28]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>lnRR_birds <span class="ot">&lt;-</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> bird_species,</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR)</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_birds, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_birds.rds"</span>))</span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the dataset for this model</span></span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_lnRR,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/birds_lnRR.csv"</span>))</span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Now doing this for SMDH</span></span>
<span id="cb111-22"><a href="#cb111-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-23"><a href="#cb111-23" aria-hidden="true" tabindex="-1"></a>SMDH_birds <span class="ot">&lt;-</span></span>
<span id="cb111-24"><a href="#cb111-24" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb111-25"><a href="#cb111-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb111-26"><a href="#cb111-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> bird_species,</span>
<span id="cb111-27"><a href="#cb111-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb111-28"><a href="#cb111-28" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb111-29"><a href="#cb111-29" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb111-30"><a href="#cb111-30" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb111-31"><a href="#cb111-31" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb111-32"><a href="#cb111-32" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb111-33"><a href="#cb111-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb111-34"><a href="#cb111-34" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb111-35"><a href="#cb111-35" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH)</span>
<span id="cb111-36"><a href="#cb111-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-37"><a href="#cb111-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb111-38"><a href="#cb111-38" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_birds, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_birds.rds"</span>))</span>
<span id="cb111-39"><a href="#cb111-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-40"><a href="#cb111-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the dataset for this model</span></span>
<span id="cb111-41"><a href="#cb111-41" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_SMDH,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/birds_SMDH.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</section>
<section id="type-of-trait-studied" class="level4">
<h4 class="anchored" data-anchor-id="type-of-trait-studied">Type of trait studied</h4>
<p>(levels:physiology, morphology, reproduction, behaviour, parasite and pathogenic load, phenology)</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [29]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>lnRR_trait <span class="ot">&lt;-</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> trait_type,</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR)</span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_trait, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_trait.rds"</span>))</span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the dataset for this model</span></span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_lnRR,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/trait_lnRR.csv"</span>))</span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Now similarly for SMDH</span></span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a>SMDH_trait <span class="ot">&lt;-</span></span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> trait_type,</span>
<span id="cb112-27"><a href="#cb112-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb112-28"><a href="#cb112-28" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb112-29"><a href="#cb112-29" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb112-30"><a href="#cb112-30" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb112-31"><a href="#cb112-31" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb112-32"><a href="#cb112-32" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb112-33"><a href="#cb112-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb112-34"><a href="#cb112-34" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb112-35"><a href="#cb112-35" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH)</span>
<span id="cb112-36"><a href="#cb112-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-37"><a href="#cb112-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb112-38"><a href="#cb112-38" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_trait, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_trait.rds"</span>))</span>
<span id="cb112-39"><a href="#cb112-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-40"><a href="#cb112-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the dataset for this model</span></span>
<span id="cb112-41"><a href="#cb112-41" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_SMDH,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/SMDH_lnRR.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</section>
</section>
</section>
<section id="sensitivity-analysis-excluding-non-aromatic-vs.-aromatic" class="level1">
<h1>Sensitivity Analysis: Excluding Non-aromatic Vs. Aromatic</h1>
<p>We are aware that removing over 50% of the dataset will cause some moderator levels to drop out. But if our goal is to critically examine the role of aromaticity and potentially argue that its importance has been overstated, this could be a very informative step.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [30]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For the lnRR effect size...</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_no_comp1<span class="ot">&lt;-</span>dataset_lnRR<span class="sc">%&gt;%</span><span class="fu">filter</span>(comparision_type<span class="sc">!=</span><span class="dv">1</span> <span class="sc">|</span> <span class="fu">is.na</span>(comparision_type))</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Only some rows are removed... </span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(dataset_lnRR)<span class="sc">-</span><span class="fu">nrow</span>(dataset_lnRR_no_comp1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 122</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_no_comp1 <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_no_comp1,</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>SA_lnRR_no_comp1<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_no_comp1, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> dataset_lnRR_no_comp1)</span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_lnRR_no_comp1, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/sensitivity_analysis/SA_lnRR_no_comp1.rds"</span>))</span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_lnRR_no_comp1,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/05_data_sensitivity_analysis/dataset_lnRR_no_comp1.csv"</span>))</span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-30"><a href="#cb115-30" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb115-31"><a href="#cb115-31" aria-hidden="true" tabindex="-1"></a><span class="co"># for  SMDH  as Effect Size</span></span>
<span id="cb115-32"><a href="#cb115-32" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb115-33"><a href="#cb115-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-34"><a href="#cb115-34" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_no_comp1<span class="ot">&lt;-</span>dataset_SMDH<span class="sc">%&gt;%</span><span class="fu">filter</span>(comparision_type<span class="sc">!=</span><span class="dv">1</span> <span class="sc">|</span> <span class="fu">is.na</span>(comparision_type))</span>
<span id="cb115-35"><a href="#cb115-35" aria-hidden="true" tabindex="-1"></a><span class="do">## Only some rows are removed... </span></span>
<span id="cb115-36"><a href="#cb115-36" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(dataset_SMDH)<span class="sc">-</span><span class="fu">nrow</span>(dataset_SMDH_no_comp1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 132</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_no_comp1 <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_no_comp1,</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>SA_SMDH_no_comp1<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_no_comp1, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> dataset_SMDH_no_comp1)</span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SA_SMDH_no_comp1, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/sensitivity_analysis/SA_SMDH_no_comp1.rds"</span>))</span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-24"><a href="#cb117-24" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the dataset for this model</span></span>
<span id="cb117-25"><a href="#cb117-25" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_SMDH_no_comp1,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/05_data_sensitivity_analysis/dataset_SMDH_no_comp1.csv"</span>))</span>
<span id="cb117-26"><a href="#cb117-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-27"><a href="#cb117-27" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb117-28"><a href="#cb117-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Rerunning the two mechanistic hypothesis meta-regressions with those effect sizes excluded</span></span>
<span id="cb117-29"><a href="#cb117-29" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb117-30"><a href="#cb117-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-31"><a href="#cb117-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-32"><a href="#cb117-32" aria-hidden="true" tabindex="-1"></a>lnRR_hypothesis_no_comp1 <span class="ot">&lt;-</span></span>
<span id="cb117-33"><a href="#cb117-33" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb117-34"><a href="#cb117-34" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_no_comp1,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb117-35"><a href="#cb117-35" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> Hypothesis,</span>
<span id="cb117-36"><a href="#cb117-36" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb117-37"><a href="#cb117-37" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb117-38"><a href="#cb117-38" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb117-39"><a href="#cb117-39" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb117-40"><a href="#cb117-40" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb117-41"><a href="#cb117-41" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb117-42"><a href="#cb117-42" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb117-43"><a href="#cb117-43" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb117-44"><a href="#cb117-44" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_no_comp1)</span>
<span id="cb117-45"><a href="#cb117-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Save model</span></span>
<span id="cb117-46"><a href="#cb117-46" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_hypothesis_no_comp1, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_hypothesis_no_comp1.rds"</span>))</span>
<span id="cb117-47"><a href="#cb117-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-48"><a href="#cb117-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-49"><a href="#cb117-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-50"><a href="#cb117-50" aria-hidden="true" tabindex="-1"></a>SMDH_hypothesis_no_comp1 <span class="ot">&lt;-</span></span>
<span id="cb117-51"><a href="#cb117-51" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb117-52"><a href="#cb117-52" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_no_comp1,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb117-53"><a href="#cb117-53" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> Hypothesis,</span>
<span id="cb117-54"><a href="#cb117-54" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb117-55"><a href="#cb117-55" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb117-56"><a href="#cb117-56" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb117-57"><a href="#cb117-57" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb117-58"><a href="#cb117-58" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb117-59"><a href="#cb117-59" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb117-60"><a href="#cb117-60" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb117-61"><a href="#cb117-61" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb117-62"><a href="#cb117-62" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_no_comp1)</span>
<span id="cb117-63"><a href="#cb117-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-64"><a href="#cb117-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Save model</span></span>
<span id="cb117-65"><a href="#cb117-65" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_hypothesis_no_comp1, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_hypothesis_no_comp1.rds"</span>))</span>
<span id="cb117-66"><a href="#cb117-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-67"><a href="#cb117-67" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb117-68"><a href="#cb117-68" aria-hidden="true" tabindex="-1"></a><span class="do">## Now re-running all the 5 meta-regressions once again</span></span>
<span id="cb117-69"><a href="#cb117-69" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------</span></span>
<span id="cb117-70"><a href="#cb117-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-71"><a href="#cb117-71" aria-hidden="true" tabindex="-1"></a><span class="co"># This analysis only includes dataset that has a proxy relating to comaparision type</span></span>
<span id="cb117-72"><a href="#cb117-72" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_design_no_comp1 <span class="ot">&lt;-</span> dataset_lnRR_no_comp1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(comparision_type))</span>
<span id="cb117-73"><a href="#cb117-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-74"><a href="#cb117-74" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_design_no_comp1 <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb117-75"><a href="#cb117-75" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb117-76"><a href="#cb117-76" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb117-77"><a href="#cb117-77" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_design_no_comp1,</span>
<span id="cb117-78"><a href="#cb117-78" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb117-79"><a href="#cb117-79" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb117-80"><a href="#cb117-80" aria-hidden="true" tabindex="-1"></a>lnRR_design_no_comp1 <span class="ot">&lt;-</span></span>
<span id="cb117-81"><a href="#cb117-81" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb117-82"><a href="#cb117-82" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_design_no_comp1 ,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb117-83"><a href="#cb117-83" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> comparision_type,</span>
<span id="cb117-84"><a href="#cb117-84" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb117-85"><a href="#cb117-85" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb117-86"><a href="#cb117-86" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb117-87"><a href="#cb117-87" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb117-88"><a href="#cb117-88" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb117-89"><a href="#cb117-89" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb117-90"><a href="#cb117-90" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb117-91"><a href="#cb117-91" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb117-92"><a href="#cb117-92" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_design_no_comp1 )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Redundant predictors dropped from the model.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_design_no_comp1, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_design_no_comp1.rds"</span>))</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="co"># This analysis only includes dataset that has a proxy relating to comaparision type</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_design_no_comp1 <span class="ot">&lt;-</span> dataset_SMDH_no_comp1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(comparision_type))</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_design_no_comp1 <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_design_no_comp1,</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>SMDH_design_no_comp1 <span class="ot">&lt;-</span></span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_design_no_comp1 ,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> comparision_type,</span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_design_no_comp1 )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Redundant predictors dropped from the model.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_design_no_comp1, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_design_no_comp1.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<p><br>
</p>
</section>
<section id="risk-of-bias" class="level1">
<h1>Risk of Bias</h1>
<p>We have pre-registered the Risk Of Bias analysis, the three we will explore:</p>
<ol type="1" class="">
<li class=""><p><strong>Blinding</strong></p>
<div class="cell-container"><div class="cell-decorator"><pre>In [31]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(dataset_lnRR<span class="sc">$</span>blinding)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] n y
Levels: n y</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>lnRR_blinding <span class="ot">&lt;-</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign,</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR,</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> blinding,</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR)</span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_blinding, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_blinding.rds"</span>))</span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the dataset for this model</span></span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_lnRR,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/lnRR_blinding.csv"</span>))</span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-23"><a href="#cb124-23" aria-hidden="true" tabindex="-1"></a>SMDH_blinding <span class="ot">&lt;-</span>metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, </span>
<span id="cb124-24"><a href="#cb124-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH,</span>
<span id="cb124-25"><a href="#cb124-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> blinding,</span>
<span id="cb124-26"><a href="#cb124-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb124-27"><a href="#cb124-27" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb124-28"><a href="#cb124-28" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb124-29"><a href="#cb124-29" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb124-30"><a href="#cb124-30" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb124-31"><a href="#cb124-31" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb124-32"><a href="#cb124-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb124-33"><a href="#cb124-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb124-34"><a href="#cb124-34" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH)</span>
<span id="cb124-35"><a href="#cb124-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-36"><a href="#cb124-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb124-37"><a href="#cb124-37" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_blinding, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_blinding.rds"</span>))</span>
<span id="cb124-38"><a href="#cb124-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-39"><a href="#cb124-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the dataset for this model</span></span>
<span id="cb124-40"><a href="#cb124-40" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_SMDH,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/SMDH_blinding.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></li>
<li class=""><p>Random Assignment</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [32]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(dataset_lnRR<span class="sc">$</span>random_assignment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] y n
Levels: n y</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>lnRR_random_assignment <span class="ot">&lt;-</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign,</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR,</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> random_assignment,</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR)</span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_random_assignment, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_random_assignment.rds"</span>))</span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the dataset for this model</span></span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_lnRR,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/lnRR_random_assignment.csv"</span>))</span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-21"><a href="#cb127-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-22"><a href="#cb127-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-23"><a href="#cb127-23" aria-hidden="true" tabindex="-1"></a>SMDH_random_assignment <span class="ot">&lt;-</span>metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, </span>
<span id="cb127-24"><a href="#cb127-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH,</span>
<span id="cb127-25"><a href="#cb127-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> random_assignment,</span>
<span id="cb127-26"><a href="#cb127-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb127-27"><a href="#cb127-27" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb127-28"><a href="#cb127-28" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb127-29"><a href="#cb127-29" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb127-30"><a href="#cb127-30" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb127-31"><a href="#cb127-31" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb127-32"><a href="#cb127-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb127-33"><a href="#cb127-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb127-34"><a href="#cb127-34" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH)</span>
<span id="cb127-35"><a href="#cb127-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-36"><a href="#cb127-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb127-37"><a href="#cb127-37" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_random_assignment, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_random_assignment.rds"</span>))</span>
<span id="cb127-38"><a href="#cb127-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-39"><a href="#cb127-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the dataset for this model</span></span>
<span id="cb127-40"><a href="#cb127-40" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_SMDH,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/SMDH_random_assignment.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></li>
<li class=""><p>Missing Vs. Not Missing</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [33]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(dataset_lnRR<span class="sc">$</span>missing_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] y n
Levels: n y</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>lnRR_missing_data <span class="ot">&lt;-</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign,</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR,</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> missing_data,</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR)</span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_missing_data, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_missing_data.rds"</span>))</span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the dataset for this model</span></span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_lnRR,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/lnRR_missing_data.csv"</span>))</span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-22"><a href="#cb130-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-23"><a href="#cb130-23" aria-hidden="true" tabindex="-1"></a>SMDH_missing_data <span class="ot">&lt;-</span>metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, </span>
<span id="cb130-24"><a href="#cb130-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH,</span>
<span id="cb130-25"><a href="#cb130-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> missing_data,</span>
<span id="cb130-26"><a href="#cb130-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb130-27"><a href="#cb130-27" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb130-28"><a href="#cb130-28" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb130-29"><a href="#cb130-29" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb130-30"><a href="#cb130-30" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb130-31"><a href="#cb130-31" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb130-32"><a href="#cb130-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb130-33"><a href="#cb130-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb130-34"><a href="#cb130-34" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH)</span>
<span id="cb130-35"><a href="#cb130-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-36"><a href="#cb130-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb130-37"><a href="#cb130-37" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_missing_data, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_missing_data.rds"</span>))</span>
<span id="cb130-38"><a href="#cb130-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-39"><a href="#cb130-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the dataset for this model</span></span>
<span id="cb130-40"><a href="#cb130-40" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dataset_SMDH,here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/04_data_analysis/SMDH_missing_data.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></li>
</ol>
</section>
<section id="publication-bias" class="level1">
<h1>Publication Bias</h1>
<p>Small study effects:</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [34]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_published<span class="ot">&lt;-</span>dataset_lnRR_published<span class="sc">%&gt;%</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">effective_n_inv=</span><span class="dv">1</span><span class="sc">/</span>((<span class="dv">4</span><span class="sc">*</span>effective_n_experiment<span class="sc">*</span>effective_n_control)<span class="sc">/</span>(effective_n_experiment<span class="sc">+</span>effective_n_control)))<span class="sc">%&gt;%</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sqrt_effective_n_inv=</span><span class="fu">sqrt</span>(effective_n_inv))</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>lnRR_small_study <span class="ot">&lt;-</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_published,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span>sqrt_effective_n_inv,</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_published)</span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_small_study, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_small_study.rds"</span>))</span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lnRR_small_study)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 221; method: REML)

  logLik  Deviance       AIC       BIC      AICc   
-22.8747   45.7494   59.7494   83.4729   60.2802   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0003     24     no        paper_ID 
sigma^2.2  0.0244  0.1561    221     no  Observation_ID 
sigma^2.3  0.0000  0.0002     44     no  group_ID_coded 
sigma^2.4  0.0000  0.0000     15     no   population_ID 
sigma^2.5  0.0000  0.0000      6     no    bird_species 

Test for Residual Heterogeneity:
QE(df = 219) = 2233.6944, p-val &lt; .0001

Test of Moderators (coefficient 2):
F(df1 = 1, df2 = 219) = 0.2828, p-val = 0.5954

Model Results:

                      estimate      se    tval   df    pval    ci.lb   ci.ub    
intrcpt                 0.0033  0.0349  0.0934  219  0.9257  -0.0656  0.0721    
sqrt_effective_n_inv    0.0793  0.1491  0.5318  219  0.5954  -0.2145  0.3731    

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">r2_ml</span>(lnRR_small_study)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   R2_marginal R2_conditional 
          0.34           0.34 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Now for SMDH model</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_published<span class="ot">&lt;-</span>dataset_SMDH_published<span class="sc">%&gt;%</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">effective_n_inv=</span><span class="dv">1</span><span class="sc">/</span>((<span class="dv">4</span><span class="sc">*</span>effective_n_experiment<span class="sc">*</span>effective_n_control)<span class="sc">/</span>(effective_n_experiment<span class="sc">+</span>effective_n_control)))<span class="sc">%&gt;%</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sqrt_effective_n_inv=</span><span class="fu">sqrt</span>(effective_n_inv))</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>SMDH_small_study <span class="ot">&lt;-</span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_published,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span>sqrt_effective_n_inv,</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_published)</span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_small_study, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_small_study.rds"</span>))</span>
<span id="cb135-24"><a href="#cb135-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-25"><a href="#cb135-25" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SMDH_small_study)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 235; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-305.6554   611.3107   625.3107   649.4680   625.8085   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0009     24     no        paper_ID 
sigma^2.2  0.2721  0.5216    235     no  Observation_ID 
sigma^2.3  0.0000  0.0004     45     no  group_ID_coded 
sigma^2.4  0.0000  0.0002     15     no   population_ID 
sigma^2.5  0.0000  0.0001      6     no    bird_species 

Test for Residual Heterogeneity:
QE(df = 233) = 1089.6262, p-val &lt; .0001

Test of Moderators (coefficient 2):
F(df1 = 1, df2 = 233) = 3.1936, p-val = 0.0752

Model Results:

                      estimate      se     tval   df    pval    ci.lb   ci.ub 
intrcpt                -0.0348  0.1441  -0.2417  233  0.8092  -0.3187  0.2491 
sqrt_effective_n_inv    1.3931  0.7795   1.7871  233  0.0752  -0.1428  2.9289 
                        
intrcpt                 
sqrt_effective_n_inv  . 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">r2_ml</span>(SMDH_small_study)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   R2_marginal R2_conditional 
          8.31           8.31 </code></pre>
</div>
</div></div>
<p>Decline effects (Time lag bias)</p>
<p>Next, run a uni-moderator meta-regression to test for evidence of decline effects (also known as time-lag bias) which includes year of publication (mean-centered) as the only moderator, and whose slope would provide information about whether the overall effect size has changed (decline) over time (Nakagawa et al.&nbsp;2022; Sánchez-Tójar et al.&nbsp;2018).</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [35]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_published<span class="ot">&lt;-</span>dataset_lnRR_published<span class="sc">%&gt;%</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_MeanCenter=</span><span class="fu">scale</span>(<span class="fu">as.numeric</span>(year_publication),<span class="at">scale=</span>F)[,<span class="dv">1</span>])</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>lnRR_decline_eff <span class="ot">&lt;-</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_published,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> year_MeanCenter,</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_published)</span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_decline_eff, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_decline_eff.rds"</span>))</span>
<span id="cb139-20"><a href="#cb139-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb139-21"><a href="#cb139-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lnRR_decline_eff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 221; method: REML)

  logLik  Deviance       AIC       BIC      AICc   
-22.3187   44.6375   58.6375   82.3610   59.1683   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0003     24     no        paper_ID 
sigma^2.2  0.0235  0.1533    221     no  Observation_ID 
sigma^2.3  0.0000  0.0001     44     no  group_ID_coded 
sigma^2.4  0.0000  0.0000     15     no   population_ID 
sigma^2.5  0.0000  0.0000      6     no    bird_species 

Test for Residual Heterogeneity:
QE(df = 219) = 1985.1165, p-val &lt; .0001

Test of Moderators (coefficient 2):
F(df1 = 1, df2 = 219) = 1.4831, p-val = 0.2246

Model Results:

                 estimate      se     tval   df    pval    ci.lb   ci.ub    
intrcpt            0.0209  0.0161   1.2979  219  0.1957  -0.0109  0.0527    
year_MeanCenter   -0.0018  0.0015  -1.2178  219  0.2246  -0.0048  0.0011    

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">r2_ml</span>(lnRR_decline_eff)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   R2_marginal R2_conditional 
          1.76           1.76 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="do">## --- Now for SMDH -----</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_published<span class="ot">&lt;-</span>dataset_SMDH_published<span class="sc">%&gt;%</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_MeanCenter=</span><span class="fu">scale</span>(<span class="fu">as.numeric</span>(year_publication),<span class="at">scale=</span>F)[,<span class="dv">1</span>])</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>SMDH_decline_eff <span class="ot">&lt;-</span></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_published,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> year_MeanCenter,</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_published)</span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_decline_eff, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_decline_eff.rds"</span>))</span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-24"><a href="#cb143-24" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SMDH_decline_eff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Multivariate Meta-Analysis Model (k = 235; method: REML)

   logLik   Deviance        AIC        BIC       AICc   
-306.7002   613.4005   627.4005   651.5577   627.8982   

Variance Components:

            estim    sqrt  nlvls  fixed          factor 
sigma^2.1  0.0000  0.0013     24     no        paper_ID 
sigma^2.2  0.2768  0.5261    235     no  Observation_ID 
sigma^2.3  0.0000  0.0029     45     no  group_ID_coded 
sigma^2.4  0.0000  0.0003     15     no   population_ID 
sigma^2.5  0.0000  0.0000      6     no    bird_species 

Test for Residual Heterogeneity:
QE(df = 233) = 1091.5803, p-val &lt; .0001

Test of Moderators (coefficient 2):
F(df1 = 1, df2 = 233) = 1.2515, p-val = 0.2644

Model Results:

                 estimate      se     tval   df    pval    ci.lb   ci.ub     
intrcpt            0.1935  0.0690   2.8051  233  0.0055   0.0576  0.3293  ** 
year_MeanCenter   -0.0083  0.0074  -1.1187  233  0.2644  -0.0228  0.0063     

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">r2_ml</span>(SMDH_decline_eff)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   R2_marginal R2_conditional 
          2.93           2.93 </code></pre>
</div>
</div></div>
<p>Last, run an all-in meta-regression including both the (square root of the) inverse of the ‘effective sample size’ and the mean-centered year of publication as well as all the other moderators tested in our study to estimate how much heterogeneity is explained by all moderators combined as well as to explore whether evidence remains similar after accounting for all the other moderators (see equation 29 in Nakagawa et al.&nbsp;2022 for more information about this approach).&nbsp;</p>
<section id="all-in-model-for-heterogeneity" class="level2">
<h2 class="anchored" data-anchor-id="all-in-model-for-heterogeneity">All-in Model for heterogeneity</h2>
<div class="cell-container"><div class="cell-decorator"><pre>In [36]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ## For lnRR complete dataset</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ## I am changing the year of unpublished studies to 2025 which is to now, assuming that if they were to be published now, what would be the effect. I will keep in mind that in this model if I do find an evidence of publication bias over years, I should keep in mind it is non-independent of the unpublished studies</span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_all_in<span class="ot">&lt;-</span>dataset_lnRR<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">year_publication =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(year_publication) <span class="sc">~</span> <span class="dv">2025</span>, <span class="cn">TRUE</span> <span class="sc">~</span> year_publication))<span class="sc">%&gt;%</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_MeanCenter=</span><span class="fu">scale</span>(<span class="fu">as.numeric</span>(year_publication),<span class="at">scale=</span>F)[,<span class="dv">1</span>])<span class="sc">%&gt;%</span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">effective_n_inv=</span><span class="dv">1</span><span class="sc">/</span>((<span class="dv">4</span><span class="sc">*</span>effective_n_experiment<span class="sc">*</span>effective_n_control)<span class="sc">/</span>(effective_n_experiment<span class="sc">+</span>effective_n_control)))<span class="sc">%&gt;%</span></span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sqrt_effective_n_inv=</span><span class="fu">sqrt</span>(effective_n_inv))<span class="sc">%&gt;%</span></span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comparision_type=</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(comparision_type) <span class="sc">~</span> <span class="fu">as.factor</span>(<span class="dv">4</span>), <span class="cn">TRUE</span> <span class="sc">~</span> comparision_type))</span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_all_in<span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_all_in,</span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb147-17"><a href="#cb147-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-18"><a href="#cb147-18" aria-hidden="true" tabindex="-1"></a>lnRR_all_in <span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb147-19"><a href="#cb147-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_all_in, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb147-20"><a href="#cb147-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> time_of_gnm_addition <span class="sc">+</span></span>
<span id="cb147-21"><a href="#cb147-21" aria-hidden="true" tabindex="-1"></a>                      year_MeanCenter <span class="sc">+</span></span>
<span id="cb147-22"><a href="#cb147-22" aria-hidden="true" tabindex="-1"></a>                      sqrt_effective_n_inv <span class="sc">+</span></span>
<span id="cb147-23"><a href="#cb147-23" aria-hidden="true" tabindex="-1"></a>                      comparision_type <span class="sc">+</span></span>
<span id="cb147-24"><a href="#cb147-24" aria-hidden="true" tabindex="-1"></a>                      bird_species <span class="sc">+</span></span>
<span id="cb147-25"><a href="#cb147-25" aria-hidden="true" tabindex="-1"></a>                      trait_type,</span>
<span id="cb147-26"><a href="#cb147-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb147-27"><a href="#cb147-27" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb147-28"><a href="#cb147-28" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb147-29"><a href="#cb147-29" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb147-30"><a href="#cb147-30" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb147-31"><a href="#cb147-31" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb147-32"><a href="#cb147-32" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb147-33"><a href="#cb147-33" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb147-34"><a href="#cb147-34" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> dataset_lnRR_all_in)</span>
<span id="cb147-35"><a href="#cb147-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-36"><a href="#cb147-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-37"><a href="#cb147-37" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb147-38"><a href="#cb147-38" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_all_in, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_all_in.rds"</span>))</span>
<span id="cb147-39"><a href="#cb147-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-40"><a href="#cb147-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-41"><a href="#cb147-41" aria-hidden="true" tabindex="-1"></a><span class="do">## For SMDH complete published dataset</span></span>
<span id="cb147-42"><a href="#cb147-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-43"><a href="#cb147-43" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_all_in<span class="ot">&lt;-</span>dataset_SMDH<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">year_publication =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(year_publication) <span class="sc">~</span> <span class="dv">2025</span>, <span class="cn">TRUE</span> <span class="sc">~</span> year_publication))<span class="sc">%&gt;%</span></span>
<span id="cb147-44"><a href="#cb147-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_MeanCenter=</span><span class="fu">scale</span>(<span class="fu">as.numeric</span>(year_publication),<span class="at">scale=</span>F)[,<span class="dv">1</span>])<span class="sc">%&gt;%</span></span>
<span id="cb147-45"><a href="#cb147-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">effective_n_inv=</span><span class="dv">1</span><span class="sc">/</span>((<span class="dv">4</span><span class="sc">*</span>effective_n_experiment<span class="sc">*</span>effective_n_control)<span class="sc">/</span>(effective_n_experiment<span class="sc">+</span>effective_n_control)))<span class="sc">%&gt;%</span></span>
<span id="cb147-46"><a href="#cb147-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sqrt_effective_n_inv=</span><span class="fu">sqrt</span>(effective_n_inv))<span class="sc">%&gt;%</span></span>
<span id="cb147-47"><a href="#cb147-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comparision_type=</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(comparision_type) <span class="sc">~</span> <span class="fu">as.factor</span>(<span class="dv">4</span>), <span class="cn">TRUE</span> <span class="sc">~</span> comparision_type))</span>
<span id="cb147-48"><a href="#cb147-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-49"><a href="#cb147-49" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_all_in<span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb147-50"><a href="#cb147-50" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb147-51"><a href="#cb147-51" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb147-52"><a href="#cb147-52" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_all_in,</span>
<span id="cb147-53"><a href="#cb147-53" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb147-54"><a href="#cb147-54" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb147-55"><a href="#cb147-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-56"><a href="#cb147-56" aria-hidden="true" tabindex="-1"></a>SMDH_all_in<span class="ot">&lt;-</span> <span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb147-57"><a href="#cb147-57" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_all_in, <span class="co"># specify lnRR's sampling variance-covariance matrix;</span></span>
<span id="cb147-58"><a href="#cb147-58" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> time_of_gnm_addition <span class="sc">+</span></span>
<span id="cb147-59"><a href="#cb147-59" aria-hidden="true" tabindex="-1"></a>                      year_MeanCenter <span class="sc">+</span></span>
<span id="cb147-60"><a href="#cb147-60" aria-hidden="true" tabindex="-1"></a>                      sqrt_effective_n_inv <span class="sc">+</span></span>
<span id="cb147-61"><a href="#cb147-61" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">as.factor</span>(comparision_type) <span class="sc">+</span></span>
<span id="cb147-62"><a href="#cb147-62" aria-hidden="true" tabindex="-1"></a>                      bird_species <span class="sc">+</span></span>
<span id="cb147-63"><a href="#cb147-63" aria-hidden="true" tabindex="-1"></a>                      trait_type,</span>
<span id="cb147-64"><a href="#cb147-64" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb147-65"><a href="#cb147-65" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb147-66"><a href="#cb147-66" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb147-67"><a href="#cb147-67" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb147-68"><a href="#cb147-68" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb147-69"><a href="#cb147-69" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb147-70"><a href="#cb147-70" aria-hidden="true" tabindex="-1"></a>                    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb147-71"><a href="#cb147-71" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb147-72"><a href="#cb147-72" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> dataset_SMDH_all_in)</span>
<span id="cb147-73"><a href="#cb147-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-74"><a href="#cb147-74" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb147-75"><a href="#cb147-75" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_all_in, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_all_in.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</section>
</section>
<section id="pair-wise-comparison-for-meta-regression" class="level1">
<h1>Pair-wise comparison for meta-regression</h1>
<p>Including post-hoc Wald tests</p>
<p>For this I have to run all the meta-regressions again without removing the intercepts</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [37]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------------</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="co"># For Different hypothesis</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------------</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="do">## For lnRR</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>VCV_lnRR<span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR,</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a>lnRR_hypothesis_pc <span class="ot">&lt;-</span></span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> Hypothesis,</span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb148-18"><a href="#cb148-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb148-19"><a href="#cb148-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb148-20"><a href="#cb148-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb148-21"><a href="#cb148-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb148-22"><a href="#cb148-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb148-23"><a href="#cb148-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb148-24"><a href="#cb148-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR)</span>
<span id="cb148-25"><a href="#cb148-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-26"><a href="#cb148-26" aria-hidden="true" tabindex="-1"></a><span class="co"># I now want to test for statistical differences between groups. Male and fem</span></span>
<span id="cb148-27"><a href="#cb148-27" aria-hidden="true" tabindex="-1"></a><span class="co"># information for androgens can be obtained from the outcome of the table. For thyroid</span></span>
<span id="cb148-28"><a href="#cb148-28" aria-hidden="true" tabindex="-1"></a><span class="co"># hormones I need to do Post-hoc Wald tests:</span></span>
<span id="cb148-29"><a href="#cb148-29" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">linearHypothesis</span>(lnRR_hypothesis_pc, <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Linear hypothesis test:
HypothesisCH - HypothesisPCH = 0

Model 1: restricted model
Model 2: ~Hypothesis

  Res.Df Df  Chisq Pr(&gt;Chisq)
1    236                     
2    235  1 0.1986     0.6559</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_hypothesis_pc, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_hypothesis_pc.rds"</span>))</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="co"># For SMDH</span></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>VCV_SMDH <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH,</span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a>SMDH_hypothesis_pc <span class="ot">&lt;-</span></span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> Hypothesis,</span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb150-18"><a href="#cb150-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb150-19"><a href="#cb150-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb150-20"><a href="#cb150-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb150-21"><a href="#cb150-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb150-22"><a href="#cb150-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb150-23"><a href="#cb150-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb150-24"><a href="#cb150-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb150-25"><a href="#cb150-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH)</span>
<span id="cb150-26"><a href="#cb150-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-27"><a href="#cb150-27" aria-hidden="true" tabindex="-1"></a><span class="co"># I now want to test for statistical differences between groups. Male and fem</span></span>
<span id="cb150-28"><a href="#cb150-28" aria-hidden="true" tabindex="-1"></a><span class="co"># information for androgens can be obtained from the outcome of the table. For thyroid</span></span>
<span id="cb150-29"><a href="#cb150-29" aria-hidden="true" tabindex="-1"></a><span class="co"># hormones I need to do Post-hoc Wald tests:</span></span>
<span id="cb150-30"><a href="#cb150-30" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">linearHypothesis</span>(SMDH_hypothesis_pc, <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Linear hypothesis test:
HypothesisCH - HypothesisPCH = 0

Model 1: restricted model
Model 2: ~Hypothesis

  Res.Df Df  Chisq Pr(&gt;Chisq)
1    251                     
2    250  1 0.0493     0.8243</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># saving the model</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_hypothesis_pc, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_hypothesis_pc.rds"</span>))</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------------</span></span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a><span class="co"># For Type of experimental design</span></span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------------</span></span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a><span class="co"># This analysis only includes dataset that has a proxy relating to comaparision type</span></span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_design <span class="ot">&lt;-</span> dataset_lnRR <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(comparision_type))</span>
<span id="cb152-12"><a href="#cb152-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-13"><a href="#cb152-13" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_design <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb152-14"><a href="#cb152-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb152-15"><a href="#cb152-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb152-16"><a href="#cb152-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_design,</span>
<span id="cb152-17"><a href="#cb152-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb152-18"><a href="#cb152-18" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb152-19"><a href="#cb152-19" aria-hidden="true" tabindex="-1"></a>lnRR_design_pc <span class="ot">&lt;-</span></span>
<span id="cb152-20"><a href="#cb152-20" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb152-21"><a href="#cb152-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_design ,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb152-22"><a href="#cb152-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> comparision_type,</span>
<span id="cb152-23"><a href="#cb152-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb152-24"><a href="#cb152-24" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb152-25"><a href="#cb152-25" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb152-26"><a href="#cb152-26" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb152-27"><a href="#cb152-27" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb152-28"><a href="#cb152-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb152-29"><a href="#cb152-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb152-30"><a href="#cb152-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb152-31"><a href="#cb152-31" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_design )</span>
<span id="cb152-32"><a href="#cb152-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-33"><a href="#cb152-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb152-34"><a href="#cb152-34" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_design_pc, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_design_pc.rds"</span>))</span>
<span id="cb152-35"><a href="#cb152-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-36"><a href="#cb152-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-37"><a href="#cb152-37" aria-hidden="true" tabindex="-1"></a><span class="co"># This analysis only includes dataset that has a proxy relating to comaparision type</span></span>
<span id="cb152-38"><a href="#cb152-38" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_design <span class="ot">&lt;-</span> dataset_SMDH <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(comparision_type))</span>
<span id="cb152-39"><a href="#cb152-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-40"><a href="#cb152-40" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_design <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb152-41"><a href="#cb152-41" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb152-42"><a href="#cb152-42" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb152-43"><a href="#cb152-43" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_design,</span>
<span id="cb152-44"><a href="#cb152-44" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb152-45"><a href="#cb152-45" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb152-46"><a href="#cb152-46" aria-hidden="true" tabindex="-1"></a>SMDH_design_pc <span class="ot">&lt;-</span></span>
<span id="cb152-47"><a href="#cb152-47" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb152-48"><a href="#cb152-48" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_design ,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb152-49"><a href="#cb152-49" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> comparision_type,</span>
<span id="cb152-50"><a href="#cb152-50" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb152-51"><a href="#cb152-51" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb152-52"><a href="#cb152-52" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb152-53"><a href="#cb152-53" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb152-54"><a href="#cb152-54" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb152-55"><a href="#cb152-55" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb152-56"><a href="#cb152-56" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb152-57"><a href="#cb152-57" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb152-58"><a href="#cb152-58" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_design )</span>
<span id="cb152-59"><a href="#cb152-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-60"><a href="#cb152-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb152-61"><a href="#cb152-61" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_design_pc, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_design_pc.rds"</span>))</span>
<span id="cb152-62"><a href="#cb152-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-63"><a href="#cb152-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-64"><a href="#cb152-64" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------------</span></span>
<span id="cb152-65"><a href="#cb152-65" aria-hidden="true" tabindex="-1"></a><span class="co"># For Time of addition of GNM</span></span>
<span id="cb152-66"><a href="#cb152-66" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------------</span></span>
<span id="cb152-67"><a href="#cb152-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-68"><a href="#cb152-68" aria-hidden="true" tabindex="-1"></a><span class="do">## We use the complete dataset in this case</span></span>
<span id="cb152-69"><a href="#cb152-69" aria-hidden="true" tabindex="-1"></a>lnRR_time_gnm_addition_pc <span class="ot">&lt;-</span></span>
<span id="cb152-70"><a href="#cb152-70" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb152-71"><a href="#cb152-71" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR,<span class="co"># specify lnRR's sampling variance using the variance-covariance matrix we created for the intercept-only model since the whole dataset is being used in this case as well</span></span>
<span id="cb152-72"><a href="#cb152-72" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> time_of_gnm_addition,</span>
<span id="cb152-73"><a href="#cb152-73" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb152-74"><a href="#cb152-74" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb152-75"><a href="#cb152-75" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb152-76"><a href="#cb152-76" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb152-77"><a href="#cb152-77" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb152-78"><a href="#cb152-78" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb152-79"><a href="#cb152-79" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb152-80"><a href="#cb152-80" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb152-81"><a href="#cb152-81" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR)</span>
<span id="cb152-82"><a href="#cb152-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-83"><a href="#cb152-83" aria-hidden="true" tabindex="-1"></a><span class="do">## Saving the model</span></span>
<span id="cb152-84"><a href="#cb152-84" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_time_gnm_addition_pc, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_time_gnm_addition_pc.rds"</span>))</span>
<span id="cb152-85"><a href="#cb152-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-86"><a href="#cb152-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-87"><a href="#cb152-87" aria-hidden="true" tabindex="-1"></a><span class="do">## Now similarly for the SMDH effect size using the complete dataset</span></span>
<span id="cb152-88"><a href="#cb152-88" aria-hidden="true" tabindex="-1"></a>SMDH_time_gnm_addition_pc <span class="ot">&lt;-</span></span>
<span id="cb152-89"><a href="#cb152-89" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb152-90"><a href="#cb152-90" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH,<span class="co"># specify lnRR's sampling variance using the variance-covariance matrix we created for the intercept-only model since the whole dataset is being used in this case as well</span></span>
<span id="cb152-91"><a href="#cb152-91" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> time_of_gnm_addition,</span>
<span id="cb152-92"><a href="#cb152-92" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb152-93"><a href="#cb152-93" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb152-94"><a href="#cb152-94" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb152-95"><a href="#cb152-95" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb152-96"><a href="#cb152-96" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb152-97"><a href="#cb152-97" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb152-98"><a href="#cb152-98" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb152-99"><a href="#cb152-99" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb152-100"><a href="#cb152-100" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH)</span>
<span id="cb152-101"><a href="#cb152-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-102"><a href="#cb152-102" aria-hidden="true" tabindex="-1"></a><span class="do">## Saving the model</span></span>
<span id="cb152-103"><a href="#cb152-103" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_time_gnm_addition_pc, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_time_gnm_addition_pc.rds"</span>))</span>
<span id="cb152-104"><a href="#cb152-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-105"><a href="#cb152-105" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------------</span></span>
<span id="cb152-106"><a href="#cb152-106" aria-hidden="true" tabindex="-1"></a><span class="co"># Parasite Type</span></span>
<span id="cb152-107"><a href="#cb152-107" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------------</span></span>
<span id="cb152-108"><a href="#cb152-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-109"><a href="#cb152-109" aria-hidden="true" tabindex="-1"></a><span class="co"># This analysis only includes dataset that has a proxy relating to parasite or pathogen</span></span>
<span id="cb152-110"><a href="#cb152-110" aria-hidden="true" tabindex="-1"></a>dataset_lnRR_parasite <span class="ot">&lt;-</span> dataset_lnRR<span class="sc">%&gt;%</span></span>
<span id="cb152-111"><a href="#cb152-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(parasite_type))<span class="sc">%&gt;%</span></span>
<span id="cb152-112"><a href="#cb152-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">parasite_type=</span><span class="fu">as.factor</span>(parasite_type),</span>
<span id="cb152-113"><a href="#cb152-113" aria-hidden="true" tabindex="-1"></a>         <span class="at">paper_ID=</span><span class="fu">as.factor</span>(paper_ID),</span>
<span id="cb152-114"><a href="#cb152-114" aria-hidden="true" tabindex="-1"></a>         <span class="at">Observation_ID=</span><span class="fu">as.factor</span>(Observation_ID),</span>
<span id="cb152-115"><a href="#cb152-115" aria-hidden="true" tabindex="-1"></a>         <span class="at">group_ID_coded=</span><span class="fu">as.factor</span>(group_ID_coded),</span>
<span id="cb152-116"><a href="#cb152-116" aria-hidden="true" tabindex="-1"></a>         <span class="at">bird_species=</span><span class="fu">as.factor</span>(bird_species))</span>
<span id="cb152-117"><a href="#cb152-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-118"><a href="#cb152-118" aria-hidden="true" tabindex="-1"></a>VCV_lnRR_parasite <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> lnRR_variance,</span>
<span id="cb152-119"><a href="#cb152-119" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb152-120"><a href="#cb152-120" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb152-121"><a href="#cb152-121" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_parasite,</span>
<span id="cb152-122"><a href="#cb152-122" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb152-123"><a href="#cb152-123" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb152-124"><a href="#cb152-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-125"><a href="#cb152-125" aria-hidden="true" tabindex="-1"></a>lnRR_parasite_pc <span class="ot">&lt;-</span></span>
<span id="cb152-126"><a href="#cb152-126" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb152-127"><a href="#cb152-127" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR_parasite,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb152-128"><a href="#cb152-128" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> parasite_type,</span>
<span id="cb152-129"><a href="#cb152-129" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb152-130"><a href="#cb152-130" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb152-131"><a href="#cb152-131" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb152-132"><a href="#cb152-132" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb152-133"><a href="#cb152-133" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb152-134"><a href="#cb152-134" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb152-135"><a href="#cb152-135" aria-hidden="true" tabindex="-1"></a>                   <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb152-136"><a href="#cb152-136" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb152-137"><a href="#cb152-137" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR_parasite)</span>
<span id="cb152-138"><a href="#cb152-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-139"><a href="#cb152-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-140"><a href="#cb152-140" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb152-141"><a href="#cb152-141" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_parasite_pc, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_parasite_pc.rds"</span>))</span>
<span id="cb152-142"><a href="#cb152-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-143"><a href="#cb152-143" aria-hidden="true" tabindex="-1"></a><span class="do">### Similiarly for SMDH as well selecting the dataset with parasite type</span></span>
<span id="cb152-144"><a href="#cb152-144" aria-hidden="true" tabindex="-1"></a><span class="co"># This analysis only includes dataset that has a proxy relating to parasite or pathogen</span></span>
<span id="cb152-145"><a href="#cb152-145" aria-hidden="true" tabindex="-1"></a>dataset_SMDH_parasite <span class="ot">&lt;-</span> dataset_SMDH<span class="sc">%&gt;%</span></span>
<span id="cb152-146"><a href="#cb152-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(parasite_type))</span>
<span id="cb152-147"><a href="#cb152-147" aria-hidden="true" tabindex="-1"></a>VCV_SMDH_parasite <span class="ot">&lt;-</span> <span class="fu">vcalc</span>(<span class="at">vi =</span> SMDH_variance,</span>
<span id="cb152-148"><a href="#cb152-148" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> paper_ID,</span>
<span id="cb152-149"><a href="#cb152-149" aria-hidden="true" tabindex="-1"></a>                  <span class="at">obs =</span> Observation_ID,</span>
<span id="cb152-150"><a href="#cb152-150" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_parasite,</span>
<span id="cb152-151"><a href="#cb152-151" aria-hidden="true" tabindex="-1"></a>                  <span class="at">rho =</span> <span class="fl">0.5</span> <span class="co"># assuming that the effect sizes within the same study are correlated with rho = 0.5</span></span>
<span id="cb152-152"><a href="#cb152-152" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb152-153"><a href="#cb152-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-154"><a href="#cb152-154" aria-hidden="true" tabindex="-1"></a>SMDH_parasite_pc <span class="ot">&lt;-</span></span>
<span id="cb152-155"><a href="#cb152-155" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb152-156"><a href="#cb152-156" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH_parasite,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb152-157"><a href="#cb152-157" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span>  parasite_type,</span>
<span id="cb152-158"><a href="#cb152-158" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb152-159"><a href="#cb152-159" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb152-160"><a href="#cb152-160" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb152-161"><a href="#cb152-161" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb152-162"><a href="#cb152-162" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb152-163"><a href="#cb152-163" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb152-164"><a href="#cb152-164" aria-hidden="true" tabindex="-1"></a>                   <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb152-165"><a href="#cb152-165" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb152-166"><a href="#cb152-166" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH_parasite)</span>
<span id="cb152-167"><a href="#cb152-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-168"><a href="#cb152-168" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the model</span></span>
<span id="cb152-169"><a href="#cb152-169" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_parasite_pc, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_parasite_pc.rds"</span>))</span>
<span id="cb152-170"><a href="#cb152-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-171"><a href="#cb152-171" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------------</span></span>
<span id="cb152-172"><a href="#cb152-172" aria-hidden="true" tabindex="-1"></a><span class="co"># Bird Species</span></span>
<span id="cb152-173"><a href="#cb152-173" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------------</span></span>
<span id="cb152-174"><a href="#cb152-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-175"><a href="#cb152-175" aria-hidden="true" tabindex="-1"></a>lnRR_birds_pc <span class="ot">&lt;-</span></span>
<span id="cb152-176"><a href="#cb152-176" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb152-177"><a href="#cb152-177" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb152-178"><a href="#cb152-178" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> bird_species,</span>
<span id="cb152-179"><a href="#cb152-179" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb152-180"><a href="#cb152-180" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb152-181"><a href="#cb152-181" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb152-182"><a href="#cb152-182" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb152-183"><a href="#cb152-183" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb152-184"><a href="#cb152-184" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb152-185"><a href="#cb152-185" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb152-186"><a href="#cb152-186" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb152-187"><a href="#cb152-187" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR)</span>
<span id="cb152-188"><a href="#cb152-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-189"><a href="#cb152-189" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb152-190"><a href="#cb152-190" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_birds_pc, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_birds_pc.rds"</span>))</span>
<span id="cb152-191"><a href="#cb152-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-192"><a href="#cb152-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-193"><a href="#cb152-193" aria-hidden="true" tabindex="-1"></a><span class="do">## Now doing this for SMDH</span></span>
<span id="cb152-194"><a href="#cb152-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-195"><a href="#cb152-195" aria-hidden="true" tabindex="-1"></a>SMDH_birds_pc <span class="ot">&lt;-</span></span>
<span id="cb152-196"><a href="#cb152-196" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb152-197"><a href="#cb152-197" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb152-198"><a href="#cb152-198" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span>  bird_species,</span>
<span id="cb152-199"><a href="#cb152-199" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb152-200"><a href="#cb152-200" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb152-201"><a href="#cb152-201" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb152-202"><a href="#cb152-202" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb152-203"><a href="#cb152-203" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb152-204"><a href="#cb152-204" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb152-205"><a href="#cb152-205" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb152-206"><a href="#cb152-206" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb152-207"><a href="#cb152-207" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH)</span>
<span id="cb152-208"><a href="#cb152-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-209"><a href="#cb152-209" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb152-210"><a href="#cb152-210" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_birds_pc, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_birds_pc.rds"</span>))</span>
<span id="cb152-211"><a href="#cb152-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-212"><a href="#cb152-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-213"><a href="#cb152-213" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------------</span></span>
<span id="cb152-214"><a href="#cb152-214" aria-hidden="true" tabindex="-1"></a><span class="co"># Type of trait studied</span></span>
<span id="cb152-215"><a href="#cb152-215" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------------------------------</span></span>
<span id="cb152-216"><a href="#cb152-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-217"><a href="#cb152-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-218"><a href="#cb152-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-219"><a href="#cb152-219" aria-hidden="true" tabindex="-1"></a>lnRR_trait_pc <span class="ot">&lt;-</span></span>
<span id="cb152-220"><a href="#cb152-220" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> lnRR_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb152-221"><a href="#cb152-221" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_lnRR,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb152-222"><a href="#cb152-222" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> trait_type,</span>
<span id="cb152-223"><a href="#cb152-223" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb152-224"><a href="#cb152-224" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb152-225"><a href="#cb152-225" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb152-226"><a href="#cb152-226" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb152-227"><a href="#cb152-227" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb152-228"><a href="#cb152-228" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb152-229"><a href="#cb152-229" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb152-230"><a href="#cb152-230" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb152-231"><a href="#cb152-231" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_lnRR)</span>
<span id="cb152-232"><a href="#cb152-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-233"><a href="#cb152-233" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb152-234"><a href="#cb152-234" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lnRR_trait_pc, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/lnRR_trait_pc.rds"</span>))</span>
<span id="cb152-235"><a href="#cb152-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-236"><a href="#cb152-236" aria-hidden="true" tabindex="-1"></a><span class="do">## Now similarly for SMDH</span></span>
<span id="cb152-237"><a href="#cb152-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-238"><a href="#cb152-238" aria-hidden="true" tabindex="-1"></a>SMDH_trait_pc <span class="ot">&lt;-</span></span>
<span id="cb152-239"><a href="#cb152-239" aria-hidden="true" tabindex="-1"></a>  metafor<span class="sc">::</span><span class="fu">rma.mv</span>(<span class="at">yi =</span> SMDH_sign, <span class="co"># specify lnRR as the effect size measure;</span></span>
<span id="cb152-240"><a href="#cb152-240" aria-hidden="true" tabindex="-1"></a>                    <span class="at">V =</span> VCV_SMDH,<span class="co"># specify lnRR's sampling variance;</span></span>
<span id="cb152-241"><a href="#cb152-241" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mods =</span> <span class="sc">~</span> trait_type,</span>
<span id="cb152-242"><a href="#cb152-242" aria-hidden="true" tabindex="-1"></a>                    <span class="at">random =</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> paper_ID,</span>
<span id="cb152-243"><a href="#cb152-243" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Observation_ID,</span>
<span id="cb152-244"><a href="#cb152-244" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group_ID_coded,</span>
<span id="cb152-245"><a href="#cb152-245" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> population_ID,</span>
<span id="cb152-246"><a href="#cb152-246" aria-hidden="true" tabindex="-1"></a>                                  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> bird_species),</span>
<span id="cb152-247"><a href="#cb152-247" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"REML"</span>,</span>
<span id="cb152-248"><a href="#cb152-248" aria-hidden="true" tabindex="-1"></a>                  <span class="at">test =</span> <span class="st">"t"</span>,</span>
<span id="cb152-249"><a href="#cb152-249" aria-hidden="true" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">optimizer=</span><span class="st">"optim"</span>),</span>
<span id="cb152-250"><a href="#cb152-250" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> dataset_SMDH)</span>
<span id="cb152-251"><a href="#cb152-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-252"><a href="#cb152-252" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving the model</span></span>
<span id="cb152-253"><a href="#cb152-253" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(SMDH_trait_pc, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/SMDH_trait_pc.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<p><br>
</p>
</section>
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>  </div> <!-- /content -->  <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script> 
  
</body></html>