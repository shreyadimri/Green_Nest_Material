{
  "hash": "eb4aa0904b685a4d4094f110585a67f2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Data Analysis\"\nauthor: \"Shreya D.\"\ndate: \"2025-07-11\"\noutput: html_document\n---\n\n# Loading Data for analysis\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Setting up workspace\n\n# For plotting trees, and although not strictly necessary, we may need the `ggtree` R package, which you should be able to install by running:\n if (!require(\"BiocManager\", quietly = TRUE))\n install.packages(\"BiocManager\")\n BiocManager::install(\"ggtree\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nBioconductor version 3.21 (BiocManager 1.30.26), R 4.5.1 (2025-06-13)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package(s) not installed when version(s) same as or greater than current; use\n  `force = TRUE` to re-install: 'ggtree'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nOld packages: 'purrr'\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nif (!require(\"orchaRd\", quietly = TRUE))\ndevtools::install_github(\"daniel1noble/orchaRd\", ref = \"main\", force = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nLoading the 'orchaRd' package (version 2.0). For an\nintroduction and vignette to the package please see: https://daniel1noble.github.io/orchaRd/\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npacman::p_load(here,tidyverse,metafor,ggpubr,orchaRd,ggpubfigs)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'ggpubfigs' is not available for this version of R\n\nA version of this package for your version of R might be available elsewhere,\nsee the ideas at\nhttps://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Installing-packages\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in p_install(package, character.only = TRUE, ...):\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in library(package, lib.loc = lib.loc, character.only = TRUE,\nlogical.return = TRUE, : there is no package called 'ggpubfigs'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in pacman::p_load(here, tidyverse, metafor, ggpubr, orchaRd, ggpubfigs): Failed to install/load:\nggpubfigs\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#Packages needed\n\nrm(list=ls()) ## cleaning up\n\nset.seed(430) #set seed for reproducibility (for random number generation)\n\n# Functions needed\n\n# function to estimate typical sampling error variance obtained from \n# https://github.com/Yefeng0920/heterogeneity_ecoevo/tree/main/function\nsigma2_v <- function(mod){\n  sigma2_v <- sum(1 / mod$vi) * (mod$k - 1) /\n    (sum(1 / mod$vi)^2 - sum((1 / mod$vi)^2))\n  return(sigma2_v)\n}\n\n# ------------------------------------------------------------\n# Loading cleaned dataset\n# ------------------------------------------------------------\n\ndataset_analysis<-read_csv(here::here(\"data/04_data_analysis/dataset_analysis.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRows: 274 Columns: 71\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (35): paper_ID, fulltext_screening, variable_note, authors, population_l...\ndbl (35): year_publication, Observation_ID, experiment_ID, group_ID, repeate...\nlgl  (1): fulltext_notes\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ndataset_lnRR<-read_csv(here::here(\"data/04_data_analysis/dataset_lnRR.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRows: 259 Columns: 71\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (34): paper_ID, fulltext_screening, variable_note, authors, population_l...\ndbl (32): year_publication, Observation_ID, experiment_ID, group_ID, repeate...\nlgl  (5): fulltext_notes, test_statistics_type, sign_relationship, total_sam...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ndataset_SMDH<-read_csv(here::here(\"data/04_data_analysis/dataset_SMDH.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRows: 274 Columns: 71\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (35): paper_ID, fulltext_screening, variable_note, authors, population_l...\ndbl (35): year_publication, Observation_ID, experiment_ID, group_ID, repeate...\nlgl  (1): fulltext_notes\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n### Creating Phylogeny for the plot\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# # install.packages(\"pacman\")\n# # load packages\n# \n# pacman::p_load(rotl,\n#                ape,\n#                ggtree)\n# \n# \n# # We have 7 bird species in the dataset\n# bird_species <- unique(dataset_analysis$bird_species)\n# \n# # extracting taxonomic information\n# taxa <- rotl::tnrs_match_names(names = bird_species)\n# taxa\n# \n# # check approximate matches\n# taxa[taxa$approximate_match==TRUE & !(is.na(taxa$approximate_match)),]\n# \n# # phylogenetic information for our species from the Open Tree of Life\n# \n# tree <- rotl::tol_induced_subtree(ott_ids = taxa[[\"ott_id\"]], label_format = \"name\")\n# ape::is.binary(tree)\n# \n# # here are the species included in the tree\n# sort(tree$tip.label)\n# \n# # removing the underscore \"_\" from the tree tip.label\n# tree$tip.label <- gsub(\"_\",\" \", tree$tip.label)\n# sort(tree$tip.label)\n# \n# # compute branch lengths of tree\n# phylo_branch <- compute.brlen(tree, method = \"Grafen\", power = 1)\n# \n# # check tree is ultrametric\n# is.ultrametric(phylo_branch) # TRUE\n# \n# # matrix to be included in the models\n# bird_phylo <- vcv(phylo_branch, cor = T)\n# bird_phylo\n# \n# plot(tree) #check: https://www.rdocumentation.org/packages/ape/versions/5.3/topics/plot.phylo\n```\n:::\n\n\n### Visualizing random effects structure\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# install.packages(\"devtools\")\ndevtools::install_github(\"davidsjoberg/ggsankey\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nUsing GitHub PAT from the git credential store.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSkipping install of 'ggsankey' from a github remote, the SHA1 (b675d0d5) has not changed since last install.\n  Use `force = TRUE` to force installation\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(ggsankey)\n\nsankey_data <- dataset_analysis %>%\n  select(Observation_ID, repeated_trait_ID_coded, paper_ID, experiment_ID_coded, group_ID_coded)%>%\n  mutate(across(c(Observation_ID, repeated_trait_ID_coded, paper_ID, experiment_ID_coded, group_ID_coded), as.factor)) %>%\n  make_long(Observation_ID, repeated_trait_ID_coded, paper_ID, experiment_ID_coded, group_ID_coded)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: attributes are not identical across measure variables; they will be\ndropped\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nsankey_data <- dataset_analysis %>%\n  select(paper_ID, bird_species, population_ID)%>%\n  mutate(across(c(paper_ID, bird_species, population_ID), as.factor)) %>%\n  make_long(paper_ID, bird_species, population_ID)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: attributes are not identical across measure variables; they will be\ndropped\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nggplot(sankey_data, aes(x = x, \n               next_x = next_x, \n               node = node, \n               next_node = next_node,\n               fill = factor(node))) +\n  geom_sankey() +\n  scale_fill_discrete(drop=FALSE) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](07_data_analysis_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code .hidden}\nggplot(sankey_data, aes(x = x, next_x = next_x, node = node, next_node = next_node, fill = factor(node))) +\n  geom_alluvial(flow.alpha = .6) +\n  scale_fill_viridis_d(drop = FALSE) +\n  theme_alluvial(base_size = 18) +\n  labs(x = NULL) +\n  theme(legend.position = \"none\",\n        plot.title = element_text(hjust = .5))\n```\n\n::: {.cell-output-display}\n![](07_data_analysis_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n:::\n\n\n# Preparing datasets\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Let's just quickly ensure all the important variables are \n# in the correct data type\n\ndataset_analysis<- dataset_analysis%>%mutate(across(c(paper_ID, Observation_ID, repeated_trait_ID_coded, paper_ID, experiment_ID_coded, group_ID_coded, comparision_type,Hypothesis,trait_type,parasite_type,time_of_gnm_addition, blinding, random_assignment, missing_data, population_ID,bird_species), as.factor))\n\n\ndataset_lnRR<- dataset_lnRR%>%mutate(across(c(paper_ID, Observation_ID, repeated_trait_ID_coded, paper_ID, experiment_ID_coded, group_ID_coded, comparision_type,Hypothesis,trait_type,parasite_type,time_of_gnm_addition, blinding, random_assignment, missing_data, population_ID, bird_species), as.factor))\n\ndataset_SMDH<- dataset_SMDH%>%mutate(across(c(paper_ID, Observation_ID, repeated_trait_ID_coded, paper_ID, experiment_ID_coded, group_ID_coded, comparision_type,Hypothesis,trait_type,parasite_type,time_of_gnm_addition, blinding, random_assignment, missing_data, population_ID,bird_species), as.factor))\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n## For lnRR (or simply load dataset as provided)\ndataset_lnRR<-dataset_analysis%>%\nfilter(lnRR_sign != \"NA\" | lnRR_variance != \"NA\")\n\n# selecting dataset which are not flagged\ndataset_lnRR<-dataset_lnRR%>%\n  filter(proxy_decision == \"include\")\n\n# selecting only published dataset\ndataset_lnRR_published<-dataset_lnRR%>%\n  filter(!is.na(year_publication))\n\n# selecting dataset which are flagged\nlnRR_con_flagged<-dataset_analysis%>%\n   filter(lnRR_sign != \"NA\" | lnRR_variance != \"NA\")%>%\n  filter(proxy_decision != \"SMDH only\" | proxy_decision != \"contingency table\" )\n\n# selecting dataset without those using 0 as ES because authors reported no effect\nlnRR_sin_missingES <- dataset_lnRR %>% \n   filter(!proxy_comment %in% c(\"use 0 as ES\"))\n\nlnRR_flagged_no_missingES<- lnRR_con_flagged %>% \n   filter(!proxy_comment %in% c(\"use 0 as ES\"))\n\n# selecting only dataset that passes geary's test\nlnRR_geary_passed<-dataset_lnRR%>%filter(geary_test==\"pass\")\n\n## For SMDH\n# selecting dataset which are not flagged\ndataset_SMDH<-dataset_analysis%>%\n   filter(proxy_decision != \"sensitivity-analysis\" | is.na(proxy_decision))\n\n# selecting only published dataset\ndataset_SMDH_published<-dataset_SMDH%>%\n  filter(!is.na(year_publication))\n\n# selecting dataset which are flagged\nSMDH_con_flagged<-dataset_analysis%>%\n   filter(SMDH_sign != \"NA\")\n\n# selecting dataset without those using 0 as ES because authors reported no effect\n\nSMDH_sin_missingES <- dataset_SMDH %>% \n   filter(!proxy_comment %in% c(\"use 0 as ES\"))\n\nSMDH_flagged_no_missingES<- SMDH_con_flagged %>% \n   filter(!proxy_comment %in% c(\"use 0 as ES\"))\n\n# selecting dataset which are not flagged but without the SMDH calculated from inferential statistics \n\nSMDH_no_inferential<-dataset_analysis%>%\n  filter(proxy_decision == \"include\")%>% filter(SMDH_sign != \"NA\")\n```\n:::\n\n\n# Overall effect : Intercept-only meta-analytic model\n\n*\"Does adding green material to the nest have an adaptive function across the bird species that perform this behaviour?\"*\n\n## using lnRR\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nVCV_lnRR<- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_lnRR,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\nintercept_lnRR<- rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = dataset_lnRR)\n# saving the model\n saveRDS(intercept_lnRR, file = here::here(\"model/intercept_lnRR.rds\"))\n\n# saving the dataset for this model\n write.csv(dataset_lnRR,here::here(\"data/04_data_analysis/intercept_lnRR.csv\"))\n```\n:::\n\n\n#### Exploring heterogeneity in intercept only model\n\nThis is the function from Yefeng's Github for interpreting heterogeneity. I have to download the data used for this function to be able to use it.\n\nI am using the values from the table directly..\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# ## Function is from the Pluralistic approach to heterogeneity from Yefeng's Pre-print repository from GitHub\n# \n# #-----------------------heterogeneity interpretation-----------------------#\n# het_interpret <- function(observed_value, het_type, es_type, data) {\n#   \n#   if (!het_type %in% c(\"I2\", \"CVH\", \"M\", \"sigma2\", \"V_bar\")) {\n#     stop(\"Invalid heterogeneity type. Choose from 'I2', 'CVH', 'M', 'sigma2', or 'V_bar'.\")\n#   }\n#   \n#   if (!es_type %in% unique(data$es.type)) {\n#     stop(\"Invalid effect size type. Check the levels of 'es.type'.\")\n#   }\n#   \n#   filtered_data <- data %>% filter(es.type == es_type)\n#   \n#   if (nrow(filtered_data) == 0) {\n#     stop(\"No data available for the selected effect size type.\")\n#   }\n#   \n#   het_values <- filtered_data[[het_type]]\n#   \n#   percentiles <- quantile(het_values, probs = seq(0, 1, by = 0.05), na.rm = TRUE)\n#   \n#   lower_bound <- max(percentiles[percentiles <= observed_value], na.rm = TRUE)\n#   upper_bound <- min(percentiles[percentiles >= observed_value], na.rm = TRUE)\n#   lower_percentile <- names(percentiles)[percentiles == lower_bound]\n#   upper_percentile <- names(percentiles)[percentiles == upper_bound]\n#   \n#   percentile_range <- paste0(lower_percentile, \"-\", upper_percentile, \"th percentile\")\n#   \n#   # return the results\n#   return(tibble::tibble(\n#     observed_value = observed_value,\n#     het_type = het_type,\n#     es_type = es_type,\n#     percentile_range = percentile_range\n#   ))\n# }\n# x<-het_interpret(observed_value= I2_main_model_vector[1], \n#                  het_type = \"I2\", \n#                  es_type = \"lnRR_sign\", \n#                  data= intercept_lnRR)\n```\n:::\n\n\nLet us look at the heterogeneity in lnRR intercept-only model\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Then also:\n# # Typical sampling variance (which captures the statistical noise of the data, \n# # but is rarely reported in the current meta-analytic practice):\nsigma2_v(intercept_lnRR)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.0003277551\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# To calculate heterogeneity, these are the functions from orchaRd:\n# # I2, CV and M\nsigma2_main_model_vector <- sum(intercept_lnRR$sigma2)\n\n# 0.11, 0.27, and 0.57 for lnRR\n\nI2_main_model_vector <- orchaRd::i2_ml(intercept_lnRR)\n\n# 0.88, 0.95, and 0.99 for lnRR\n\nCV2_main_model_vector <- orchaRd::cvh2_ml(intercept_lnRR)\nCV1_main_model_vector <- orchaRd::cvh1_ml(intercept_lnRR)\n\n# CVH2 (CVH1) - 1.36 (1.16), 3.76 (1.94), and 12.1 (3.48) for lnRR\n\nM2_main_model_vector <- orchaRd::m2_ml(intercept_lnRR)\nM1_main_model_vector <- orchaRd::m1_ml(intercept_lnRR)\n\n# M2(M1) - 0.58 (0.54), 0.79 (0.66), and 0.78 for lnRR;\n\n# # # Total unstandardized raw variance (i.e. total heterogeneity)\nround(sum(intercept_lnRR$sigma2), 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.023\n```\n\n\n:::\n:::\n\n\n## using SMDH\n\nWe are only running these analysis for the fitness proxy labelled \"included\". Some proxies have been flagged and we will run them in a sensitivity analysis only\n\nThe sampling variances will be fitted as variance--covariance matrices assuming a 0.5 correlation (ρs) between sampling variances from the same paper_ID (Noble et al. 2017).\n\nThe MLMA using SMDH as the effect size measure incorporate the imputed sampling variance\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nVCV_SMDH <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_SMDH,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\nintercept_SMDH<- rma.mv(yi = SMDH_sign, # specify SMDH as the effect size measure;\n                    V = VCV_SMDH, # specify SMDH's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = dataset_SMDH)\n\n# saving the model\n saveRDS(intercept_SMDH, file = here::here(\"model/intercept_SMDH.rds\"))\n\n# saving the dataset for this model\n write.csv(dataset_SMDH,here::here(\"data/04_data_analysis/intercept_SMDH.csv\"))\n```\n:::\n\n\n## SMDH-heterogeneity\n\nNow looking at the intercept only model\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nsummary(intercept_SMDH)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 253; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-324.4948   648.9896   660.9896   682.1662   661.3325   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0008     26     no        paper_ID \nsigma^2.2  0.2578  0.5077    253     no  Observation_ID \nsigma^2.3  0.0000  0.0013     47     no  group_ID_coded \nsigma^2.4  0.0000  0.0002     17     no   population_ID \nsigma^2.5  0.0000  0.0001      7     no    bird_species \n\nTest for Heterogeneity:\nQ(df = 252) = 1114.7203, p-val < .0001\n\nModel Results:\n\nestimate      se    tval   df    pval   ci.lb   ci.ub     \n  0.1793  0.0665  2.6948  252  0.0075  0.0483  0.3104  ** \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npredict(intercept_SMDH)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   pred     se  ci.lb  ci.ub   pi.lb  pi.ub \n 0.1793 0.0665 0.0483 0.3104 -0.8292 1.1879 \n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# Then also:\n# # Typical sampling variance (which captures the statistical noise of the data, \n# # but is rarely reported in the current meta-analytic practice):\nsigma2_v(intercept_SMDH)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1319841\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# To calculate heterogeneity, these are the functions from orchaRd:\n# # I2, CV and M\nsigma2_main_model_vector <- sum(intercept_SMDH$sigma2)\n# 0.54, 1.25, and 3.03 for SMD;\nI2_main_model_vector <- orchaRd::i2_ml(intercept_SMDH)\n# 0.78, 0.89, and 0.96 for SMD\n# 0.88, 0.95, and 0.99 for lnRR\nCV2_main_model_vector <- orchaRd::cvh2_ml(intercept_SMDH)\nCV1_main_model_vector <- orchaRd::cvh1_ml(intercept_SMDH)\n# CVH2 (CVH1) - 1.36 (1.16), 3.76 (1.94), and 12.1 (3.48) for lnRR\nM2_main_model_vector <- orchaRd::m2_ml(intercept_SMDH)\nM1_main_model_vector <- orchaRd::m1_ml(intercept_SMDH)\n# M2 (M1) - 0.58 (0.54), 0.79 (0.66), and 0.78 for lnRR\n\n# # # Total unstandardized raw variance (i.e. total heterogeneity)\nround(sum(intercept_SMDH$sigma2), 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.258\n```\n\n\n:::\n:::\n\n\n## Bivariate Meta-analytical model\n\nFor the overall effect size (i.e., the meta-analytical mean), we will run the bivariate multilevel meta-analytic model suggested by Yang et al. (2024), which models both lnRR and SMD(H) simultaneously (i.e., including them both as response variables and estimating their correlation; random).\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndataset_bivariate <- data.frame(paper_ID = c(dataset_lnRR$paper_ID, dataset_SMDH$paper_ID),\n                      Observation_ID = c(dataset_lnRR$Observation_ID, dataset_SMDH$Observation_ID),\n                      group_ID_coded = c(dataset_lnRR$group_ID_coded, dataset_SMDH$group_ID_coded),\n                      population_ID = c(dataset_lnRR$population_ID, dataset_SMDH$population_ID),\n                      bird_species = c(dataset_lnRR$bird_species, dataset_SMDH$bird_species),\n                      ES = c(dataset_lnRR$lnRR_sign, dataset_SMDH$SMDH_sign),\n                      V_ES = c(dataset_lnRR$lnRR_variance, dataset_SMDH$SMDH_variance),\n                      ES_measure = c(rep(\"lnRR\", nrow(dataset_lnRR)), rep(\"SMDH\", nrow(dataset_SMDH)))\n                      )\n\nVCV_bivariate <- vcalc(vi = V_ES, # sampling variances of lnRR and SMD that are correlated within the same study;\n             cluster = paper_ID, # study identity;\n             type = ES_measure, # different types of effect size measures underlying the observed effect sizes;\n             data = dataset_bivariate, # the long format data frame;\n             rho = 0.2, # assuming that the effect sizes within the same study are correlated with rho = 0.5.\n             nearpd = TRUE # specify whether impose the non positive definite VCV matrix (not invertible) to the nearest positive semi-definite matrix \n             )\n\nBivariate_model <- rma.mv(yi = ES, # specify the effect size estimate (the variable ES in our case);\n                V = VCV_bivariate, # specify the imputed variance-covariance matrix;\n                mods = ~ ES_measure - 1, # specify the variable \"ES_measure\" indicating the types of effect size measures;\n                random = list(~ ES_measure | paper_ID, \n                              ~ ES_measure | Observation_ID,\n                              ~ 1 | group_ID_coded,\n                              ~ 1 | population_ID,\n                              ~ 1 | bird_species\n                              ), # add correlated random effects corresponding to the lnRR and SMD parameters in the same study;\n                struct = \"UN\", # impose an unstructured variance-covariance of the study-specific random effects;\n                test = \"t\", # t distribution is specified to test the overall effect against the null hypothesis and construct confidence intervals;\n                method = \"REML\", # restricted likelihood maximum is assigned as the estimator for variance components as suggested;\n                data = dataset_bivariate, # the long format dataset\n                sparse = T\n               )\n\n# Saving the model\nsaveRDS(Bivariate_model, file = here::here(\"model/sensitivity_analysis/bivariate_model.rds\"))\n# saving the dataset for this model\nwrite.csv(dataset_bivariate,here::here(\"data/05_data_sensitivity_analysis/dataset_bivariate.csv\"))\n\nsummary(Bivariate_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 491; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-480.9777   961.9555   983.9555  1030.0715   984.5089   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0000     47     no  group_ID_coded \nsigma^2.2  0.0000  0.0000     17     no   population_ID \nsigma^2.3  0.0000  0.0000      7     no    bird_species \n\nouter factor: paper_ID   (nlvls = 26)\ninner factor: ES_measure (nlvls = 2)\n\n            estim    sqrt  k.lvl  fixed  level \ntau^2.1    0.0013  0.0360     26     no   lnRR \ntau^2.2    0.1525  0.3906     26     no   SMDH \n\n      rho.lnRR  rho.SMDH    lnRR  SMDH \nlnRR         1                 -    26 \nSMDH   -1.0000         1      no     - \n\nouter factor: Observation_ID (nlvls = 253)\ninner factor: ES_measure     (nlvls = 2)\n\n              estim    sqrt  k.lvl  fixed  level \ngamma^2.1    0.1291  0.3593    238     no   lnRR \ngamma^2.2    1.2735  1.1285    253     no   SMDH \n\n      phi.lnRR  phi.SMDH    lnRR  SMDH \nlnRR         1    0.5218       -   238 \nSMDH    0.5218         1      no     - \n\nTest for Residual Heterogeneity:\nQE(df = 489) = 16178103540.3074, p-val < .0001\n\nTest of Moderators (coefficients 1:2):\nF(df1 = 2, df2 = 489) = 1.8862, p-val = 0.1527\n\nModel Results:\n\n                estimate      se     tval   df    pval    ci.lb   ci.ub    \nES_measurelnRR   -0.0152  0.0309  -0.4898  489  0.6245  -0.0760  0.0456    \nES_measureSMDH    0.2496  0.1367   1.8257  489  0.0685  -0.0190  0.5182  . \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n::: {.cell WARNING='false'}\n\n```{.r .cell-code .hidden}\npacman::p_load(ellipse)\nab.l <- matreg(y=2, x=1, R=Bivariate_model$G, cov=TRUE, means=coef(Bivariate_model), n=Bivariate_model$g.levels.comb.k) # fit regression model\n\nxy <- ellipse(Bivariate_model$G, centre=coef(Bivariate_model), level=0.95) # get 95% coverage region\nellipse_df <- data.frame(x = xy[, 1], y = xy[, 2]) # convert it int dataframe so that we can use ggplot to make a figure\n\npivot_wider(dataset_bivariate, names_from = ES_measure, values_from = c(ES, V_ES)) %>%\n  ggplot() + \n  geom_point(aes(x = ES_lnRR, y = ES_SMDH, size = 1/sqrt(V_ES_lnRR)), color = \"#1B9E77\", alpha = 0.5) + \n  geom_point(aes(x = coef(Bivariate_model)[1], y = coef(Bivariate_model)[2]), color = \"red\", size = 2) + \n  geom_abline(intercept = ab.l$tab$beta[1], slope = ab.l$tab$beta[2]) +\n  geom_path(data = ellipse_df, aes(x = x, y = y), color = \"gray50\") +\n  #scale_x_continuous(limits = c(-2.5, 2.5)) + \n  #scale_y_continuous(limits = c(-2.5, 2.5)) + \n  guides(size = \"none\") + \n  labs(x = \"lnRR\", y = \"SMD\") + \n  theme_bw()\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in geom_point(aes(x = coef(Bivariate_model)[1], y = coef(Bivariate_model)[2]), : All aesthetics have length 1, but the data has 253 rows.\nℹ Please consider using `annotate()` or provide this layer with data containing\n  a single row.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 15 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](07_data_analysis_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nThere is a very high negative correlation between the two effect sizes. This probably is an artifact of the data and not a true correlation. If you look at the model summary, the $tau^2$ for lnRR, it is extremely small 0.0008, i.e., there is very little variance. This could also be stemming from the fact that the log values in the dataset could be causing this. For SMDH on the other hand, the $tau^2$ is 0.1681 that is much larger. This difference in the variance estimate itself could be causing this artifact of the model. I will only go ahead to present this model as a senstivity analysis because I am not completely convinced by it's robustness.\n\n# Sensitivity Analysis\n\n### With published data only\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#----------------------------------------------------------------------------\n# for lnRR as Effect Size\n#----------------------------------------------------------------------------\n\n# Preparing new variance-covariance matrix\n\nVCV_lnRR_published <- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_lnRR_published,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\n\n## Running intercept only model\n\nSA_lnRR_published<- rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_published, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = dataset_lnRR_published)\n\n\n# Saving the model\nsaveRDS(SA_lnRR_published, file = here::here(\"model/sensitivity_analysis/SA_lnRR_published.rds\"))\n# saving the dataset for this model\nwrite.csv(dataset_lnRR_published,here::here(\"data/05_data_sensitivity_analysis/dataset_lnRR_published.csv\"))\n\n\n# What is the effect now?\n\nsummary(SA_lnRR_published)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 221; method: REML)\n\n  logLik  Deviance       AIC       BIC      AICc   \n-22.5653   45.1306   57.1306   77.4923   57.5249   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0003     24     no        paper_ID \nsigma^2.2  0.0244  0.1563    221     no  Observation_ID \nsigma^2.3  0.0000  0.0001     44     no  group_ID_coded \nsigma^2.4  0.0000  0.0000     15     no   population_ID \nsigma^2.5  0.0000  0.0000      6     no    bird_species \n\nTest for Heterogeneity:\nQ(df = 220) = 2253.0536, p-val < .0001\n\nModel Results:\n\nestimate      se    tval   df    pval    ci.lb   ci.ub    \n  0.0197  0.0164  1.2034  220  0.2301  -0.0126  0.0519    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npredict(SA_lnRR_published)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   pred     se   ci.lb  ci.ub   pi.lb  pi.ub \n 0.0197 0.0164 -0.0126 0.0519 -0.2900 0.3293 \n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#----------------------------------------------------------------------------\n# for SMDH as Effect Size\n#----------------------------------------------------------------------------\n\n# Preparing new variance-covariance matrix\n\nVCV_SMDH_published <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_SMDH_published,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\n\n## Running intercept only model\n\nSA_SMDH_published<- rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_published, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = dataset_SMDH_published)\n\n\n# Saving the model\nsaveRDS(SA_SMDH_published, file = here::here(\"model/sensitivity_analysis/SA_SMDH_published.rds\"))\n# saving the dataset for this model\nwrite.csv(dataset_SMDH_published,here::here(\"data/05_data_sensitivity_analysis/dataset_SMDH_published.csv\"))\n\n# What is the effect now?\n\nsummary(SA_SMDH_published)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 235; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-308.4661   616.9322   628.9322   649.6641   629.3022   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0010     24     no        paper_ID \nsigma^2.2  0.2740  0.5235    235     no  Observation_ID \nsigma^2.3  0.0000  0.0015     45     no  group_ID_coded \nsigma^2.4  0.0000  0.0002     15     no   population_ID \nsigma^2.5  0.0000  0.0001      6     no    bird_species \n\nTest for Heterogeneity:\nQ(df = 234) = 1092.0602, p-val < .0001\n\nModel Results:\n\nestimate      se    tval   df    pval   ci.lb   ci.ub     \n  0.1916  0.0688  2.7849  234  0.0058  0.0561  0.3271  ** \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npredict(SA_SMDH_published)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   pred     se  ci.lb  ci.ub   pi.lb  pi.ub \n 0.1916 0.0688 0.0561 0.3271 -0.8486 1.2318 \n```\n\n\n:::\n:::\n\n\n### With flagged proxies\n\nSome traits for which the relationship with fitness is unclear or highly debated in the literature\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#----------------------------------------------------------------------------\n# for lnRR as Effect Size\n#----------------------------------------------------------------------------\n\n# Preparing new variance-covariance matrix\n\nVCV_lnRR_flagged <- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = lnRR_con_flagged,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\n\n## Running intercept only model\n\nSA_lnRR_flagged<- rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_flagged, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = lnRR_con_flagged)\n\n\n\n# Saving the model\nsaveRDS(SA_lnRR_flagged, file = here::here(\"model/sensitivity_analysis/SA_lnRR_flagged.rds\"))\n# saving the dataset for this model\nwrite.csv(lnRR_con_flagged,here::here(\"data/05_data_sensitivity_analysis/dataset_lnRR_con_flagged.csv\"))\n\n# What is the effect now?\n\nsummary(SA_lnRR_flagged)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 259; method: REML)\n\n  logLik  Deviance       AIC       BIC      AICc   \n-25.1782   50.3564   62.3564   83.6742   62.6911   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0001     28     no        paper_ID \nsigma^2.2  0.0223  0.1494    259     no  Observation_ID \nsigma^2.3  0.0000  0.0004     52     no  group_ID_coded \nsigma^2.4  0.0000  0.0000     17     no   population_ID \nsigma^2.5  0.0000  0.0000      7     no    bird_species \n\nTest for Heterogeneity:\nQ(df = 258) = 2395.1696, p-val < .0001\n\nModel Results:\n\nestimate      se    tval   df    pval    ci.lb   ci.ub    \n  0.0237  0.0149  1.5886  258  0.1134  -0.0057  0.0531    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npredict(SA_lnRR_flagged)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   pred     se   ci.lb  ci.ub   pi.lb  pi.ub \n 0.0237 0.0149 -0.0057 0.0531 -0.2720 0.3194 \n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#----------------------------------------------------------------------------\n# for SMDH as Effect Size\n#----------------------------------------------------------------------------\n\n# Preparing new variance-covariance matrix\n\nVCV_SMDH_flagged <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = SMDH_con_flagged,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\n\n## Running intercept only model\n\nSA_SMDH_flagged<- rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_flagged, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = SMDH_con_flagged)\n\n\n# Saving the model\nsaveRDS(SA_SMDH_flagged, file = here::here(\"model/sensitivity_analysis/SA_SMDH_flagged.rds\"))\n# saving the dataset for this model\nwrite.csv(SMDH_con_flagged,here::here(\"data/05_data_sensitivity_analysis/dataset_SMDH_con_flagged.csv\"))\n\n# What is the effect now?\n\nsummary(SA_SMDH_flagged)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 274; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-344.0150   688.0299   700.0299   721.6868   700.3457   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0014     28     no        paper_ID \nsigma^2.2  0.2487  0.4987    274     no  Observation_ID \nsigma^2.3  0.0000  0.0022     53     no  group_ID_coded \nsigma^2.4  0.0000  0.0001     17     no   population_ID \nsigma^2.5  0.0000  0.0000      7     no    bird_species \n\nTest for Heterogeneity:\nQ(df = 273) = 1184.8136, p-val < .0001\n\nModel Results:\n\nestimate      se    tval   df    pval   ci.lb   ci.ub     \n  0.1911  0.0631  3.0269  273  0.0027  0.0668  0.3154  ** \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npredict(SA_SMDH_flagged)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   pred     se  ci.lb  ci.ub   pi.lb  pi.ub \n 0.1911 0.0631 0.0668 0.3154 -0.7985 1.1807 \n```\n\n\n:::\n:::\n\n\n### Without 0 ES\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#----------------------------------------------------------------------------\n# for lnRR as Effect Size\n#----------------------------------------------------------------------------\n\n# Preparing new variance-covariance matrix\n\nVCV_lnRR_no_missingES <- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = lnRR_sin_missingES,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\n\n## Running intercept only model\n\nSA_lnRR_no_missingES<- rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_no_missingES, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = lnRR_sin_missingES)\n\n\n\n# Saving the model\nsaveRDS(SA_lnRR_no_missingES, file = here::here(\"model/sensitivity_analysis/SA_lnRR_no_missingES.rds\"))\n# saving the dataset for this model\nwrite.csv(lnRR_sin_missingES,here::here(\"data/05_data_sensitivity_analysis/dataset_lnRR_sin_missingES.csv\"))\n\n\n# What is the effect now?\n\nsummary(SA_lnRR_no_missingES)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 222; method: REML)\n\n  logLik  Deviance       AIC       BIC      AICc   \n-29.9487   59.8973   71.8973   92.2863   72.2899   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0002     26     no        paper_ID \nsigma^2.2  0.0244  0.1563    222     no  Observation_ID \nsigma^2.3  0.0000  0.0002     46     no  group_ID_coded \nsigma^2.4  0.0000  0.0001     17     no   population_ID \nsigma^2.5  0.0000  0.0000      7     no    bird_species \n\nTest for Heterogeneity:\nQ(df = 221) = 2275.2780, p-val < .0001\n\nModel Results:\n\nestimate      se    tval   df    pval    ci.lb   ci.ub    \n  0.0189  0.0160  1.1828  221  0.2381  -0.0126  0.0505    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npredict(SA_lnRR_no_missingES)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   pred     se   ci.lb  ci.ub   pi.lb  pi.ub \n 0.0189 0.0160 -0.0126 0.0505 -0.2906 0.3285 \n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#----------------------------------------------------------------------------\n# for SMDH as Effect Size\n#----------------------------------------------------------------------------\n\n# Preparing new variance-covariance matrix\n\nVCV_SMDH_no_missingES <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = SMDH_sin_missingES,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\n\n## Running intercept only model\n\nSA_SMDH_no_missingES<- rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_no_missingES, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = SMDH_sin_missingES)\n\n\n# Saving the model\nsaveRDS(SA_SMDH_no_missingES, file = here::here(\"model/sensitivity_analysis/SA_SMDH_no_missingES.rds\"))\n# saving the dataset for this model\nwrite.csv(SMDH_sin_missingES,here::here(\"data/05_data_sensitivity_analysis/dataset_SMDH_sin_missingES.csv\"))\n\n# What is the effect now?\n\nsummary(SA_SMDH_no_missingES)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 237; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-315.4239   630.8479   642.8479   663.6309   643.2147   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0008     26     no        paper_ID \nsigma^2.2  0.2967  0.5447    237     no  Observation_ID \nsigma^2.3  0.0000  0.0013     47     no  group_ID_coded \nsigma^2.4  0.0000  0.0002     17     no   population_ID \nsigma^2.5  0.0000  0.0001      7     no    bird_species \n\nTest for Heterogeneity:\nQ(df = 236) = 1113.5021, p-val < .0001\n\nModel Results:\n\nestimate      se    tval   df    pval   ci.lb   ci.ub     \n  0.1860  0.0701  2.6545  236  0.0085  0.0480  0.3240  ** \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npredict(SA_SMDH_no_missingES)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   pred     se  ci.lb  ci.ub   pi.lb  pi.ub \n 0.1860 0.0701 0.0480 0.3240 -0.8960 1.2680 \n```\n\n\n:::\n:::\n\n\n### With flagged proxies and no missing ES\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#----------------------------------------------------------------------------\n# for lnRR as Effect Size\n#----------------------------------------------------------------------------\n\n# Preparing new variance-covariance matrix\n\nVCV_flagged_no_missingES <- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = lnRR_flagged_no_missingES,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\n\n## Running intercept only model\n\nSA_lnRR_flagged_no_missingES<- rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_flagged_no_missingES, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = lnRR_flagged_no_missingES)\n\n\n\n# Saving the model\nsaveRDS(SA_lnRR_flagged_no_missingES, file = here::here(\"model/sensitivity_analysis/SA_lnRR_flagged_no_missingES.rds\"))\n\n# saving the dataset for this model\nwrite.csv(lnRR_flagged_no_missingES,here::here(\"data/05_data_sensitivity_analysis/dataset_lnRR_flagged_no_missingES.csv\"))\n\n# What is the effect now?\n\nsummary(SA_lnRR_flagged_no_missingES)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 243; method: REML)\n\n  logLik  Deviance       AIC       BIC      AICc   \n-29.1661   58.3322   70.3322   91.2658   70.6897   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0001     28     no        paper_ID \nsigma^2.2  0.0236  0.1537    243     no  Observation_ID \nsigma^2.3  0.0000  0.0003     52     no  group_ID_coded \nsigma^2.4  0.0000  0.0000     17     no   population_ID \nsigma^2.5  0.0000  0.0000      7     no    bird_species \n\nTest for Heterogeneity:\nQ(df = 242) = 2392.7303, p-val < .0001\n\nModel Results:\n\nestimate      se    tval   df    pval    ci.lb   ci.ub    \n  0.0238  0.0153  1.5581  242  0.1205  -0.0063  0.0540    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npredict(SA_lnRR_flagged_no_missingES)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   pred     se   ci.lb  ci.ub   pi.lb  pi.ub \n 0.0238 0.0153 -0.0063 0.0540 -0.2804 0.3281 \n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#----------------------------------------------------------------------------\n# for SMDH as Effect Size\n#----------------------------------------------------------------------------\n\n# Preparing new variance-covariance matrix\n\nVCV_SMDH_flagged_no_missingES <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = SMDH_flagged_no_missingES,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\n\n## Running intercept only model\n\nSA_SMDH_flagged_no_missingES<- rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_flagged_no_missingES, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = SMDH_flagged_no_missingES)\n\n\n# Saving the model\nsaveRDS(SA_SMDH_flagged_no_missingES, file = here::here(\"model/sensitivity_analysis/SA_SMDH_flagged_no_missingES.rds\"))\n\n# saving the dataset for this model\nwrite.csv(SMDH_flagged_no_missingES,here::here(\"data/05_data_sensitivity_analysis/dataset_SMDH_flagged_no_missingES.csv\"))\n\n\n# What is the effect now?\n\nsummary(SA_SMDH_flagged_no_missingES)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 258; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-335.1461   670.2922   682.2922   703.5867   682.6282   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0004     28     no        paper_ID \nsigma^2.2  0.2812  0.5303    258     no  Observation_ID \nsigma^2.3  0.0001  0.0097     53     no  group_ID_coded \nsigma^2.4  0.0000  0.0001     17     no   population_ID \nsigma^2.5  0.0000  0.0000      7     no    bird_species \n\nTest for Heterogeneity:\nQ(df = 257) = 1183.6500, p-val < .0001\n\nModel Results:\n\nestimate      se    tval   df    pval   ci.lb   ci.ub     \n  0.1988  0.0661  3.0075  257  0.0029  0.0686  0.3289  ** \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npredict(SA_SMDH_flagged_no_missingES)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   pred     se  ci.lb  ci.ub   pi.lb  pi.ub \n 0.1988 0.0661 0.0686 0.3289 -0.8538 1.2514 \n```\n\n\n:::\n:::\n\n\n### No inferential stats for SMDH: effect sizes calculated from means, SDs, and sample size\n\n(i.e., excluding any effect sizes calculated from inferential statistics)\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#----------------------------------------------------------------------------\n# for SMDH as Effect Size\n#----------------------------------------------------------------------------\n\n# Preparing new variance-covariance matrix\n\nVCV_SMDH_no_inferential <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = SMDH_no_inferential,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\n\n## Running intercept only model\n\nSA_SMDH_no_inferential<- rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_no_inferential, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = SMDH_no_inferential)\n\n\n\n# Saving the model\nsaveRDS(SA_SMDH_no_inferential, file = here::here(\"model/sensitivity_analysis/SA_SMDH_no_inferential.rds\"))\n\n# saving the dataset for this model\nwrite.csv(SMDH_no_inferential,here::here(\"data/05_data_sensitivity_analysis/dataset_SMDH_no_inferential.csv\"))\n\n# What is the effect now?\n\nsummary(SA_SMDH_no_inferential)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 245; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-319.1347   638.2694   650.2694   671.2524   650.6238   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0005     26     no        paper_ID \nsigma^2.2  0.2716  0.5212    245     no  Observation_ID \nsigma^2.3  0.0000  0.0018     46     no  group_ID_coded \nsigma^2.4  0.0000  0.0001     17     no   population_ID \nsigma^2.5  0.0000  0.0000      7     no    bird_species \n\nTest for Heterogeneity:\nQ(df = 244) = 1105.9021, p-val < .0001\n\nModel Results:\n\nestimate      se    tval   df    pval   ci.lb   ci.ub     \n  0.1794  0.0685  2.6193  244  0.0094  0.0445  0.3143  ** \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npredict(SA_SMDH_no_inferential)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   pred     se  ci.lb  ci.ub   pi.lb  pi.ub \n 0.1794 0.0685 0.0445 0.3143 -0.8560 1.2148 \n```\n\n\n:::\n:::\n\n\n### Exluding failed geary's test for lnRR\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#----------------------------------------------------------------------------\n# for  lnRR  as Effect Size\n#----------------------------------------------------------------------------\n\nVCV_lnRR_geary_passed <- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = lnRR_geary_passed,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\n\nSA_lnRR_geary_passed<- rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_geary_passed, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = lnRR_geary_passed)\n\n# Saving the model\nsaveRDS(SA_lnRR_geary_passed, file = here::here(\"model/sensitivity_analysis/SA_lnRR_geary_passed.rds\"))\n\n# saving the dataset for this model\nwrite.csv(lnRR_geary_passed,here::here(\"data/05_data_sensitivity_analysis/dataset_lnRR_geary_passed.csv\"))\n```\n:::\n\n\n### Excluding the parasite and pathogen load fitness proxies\n\nIt excludes all the fitness proxies relating to parasite and pathogen loads/ abundance etc.\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#----------------------------------------------------------------------------\n# for  lnRR  as Effect Size\n#----------------------------------------------------------------------------\n\ndataset_lnRR_no_para<-dataset_lnRR%>%filter(is.na(parasite_type))\n\n## The dataset is reduced to almost half\nnrow(dataset_lnRR)-nrow(dataset_lnRR_no_para)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 82\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nVCV_lnRR_no_para <- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_lnRR_no_para,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\n\nSA_lnRR_no_para<- rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_no_para, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = dataset_lnRR_no_para)\n\n# Saving the model\nsaveRDS(SA_lnRR_no_para, file = here::here(\"model/sensitivity_analysis/SA_lnRR_no_para.rds\"))\n\n# saving the dataset for this model\nwrite.csv(dataset_lnRR_no_para,here::here(\"data/05_data_sensitivity_analysis/dataset_lnRR_no_para.csv\"))\n\n\n#----------------------------------------------------------------------------\n# for  SMDH  as Effect Size\n#----------------------------------------------------------------------------\n\ndataset_SMDH_no_para<-dataset_SMDH%>%filter(is.na(parasite_type))\n\n## The dataset is reduced to almost half\nnrow(dataset_SMDH)-nrow(dataset_SMDH_no_para)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 86\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nVCV_SMDH_no_para <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_SMDH_no_para,\n                  rho = 0.5) # assuming that the effect sizes within the same study are correlated with rho = 0.5\n\n\nSA_SMDH_no_para<- rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_no_para, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = dataset_SMDH_no_para)\n\n# Saving the model\nsaveRDS(SA_SMDH_no_para, file = here::here(\"model/sensitivity_analysis/SA_SMDH_no_para.rds\"))\n\n# saving the dataset for this model\nwrite.csv(dataset_SMDH_no_para,here::here(\"data/05_data_sensitivity_analysis/dataset_SMDH_no_para.csv\"))\n```\n:::\n\n\n## Different values of sampling variance correlation\n\n::: callout-important\n**Pre-registered**: We will also perform a sensitivity analysis using 0.3 and 0.7 correlation between the sampling variances from the same paper_ID and report it in the supplementary materials. If this sensitivity analysis shows large differences in conclusions for the intercept-only model, we will proceed to perform such sensitivity analysis for the meta-regressions.\n:::\n\nFirst, set a series of ρs (i.e., 0.3, 0.5, 0.7) (we assume these values arbitrarily):\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# rho_range <- c(0.2,0.3, 0.5, 0.7,0.8)\n# \n# SA_lnRR_VCV_range <- list() # repeatedly run the specified model with varying rho\n# for (i in 1:length(rho_range)){\n#   VCV_range <- vcalc(vi = lnRR_variance,\n#                      cluster = paper_ID,\n#                      obs = Observation_ID,\n#                      data = dataset_lnRR,\n#                      rho = rho_range[i])\n# \n#   lnRR_VCV_range[[i]] <- rma.mv(yi = lnRR_sign,\n#                                 V = VCV_range,\n#                                 random = list(~ 1 | paper_ID,\n#                                               ~ 1 | Observation_ID,\n#                                               ~ 1 | group_ID_coded,\n#                                               ~ 1 | population_ID,\n#                                               ~ 1 | bird_species),\n#                                 method = \"REML\",\n#                                 data = dataset_lnRR)\n# }\n# \n# \n# save(SA_lnRR_VCV_range, file = here::here(\"model/sensitivity_analysis/SA_lnRR_VCV_range.rds\"))\n# \n# \n# #------------------------------------------------------------------\n# #-------------Now for SMDH the same SA with diff Rho---------------\n# #------------------------------------------------------------------\n# \n# SA_SMDH_VCV_range <- list()\n# \n# for (i in 1:length(rho_range)){\n#   VCV_range <- vcalc(vi = SMDH_variance,\n#                      cluster = paper_ID,\n#                      obs = Observation_ID,\n#                      data = dataset_SMDH,\n#                      rho = rho_range[i])\n#   SA_SMDH_VCV_range[[i]] <- rma.mv(yi = SMDH_sign,\n#                                 V = VCV_range,\n#                                 random = list(~ 1 | paper_ID,\n#                                               ~ 1 | Observation_ID,\n#                                               ~ 1 | group_ID_coded,\n#                                               ~ 1 | population_ID,\n#                                               ~ 1 | bird_species),\n#                                 method = \"REML\",\n#                                 data = dataset_SMDH)\n# }\n# \n# \n# save(SA_SMDH_VCV_range, file = here::here(\"model/sensitivity_analysis/SA_SMDH_VCV_range.rds\"))\n```\n:::\n\n\n# Mechanistic Hypothesis\n\nTo address our secondary questions \"Does the addition of green nest material by birds increase their reproductive success? (Courtship hypothesis)\" and \"Does the addition of green nest material have protective effects and health benefits for the nestlings? (Parental care hypothesis)\", we will make use of the unimoderator multilevel meta-regressions hypothesis type (levels: CH, PCH, Both) as the moderator.\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlnRR_hypothesis <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + Hypothesis,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR)\n# Save model\nsaveRDS(lnRR_hypothesis, file = here::here(\"model/lnRR_hypothesis.rds\"))\n\n# saving the dataset for this model\nwrite.csv(dataset_lnRR,here::here(\"data/04_data_analysis/hypothesis_lnRR.csv\"))\n\n\nlnRR_hypothesis_R2 <- r2_ml(lnRR_hypothesis)\nround(lnRR_hypothesis_R2 * 100, 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   R2_marginal R2_conditional \n           1.6            1.6 \n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nSMDH_hypothesis <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + Hypothesis,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH)\n\n# Save model\nsaveRDS(SMDH_hypothesis, file = here::here(\"model/SMDH_hypothesis.rds\"))\n\n# saving the dataset for this model\nwrite.csv(dataset_SMDH,here::here(\"data/04_data_analysis/hypothesis_SMDH.csv\"))\n```\n:::\n\n\n# Meta-regressions\n\nFor understanding the heterogeneity in our intercept-only model, we will run unimoderator multilevel meta-regressions (see section Exploratory Analyses in pre-registration or manuscript) using the following moderators:\n\n## Type of experimental design\n\n(levels: 1 = non-aromatic vs. aromatic, 2 = no added material vs. aromatic, 3 = no added material vs. non-aromatic).\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# This analysis only includes dataset that has a proxy relating to comaparision type\ndataset_lnRR_design <- dataset_lnRR %>% filter(!is.na(comparision_type))\n\nVCV_lnRR_design <- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_lnRR_design,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\nlnRR_design <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_design ,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + comparision_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR_design )\n\n# Saving the model\nsaveRDS(lnRR_design, file = here::here(\"model/lnRR_design.rds\"))\n\n# saving the dataset for this model\nwrite.csv(dataset_lnRR_design,here::here(\"data/04_data_analysis/design_lnRR.csv\"))\n\n\n# This analysis only includes dataset that has a proxy relating to comaparision type\ndataset_SMDH_design <- dataset_SMDH %>% filter(!is.na(comparision_type))\n\nVCV_SMDH_design <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_SMDH_design,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\nSMDH_design <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_design ,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + comparision_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH_design )\n\n# Saving the model\nsaveRDS(SMDH_design, file = here::here(\"model/SMDH_design.rds\"))\n\n# saving the dataset for this model\nwrite.csv(dataset_SMDH_design,here::here(\"data/04_data_analysis/design_SMDH.csv\"))\n```\n:::\n\n\nLet me try to do a sensitivity analysis to see what happens when I remove the control condition of 3 in the overall model since that is expected to not have an effect according to the authors as well.. i.e. it is a double control..\n\n### Excluding non-aromatic and blank comparison (i.e. the two control group comparison)\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n## For the lnRR effect size...\ndataset_lnRR_no_comp3<-dataset_lnRR%>%filter(comparision_type!=3 | is.na(comparision_type))\n## Only some rows are removed... \nnrow(dataset_lnRR)-nrow(dataset_lnRR_no_comp3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 10\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nVCV_lnRR_no_comp3 <- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_lnRR_no_comp3,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\nSA_lnRR_no_comp3<- rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_no_comp3, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = dataset_lnRR_no_comp3)\n\n\n\n# Saving the model\nsaveRDS(SA_lnRR_no_comp3, file = here::here(\"model/sensitivity_analysis/SA_lnRR_no_comp3.rds\"))\n\n# saving the dataset for this model\nwrite.csv(dataset_lnRR_no_comp3,here::here(\"data/05_data_sensitivity_analysis/dataset_lnRR_no_comp3.csv\"))\n\n\n#----------------------------------------------------------------------------\n# for  SMDH  as Effect Size\n#----------------------------------------------------------------------------\n\ndataset_SMDH_no_comp3<-dataset_SMDH%>%filter(comparision_type!=3 | is.na(comparision_type))\n## Only some rows are removed... \nnrow(dataset_SMDH)-nrow(dataset_SMDH_no_comp3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 11\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nVCV_SMDH_no_comp3 <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_SMDH_no_comp3,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\nSA_SMDH_no_comp3<- rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_no_comp3, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = dataset_SMDH_no_comp3)\n\n\n\n# Saving the model\nsaveRDS(SA_SMDH_no_comp3, file = here::here(\"model/sensitivity_analysis/SA_SMDH_no_comp3.rds\"))\n\n# saving the dataset for this model\nwrite.csv(dataset_SMDH_no_comp3,here::here(\"data/05_data_sensitivity_analysis/dataset_SMDH_no_comp3.csv\"))\n```\n:::\n\n\nOverall conclusions remain practically the same irrespective.. now what about the meta-regression using Type of Experiment Design\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndataset_lnRR_design_SA <- dataset_lnRR %>% filter(comparision_type!=3)\n\nVCV_lnRR_design_SA <- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_lnRR_design_SA,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\nlnRR_design_SA <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_design_SA ,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + comparision_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR_design_SA )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Redundant predictors dropped from the model.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n## Now for SMDH\n\ndataset_SMDH_design_SA <- dataset_SMDH %>% filter(comparision_type!=3)\n\nVCV_SMDH_design_SA <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_SMDH_design_SA,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\nSMDH_design_SA <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_design_SA ,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + comparision_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH_design_SA)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Redundant predictors dropped from the model.\n```\n\n\n:::\n:::\n\n\n## Time of addition of green nest material\n\n(levels: before egg hatching, after egg hatching, continuously throughout the nesting phase).\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n## We use the complete dataset in this case\nlnRR_time_gnm_addition <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR,# specify lnRR's sampling variance using the variance-covariance matrix we created for the intercept-only model since the whole dataset is being used in this case as well\n                    mods = ~ - 1 + time_of_gnm_addition,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR)\n\n## Saving the model\nsaveRDS(lnRR_time_gnm_addition, file = here::here(\"model/lnRR_time_gnm_addition.rds\"))\n\n# saving the dataset for this model\nwrite.csv(dataset_lnRR,here::here(\"data/04_data_analysis/time_gnm_lnRR.csv\"))\n\n\n\n## Now similarly for the SMDH effect size using the complete dataset\nSMDH_time_gnm_addition <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH,# specify lnRR's sampling variance using the variance-covariance matrix we created for the intercept-only model since the whole dataset is being used in this case as well\n                    mods = ~ - 1 + time_of_gnm_addition,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH)\n\n## Saving the model\nsaveRDS(SMDH_time_gnm_addition, file = here::here(\"model/SMDH_time_gnm_addition.rds\"))\n\n# saving the dataset for this model\nwrite.csv(dataset_SMDH,here::here(\"data/04_data_analysis/time_gnm_SMDH.csv\"))\n```\n:::\n\n\n## Type of parasites\n\n(levels: arthropods, micro-organisms) \n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# This analysis only includes dataset that has a proxy relating to parasite or pathogen\ndataset_lnRR_parasite <- dataset_lnRR%>%\n  filter(!is.na(parasite_type))%>%\n  mutate(parasite_type=as.factor(parasite_type),\n         paper_ID=as.factor(paper_ID),\n         Observation_ID=as.factor(Observation_ID),\n         group_ID_coded=as.factor(group_ID_coded),\n         bird_species=as.factor(bird_species))\n\nVCV_lnRR_parasite <- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_lnRR_parasite,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\nlnRR_parasite <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_parasite,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + parasite_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                   test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR_parasite)\n\n\n# Saving the model\nsaveRDS(lnRR_parasite, file = here::here(\"model/lnRR_parasite.rds\"))\n\n# saving the dataset for this model\nwrite.csv(dataset_lnRR_parasite,here::here(\"data/04_data_analysis/parasite_lnRR.csv\"))\n\n### Similiarly for SMDH as well selecting the dataset with parasite type\n# This analysis only includes dataset that has a proxy relating to parasite or pathogen\ndataset_SMDH_parasite <- dataset_SMDH%>%\n  filter(!is.na(parasite_type))\nVCV_SMDH_parasite <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_SMDH_parasite,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\nSMDH_parasite <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_parasite,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + parasite_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                   test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH_parasite)\n\n# Save the model\nsaveRDS(SMDH_parasite, file = here::here(\"model/SMDH_parasite.rds\"))\n\n# saving the dataset for this model\nwrite.csv(dataset_SMDH_parasite,here::here(\"data/04_data_analysis/parasite_SMDH.csv\"))\n```\n:::\n\n\n#### Bird species\n\n(levels: Cyanistes caeruleus, Sturnus unicolor, Tachycineta bicolor, Sturnus vulgaris; note that these levels reflect the list of species studied in our current database, which may increase after updating our search and/or receiving unpublished data from authors)\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlnRR_birds <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + bird_species,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR)\n\n# Saving the model\nsaveRDS(lnRR_birds, file = here::here(\"model/lnRR_birds.rds\"))\n\n# Saving the dataset for this model\nwrite.csv(dataset_lnRR,here::here(\"data/04_data_analysis/birds_lnRR.csv\"))\n\n## Now doing this for SMDH\n\nSMDH_birds <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + bird_species,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH)\n\n# Saving the model\nsaveRDS(SMDH_birds, file = here::here(\"model/SMDH_birds.rds\"))\n\n# Saving the dataset for this model\nwrite.csv(dataset_SMDH,here::here(\"data/04_data_analysis/birds_SMDH.csv\"))\n```\n:::\n\n\n#### Type of trait studied\n\n(levels:physiology, morphology, reproduction, behaviour, parasite and pathogenic load, phenology)\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlnRR_trait <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + trait_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR)\n\n# Saving the model\nsaveRDS(lnRR_trait, file = here::here(\"model/lnRR_trait.rds\"))\n\n# Saving the dataset for this model\nwrite.csv(dataset_lnRR,here::here(\"data/04_data_analysis/trait_lnRR.csv\"))\n\n## Now similarly for SMDH\n\nSMDH_trait <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + trait_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH)\n\n# Saving the model\nsaveRDS(SMDH_trait, file = here::here(\"model/SMDH_trait.rds\"))\n\n# Saving the dataset for this model\nwrite.csv(dataset_SMDH,here::here(\"data/04_data_analysis/SMDH_lnRR.csv\"))\n```\n:::\n\n\n# Risk of Bias\n\n6\\. Blinding: (Levels: yes, no(\n\n7\\. Random Assignment: (Levels: yes, no)\n\n8\\. Missing Data: (Levels: yes, no)\n\nNote that the specific subset of data for each meta-regression may differ based on the data availability (e.g., information about the type of parasites is only available for effect sizes based on parasite/pathogen related fitness proxy). We will conduct meta-regression on suitable subsets of data for each analysis, provided we have sufficient effect sizes per moderator level (i.e., at least 5 effect sizes per moderator level).\n\n::: callout-important\n## Phylogenetic Effects\n\nNote also that if we obtain additional effect sizes for other bird species after we update our search and/or contact authors, our models may need to account for phylogenetic nonindependence via the inclusion of two additional random effects: \"species\" and \"phylogeny\" following Cinar et al. (2022).\n:::\n\n## Other Analysis\n\n### Risk of Bias Assessment\n\n-   RoB - The outcome will be presented in the form of a [**summary table**]{.underline}. We will conduct uni-moderator meta-regressions using these variables.\n\n# Publication Bias\n\nSmall study effects:\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndataset_lnRR_published<-dataset_lnRR_published%>%\n  mutate(effective_n_inv=1/((4*effective_n_experiment*effective_n_control)/(effective_n_experiment+effective_n_control)))%>%\n  mutate(sqrt_effective_n_inv=sqrt(effective_n_inv))\n\n\nlnRR_small_study <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_published,# specify lnRR's sampling variance;\n                    mods = ~sqrt_effective_n_inv,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR_published)\n\n\n# saving the model\nsaveRDS(lnRR_small_study, file = here::here(\"model/lnRR_small_study.rds\"))\n\nsummary(lnRR_small_study)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 221; method: REML)\n\n  logLik  Deviance       AIC       BIC      AICc   \n-22.8747   45.7494   59.7494   83.4729   60.2802   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0003     24     no        paper_ID \nsigma^2.2  0.0244  0.1561    221     no  Observation_ID \nsigma^2.3  0.0000  0.0002     44     no  group_ID_coded \nsigma^2.4  0.0000  0.0000     15     no   population_ID \nsigma^2.5  0.0000  0.0000      6     no    bird_species \n\nTest for Residual Heterogeneity:\nQE(df = 219) = 2233.6944, p-val < .0001\n\nTest of Moderators (coefficient 2):\nF(df1 = 1, df2 = 219) = 0.2828, p-val = 0.5954\n\nModel Results:\n\n                      estimate      se    tval   df    pval    ci.lb   ci.ub    \nintrcpt                 0.0033  0.0349  0.0934  219  0.9257  -0.0656  0.0721    \nsqrt_effective_n_inv    0.0793  0.1491  0.5318  219  0.5954  -0.2145  0.3731    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nround(r2_ml(lnRR_small_study)*100,2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   R2_marginal R2_conditional \n          0.34           0.34 \n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n## Now for SMDH model\n\ndataset_SMDH_published<-dataset_SMDH_published%>%\n  mutate(effective_n_inv=1/((4*effective_n_experiment*effective_n_control)/(effective_n_experiment+effective_n_control)))%>%\n  mutate(sqrt_effective_n_inv=sqrt(effective_n_inv))\n\n\nSMDH_small_study <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_published,# specify lnRR's sampling variance;\n                    mods = ~sqrt_effective_n_inv,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH_published)\n\n# saving the model\nsaveRDS(SMDH_small_study, file = here::here(\"model/SMDH_small_study.rds\"))\n\nsummary(SMDH_small_study)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 235; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-305.6554   611.3107   625.3107   649.4680   625.8085   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0009     24     no        paper_ID \nsigma^2.2  0.2721  0.5216    235     no  Observation_ID \nsigma^2.3  0.0000  0.0004     45     no  group_ID_coded \nsigma^2.4  0.0000  0.0002     15     no   population_ID \nsigma^2.5  0.0000  0.0001      6     no    bird_species \n\nTest for Residual Heterogeneity:\nQE(df = 233) = 1089.6262, p-val < .0001\n\nTest of Moderators (coefficient 2):\nF(df1 = 1, df2 = 233) = 3.1936, p-val = 0.0752\n\nModel Results:\n\n                      estimate      se     tval   df    pval    ci.lb   ci.ub \nintrcpt                -0.0348  0.1441  -0.2417  233  0.8092  -0.3187  0.2491 \nsqrt_effective_n_inv    1.3931  0.7795   1.7871  233  0.0752  -0.1428  2.9289 \n                        \nintrcpt                 \nsqrt_effective_n_inv  . \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nround(r2_ml(SMDH_small_study)*100,2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   R2_marginal R2_conditional \n          8.31           8.31 \n```\n\n\n:::\n:::\n\n\nDecline effects (Time lag bias)\n\nNext, run a uni-moderator meta-regression to test for evidence of decline effects (also known as time-lag bias) which includes year of publication (mean-centered) as the only moderator, and whose slope would provide information about whether the overall effect size has changed (decline) over time (Nakagawa et al. 2022; Sánchez-Tójar et al. 2018).\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndataset_lnRR_published<-dataset_lnRR_published%>%\n  mutate(year_MeanCenter=scale(as.numeric(year_publication),scale=F)[,1])\n\nlnRR_decline_eff <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_published,# specify lnRR's sampling variance;\n                    mods = ~ year_MeanCenter,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR_published)\n\n# saving the model\nsaveRDS(lnRR_decline_eff, file = here::here(\"model/lnRR_decline_eff.rds\"))\n  \nsummary(lnRR_decline_eff)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 221; method: REML)\n\n  logLik  Deviance       AIC       BIC      AICc   \n-22.3187   44.6375   58.6375   82.3610   59.1683   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0003     24     no        paper_ID \nsigma^2.2  0.0235  0.1533    221     no  Observation_ID \nsigma^2.3  0.0000  0.0001     44     no  group_ID_coded \nsigma^2.4  0.0000  0.0000     15     no   population_ID \nsigma^2.5  0.0000  0.0000      6     no    bird_species \n\nTest for Residual Heterogeneity:\nQE(df = 219) = 1985.1165, p-val < .0001\n\nTest of Moderators (coefficient 2):\nF(df1 = 1, df2 = 219) = 1.4831, p-val = 0.2246\n\nModel Results:\n\n                 estimate      se     tval   df    pval    ci.lb   ci.ub    \nintrcpt            0.0209  0.0161   1.2979  219  0.1957  -0.0109  0.0527    \nyear_MeanCenter   -0.0018  0.0015  -1.2178  219  0.2246  -0.0048  0.0011    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nround(r2_ml(lnRR_decline_eff)*100,2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   R2_marginal R2_conditional \n          1.76           1.76 \n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n## --- Now for SMDH -----\ndataset_SMDH_published<-dataset_SMDH_published%>%\n  mutate(year_MeanCenter=scale(as.numeric(year_publication),scale=F)[,1])\n\n\n\nSMDH_decline_eff <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_published,# specify lnRR's sampling variance;\n                    mods = ~ year_MeanCenter,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH_published)\n# saving the model\nsaveRDS(SMDH_decline_eff, file = here::here(\"model/SMDH_decline_eff.rds\"))\n\nsummary(SMDH_decline_eff)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 235; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-306.7002   613.4005   627.4005   651.5577   627.8982   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0013     24     no        paper_ID \nsigma^2.2  0.2768  0.5261    235     no  Observation_ID \nsigma^2.3  0.0000  0.0029     45     no  group_ID_coded \nsigma^2.4  0.0000  0.0003     15     no   population_ID \nsigma^2.5  0.0000  0.0000      6     no    bird_species \n\nTest for Residual Heterogeneity:\nQE(df = 233) = 1091.5803, p-val < .0001\n\nTest of Moderators (coefficient 2):\nF(df1 = 1, df2 = 233) = 1.2515, p-val = 0.2644\n\nModel Results:\n\n                 estimate      se     tval   df    pval    ci.lb   ci.ub     \nintrcpt            0.1935  0.0690   2.8051  233  0.0055   0.0576  0.3293  ** \nyear_MeanCenter   -0.0083  0.0074  -1.1187  233  0.2644  -0.0228  0.0063     \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nround(r2_ml(SMDH_decline_eff)*100,2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   R2_marginal R2_conditional \n          2.93           2.93 \n```\n\n\n:::\n:::\n\n\nLast, run an all-in meta-regression including both the (square root of the) inverse of the 'effective sample size' and the mean-centered year of publication as well as all the other moderators tested in our study to estimate how much heterogeneity is explained by all moderators combined as well as to explore whether evidence remains similar after accounting for all the other moderators (see equation 29 in Nakagawa et al. 2022 for more information about this approach). \n\n## All-in Model for heterogeneity\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# ## For lnRR complete dataset\n# \n# ## I am changing the year of unpublished studies to 2025 which is to now, assuming that if they were to be published now, what would be the effect. I will keep in mind that in this model if I do find an evidence of publication bias over years, I should keep in mind it is non-independent of the unpublished studies\n# \n# dataset_lnRR_all_in<-dataset_lnRR%>%mutate(year_publication = case_when(is.na(year_publication) ~ 2025, TRUE ~ year_publication))%>%\n#   mutate(year_MeanCenter=scale(as.numeric(year_publication),scale=F)[,1])%>%\n#   mutate(effective_n_inv=1/((4*effective_n_experiment*effective_n_control)/(effective_n_experiment+effective_n_control)))%>%\n#   mutate(sqrt_effective_n_inv=sqrt(effective_n_inv))%>%\n#   mutate(comparision_type= case_when(is.na(comparision_type) ~ 4, TRUE ~ comparision_type))\n# \n# VCV_lnRR_all_in<- vcalc(vi = lnRR_variance,\n#                   cluster = paper_ID,\n#                   obs = Observation_ID,\n#                   data = dataset_lnRR_all_in,\n#                   rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n#                   )\n# \n# lnRR_all_in <- rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n#                     V = VCV_lnRR_all_in, # specify lnRR's sampling variance-covariance matrix;\n#                     mods = ~ time_of_gnm_addition + \n#                       year_MeanCenter + \n#                       sqrt_effective_n_inv + \n#                       as.factor(comparision_type) + \n#                       bird_species + \n#                       trait_type,\n#                     random = list(~ 1 | paper_ID,\n#                                   ~ 1 | Observation_ID,\n#                                   ~ 1 | group_ID_coded,\n#                                   ~ 1 | population_ID,\n#                                   ~ 1 | bird_species),\n#                     method = \"REML\",\n#                     control = list(optimizer=\"optim\"),\n#                     test = \"t\",\n#                     data = dataset_lnRR_all_in)\n# \n# \n# \n# ## For SMDH complete published dataset\n# \n# dataset_SMDH_all_in<-dataset_SMDH%>%mutate(year_publication = case_when(is.na(year_publication) ~ 2025, TRUE ~ year_publication))%>%\n#   mutate(year_MeanCenter=scale(as.numeric(year_publication),scale=F)[,1])%>%\n#   mutate(effective_n_inv=1/((4*effective_n_experiment*effective_n_control)/(effective_n_experiment+effective_n_control)))%>%\n#   mutate(sqrt_effective_n_inv=sqrt(effective_n_inv))%>%\n#   mutate(comparision_type= case_when(is.na(comparision_type) ~ 4, TRUE ~ comparision_type))\n# \n# VCV_SMDH_all_in<- vcalc(vi = SMDH_variance,\n#                   cluster = paper_ID,\n#                   obs = Observation_ID,\n#                   data = dataset_SMDH_all_in,\n#                   rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n#                   )\n# \n# SMDH_all_in<- rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n#                     V = VCV_SMDH_all_in, # specify lnRR's sampling variance-covariance matrix;\n#                     mods = ~ time_of_gnm_addition + \n#                       year_MeanCenter + \n#                       sqrt_effective_n_inv + \n#                       as.factor(comparision_type) + \n#                       bird_species + \n#                       trait_type,\n#                     random = list(~ 1 | paper_ID,\n#                                   ~ 1 | Observation_ID,\n#                                   ~ 1 | group_ID_coded,\n#                                   ~ 1 | population_ID,\n#                                   ~ 1 | bird_species),\n#                     method = \"REML\",\n#                     control = list(optimizer=\"optim\"),\n#                     test = \"t\",\n#                     data = dataset_SMDH_all_in)\n```\n:::\n\n\n# Pair-wise comparison for meta-regression\n\nincluding including post-hoc Wald tests\n\nFor this I have to run all the meta-regressions again without removing the intercepts, good luck to me!\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#----------------------------------------------------------------------------------\n# For Different hypothesis\n#----------------------------------------------------------------------------------\n## For lnRR\nVCV_lnRR<- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_lnRR,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\nlnRR_hypothesis_pc <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR,# specify lnRR's sampling variance;\n                    mods = ~ Hypothesis,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR)\n\n# I now want to test for statistical differences between groups. Male and fem\n# information for androgens can be obtained from the outcome of the table. For thyroid\n# hormones I need to do Post-hoc Wald tests:\ncar::linearHypothesis(lnRR_hypothesis_pc, rbind(c(0,1,-1)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nLinear hypothesis test:\nHypothesisCH - HypothesisPCH = 0\n\nModel 1: restricted model\nModel 2: ~Hypothesis\n\n  Res.Df Df  Chisq Pr(>Chisq)\n1    236                     \n2    235  1 0.1986     0.6559\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# saving the model\nsaveRDS(lnRR_hypothesis_pc, file = here::here(\"model/lnRR_hypothesis_pc.rds\"))\n\n# For SMDH\n\nVCV_SMDH <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_SMDH,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\nSMDH_hypothesis_pc <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH,# specify lnRR's sampling variance;\n                    mods = ~ Hypothesis,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH)\n\n# I now want to test for statistical differences between groups. Male and fem\n# information for androgens can be obtained from the outcome of the table. For thyroid\n# hormones I need to do Post-hoc Wald tests:\ncar::linearHypothesis(SMDH_hypothesis_pc, rbind(c(0,1,-1)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nLinear hypothesis test:\nHypothesisCH - HypothesisPCH = 0\n\nModel 1: restricted model\nModel 2: ~Hypothesis\n\n  Res.Df Df  Chisq Pr(>Chisq)\n1    251                     \n2    250  1 0.0493     0.8243\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# saving the model\nsaveRDS(SMDH_hypothesis_pc, file = here::here(\"model/SMDH_hypothesis_pc.rds\"))\n\n\n#----------------------------------------------------------------------------------\n# For Type of experimental design\n#----------------------------------------------------------------------------------\n\n\n# This analysis only includes dataset that has a proxy relating to comaparision type\ndataset_lnRR_design <- dataset_lnRR %>% filter(!is.na(comparision_type))\n\nVCV_lnRR_design <- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_lnRR_design,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\nlnRR_design_pc <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_design ,# specify lnRR's sampling variance;\n                    mods = ~ comparision_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR_design )\n\n# Saving the model\nsaveRDS(lnRR_design_pc, file = here::here(\"model/lnRR_design_pc.rds\"))\n\n\n# This analysis only includes dataset that has a proxy relating to comaparision type\ndataset_SMDH_design <- dataset_SMDH %>% filter(!is.na(comparision_type))\n\nVCV_SMDH_design <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_SMDH_design,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\nSMDH_design_pc <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_design ,# specify lnRR's sampling variance;\n                    mods = ~ comparision_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH_design )\n\n# Saving the model\nsaveRDS(SMDH_design_pc, file = here::here(\"model/SMDH_design_pc.rds\"))\n\n\n#----------------------------------------------------------------------------------\n# For Time of addition of GNM\n#----------------------------------------------------------------------------------\n\n## We use the complete dataset in this case\nlnRR_time_gnm_addition_pc <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR,# specify lnRR's sampling variance using the variance-covariance matrix we created for the intercept-only model since the whole dataset is being used in this case as well\n                    mods = ~ time_of_gnm_addition,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR)\n\n## Saving the model\nsaveRDS(lnRR_time_gnm_addition_pc, file = here::here(\"model/lnRR_time_gnm_addition_pc.rds\"))\n\n\n## Now similarly for the SMDH effect size using the complete dataset\nSMDH_time_gnm_addition_pc <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH,# specify lnRR's sampling variance using the variance-covariance matrix we created for the intercept-only model since the whole dataset is being used in this case as well\n                    mods = ~ time_of_gnm_addition,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH)\n\n## Saving the model\nsaveRDS(SMDH_time_gnm_addition_pc, file = here::here(\"model/SMDH_time_gnm_addition_pc.rds\"))\n\n#----------------------------------------------------------------------------------\n# Parasite Type\n#----------------------------------------------------------------------------------\n\n# This analysis only includes dataset that has a proxy relating to parasite or pathogen\ndataset_lnRR_parasite <- dataset_lnRR%>%\n  filter(!is.na(parasite_type))%>%\n  mutate(parasite_type=as.factor(parasite_type),\n         paper_ID=as.factor(paper_ID),\n         Observation_ID=as.factor(Observation_ID),\n         group_ID_coded=as.factor(group_ID_coded),\n         bird_species=as.factor(bird_species))\n\nVCV_lnRR_parasite <- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_lnRR_parasite,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\nlnRR_parasite_pc <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_parasite,# specify lnRR's sampling variance;\n                    mods = ~ parasite_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                   test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR_parasite)\n\n\n# Saving the model\nsaveRDS(lnRR_parasite_pc, file = here::here(\"model/lnRR_parasite_pc.rds\"))\n\n### Similiarly for SMDH as well selecting the dataset with parasite type\n# This analysis only includes dataset that has a proxy relating to parasite or pathogen\ndataset_SMDH_parasite <- dataset_SMDH%>%\n  filter(!is.na(parasite_type))\nVCV_SMDH_parasite <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_SMDH_parasite,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\nSMDH_parasite_pc <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_parasite,# specify lnRR's sampling variance;\n                    mods =  parasite_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                   test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH_parasite)\n\n# Save the model\nsaveRDS(SMDH_parasite_pc, file = here::here(\"model/SMDH_parasite_pc.rds\"))\n\n#----------------------------------------------------------------------------------\n# Bird Species\n#----------------------------------------------------------------------------------\n\nlnRR_birds_pc <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR,# specify lnRR's sampling variance;\n                    mods = ~ bird_species,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR)\n\n# Saving the model\nsaveRDS(lnRR_birds_pc, file = here::here(\"model/lnRR_birds_pc.rds\"))\n\n\n## Now doing this for SMDH\n\nSMDH_birds_pc <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH,# specify lnRR's sampling variance;\n                    mods = ~  bird_species,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH)\n\n# Saving the model\nsaveRDS(SMDH_birds_pc, file = here::here(\"model/SMDH_birds_pc.rds\"))\n\n\n#----------------------------------------------------------------------------------\n# Type of trait studied\n#----------------------------------------------------------------------------------\n\n\n\nlnRR_trait_pc <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR,# specify lnRR's sampling variance;\n                    mods = ~ trait_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR)\n\n# Saving the model\nsaveRDS(lnRR_trait_pc, file = here::here(\"model/lnRR_trait_pc.rds\"))\n\n## Now similarly for SMDH\n\nSMDH_trait_pc <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH,# specify lnRR's sampling variance;\n                    mods = ~ trait_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH)\n\n# Saving the model\nsaveRDS(SMDH_trait_pc, file = here::here(\"model/SMDH_trait_pc.rds\"))\n```\n:::\n\n\n\\\n",
    "supporting": [
      "07_data_analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}