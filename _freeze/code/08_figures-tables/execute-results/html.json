{
  "hash": "217cbe9f53b61c8b49ccf513904f60aa",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Figures\"\nauthor: \"Shreya D.\"\ndate: \"2025-07-11\"\noutput: html_document\n---\n\n\n::: {.cell .hidden}\n\n```{.r .cell-code .hidden}\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n\n# ---- FIGURES --------------\n\n# Visualising location and bird species\n\nI am using the figure code from here and adapting it for my needs..\n\nMentesana, L., Hau, M., D'Amelio, P.B., Adreani, N.M. and Sánchez-Tójar, A. (2025), Do Egg Hormones Have Fitness Consequences in Wild Birds? A Systematic Review and Meta-Analysis. Ecology Letters, 28: e70100. <https://doi.org/10.1111/ele.70100>\n\nCode here: `https://github.com/ASanchez-Tojar/meta-analysis_egg_hormones_and_fitness/blob/main/code/003_figures.R`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Let's get the needed packages\nif (!requireNamespace(\"devtools\", quietly = TRUE))\n    install.packages(\"devtools\")\n\nif (!requireNamespace(\"orchaRd\", quietly = TRUE))\n    devtools::install_github(\"daniel1noble/orchaRd\", ref = \"main\")\n\npacman::p_load(ggplot2,dplyr,stringr,readr,cowplot,maps)\n\n## Let's first get the data in for this plot\n\n# Loading cleaned dataset\ndataset_analysis<- read_csv(here::here(\"data/04_data_analysis/dataset_analysis.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRows: 274 Columns: 71\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (35): paper_ID, fulltext_screening, variable_note, authors, population_l...\ndbl (35): year_publication, Observation_ID, experiment_ID, group_ID, repeate...\nlgl  (1): fulltext_notes\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# To split population_ID into location and country\ndataset_analysis[c('Location','Country')] <- str_split_fixed(dataset_analysis$population_ID, ',', 2)\n\n### For the purpose of this map, I am adding the the longitude and latitude of the study area manually. They exist in the dataset_analysis$population_location as they were extracted from the paper. I have also added some by just searching the general location since the coordinates were not provided for these..\n\n\ndata_coordinates<-data.frame(Location = unique(dataset_analysis$Location),\n                             Lat_Location=c(51.50,38.41,40.45,\n                                            45.40,52.39, 37.18,40.53,\n                                            54,39.05,\n                                            51.57,48,42.54,39.95,\n                                            40.13,28.10,52.06,60.39),\n                             Long_Location=c(19.29,-9.02,-3.50,\n                                             -64.10,6.05,-3.11,-4.01,\n                                             -124,-76.81,\n                                             -2.26,11,8.91,-75.16,\n                                             -8.27,107.10,8.25,5.32))\n\n## Let's now merge the datasets by the location names\n\ndataset_analysis <- dataset_analysis %>%\n  left_join(data_coordinates, by = \"Location\")\n\n## Count how many times each Location appears in the full dataset\nlocation_counts <- dataset_analysis %>%\n  group_by(Location, bird_species) %>%\n  summarise(\n    size.freq = n(),\n  )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`summarise()` has grouped output by 'Location'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n\n```{.r .cell-code}\n# I will subset the data base so that I get one row per Location AND bird_species.\n# Like this, I get one point per location independently of the number of effect sizes\n# we have per place.\ndataset_analysis_unique_rows <- dataset_analysis %>%\n  distinct(Location, bird_species, .keep_all = TRUE)\n\n# Merge the counts into the unique rows dataset\ndataset_analysis_unique_rows <- dataset_analysis_unique_rows %>%\n  left_join(location_counts, by = c(\"Location\", \"bird_species\"))\n\n# create data for world coordinates using  \n# map_data() function \nworld_coordinates <- map_data(\"world\") \n\n# create world map using ggplot() function \n# geom_map() function takes world coordinates as input to plot world map \nfig_map <- ggplot(world_coordinates, aes(x = long, y = lat)) + \n  geom_map(map = world_coordinates, \n    aes(map_id = region), \n    color = \"white\", fill= \"#D9EAF7\") + \n  geom_point(data = dataset_analysis_unique_rows, \n             aes(x = Long_Location, y = Lat_Location,\n                 size = size.freq, colour=bird_species),\n             alpha = 0.6) +\n scale_size(range = c(1, 2.5)) +\n  scale_fill_manual(values = c(\"#00B0BE\",\"#FFB255\",  \"#FF8CAE\", \n                                 \"#F47A00\", \"#98C127\",\"#003A7D\",\"#7E4794\")) +\n  \n  scale_colour_manual(values = c(\"#00B0BE\",\"#FFB255\",  \"#FF8CAE\", \n                                 \"#F47A00\", \"#98C127\",\"#003A7D\",\"#7E4794\")) +\n  guides(size = \"none\", alpha = \"none\",\n         colour = guide_legend(override.aes = list(size = 1.5), keywidth = 0.4,\n                               keyheight = 0.4))+\n  labs(x = \"Longitude\",\n       y = \"Latitude\",\n       col = \"Bird Species\")+\n  theme_classic() +\n  theme(plot.margin = margin(t =15, r = 15, b = 5, l = 5),  \n        legend.position = c(1.02, 0.42),\n        legend.justification = c(\"right\", \"bottom\"),\n        legend.background = element_rect(fill = \"white\", color = \"black\"),\n        legend.text = element_text(size=6),\n        legend.title = element_text(size=7),\n        axis.title = element_text(size = 8),\n        axis.text.x = element_text(size = 10),\n        axis.text.y = element_text(size = 10))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2\n3.5.0.\nℹ Please use the `legend.position.inside` argument of `theme()` instead.\n```\n\n\n:::\n\n```{.r .cell-code}\n# To add the zoomed in map.. to show the points more clearly\nzoom_map <- ggplot() + \n  geom_map(data = world_coordinates, map = world_coordinates,\n           aes(map_id = region),\n           color = \"white\", fill = \"#D4D4D4\") +\n  geom_point(data = dataset_analysis_unique_rows,\n             aes(x = Long_Location, y = Lat_Location,\n                 size = size.freq, colour = bird_species),\n             position = position_jitter(width = 0.2, height = 0.2),\n             alpha = 0.7) +\n  scale_size(range = c(1, 2)) +\n  scale_colour_manual(values = c(\"#00B0BE\",\"#FFB255\",  \"#FF8CAE\", \n                                 \"#F47A00\", \"#98C127\",\"#003A7D\",\"#7E4794\")) +\n  coord_cartesian(xlim = c(-10, 20), ylim = c(25, 65)) +  # Northern Hemisphere\n  theme_void() +\n  theme(\n    legend.position = \"none\",\n    plot.background = element_rect(color = \"white\", fill=\"white\"),\n    panel.border = element_rect(colour = \"black\", fill = NA, size = 1)\n  )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: The `size` argument of `element_rect()` is deprecated as of ggplot2 3.4.0.\nℹ Please use the `linewidth` argument instead.\n```\n\n\n:::\n\n```{.r .cell-code}\ngeographic_distribution <- ggdraw() +\n  draw_plot(fig_map) +\n  draw_plot(zoom_map, x = 0.11, y = 0.21, width = 0.20, height = 0.28) + theme(panel.border = element_rect(colour = \"black\", fill=NA, size=1.2))\n\nggsave(here::here(\"figures/Figure_Distribution.png\"), plot = geographic_distribution, height = 100, width = 170, units= 'mm', dpi = 600)\n```\n:::\n\n\n# Visualizing author network\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# # Loading cleaned dataset\n# dataset_analysis<- read_csv(here::here(\"data/03_data_cleaning/dataset_analysis.csv\"))\n# \n# library(tidyverse)\n# library(tidyr)\n# library(igraph)\n# installed.packages(\"ggraph\")\n# library(ggraph)\n# \n# clean_author <- function(name) {\n#   name %>%\n#     str_replace_all(\",\", \"\") %>%   # remove commas\n#     str_squish() %>%              # remove excess whitespace\n#     str_to_title()                # standardize case (optional, if needed)\n# }\n# \n# # Apply cleaning to first and last author fields\n# author_roles <- dataset_analysis %>%\n#   distinct(paper_ID, .keep_all = TRUE) %>%\n#   select(paper_ID, authors, bird_species) %>%\n#   mutate(\n#     author_list = str_split(authors, \";\\\\s*\"),\n#     first_author = map_chr(author_list, 1),\n#     last_author = map_chr(author_list, ~ tail(.x, 1))\n#   )%>%\n#   mutate(\n#     first_author=case_when(\n#       first_author == \"Polo, V\" | first_author == \"Polo V\" ~ \"Polo V.\",\n#       first_author == \"Soler J J\" ~ \"Soler J. J.\",\n#       first_author == \"Glądalski, M\" ~ \"Gladalski M.\",\n#       first_author == \"Gwinner, H\" | first_author == \"Gwinner H\" ~ \"Gwinner H.\",\n#       TRUE ~ as.character(first_author)\n#     ))%>%\n#   mutate(\n#     last_author=case_when(\n#       last_author == \"Veiga J P\" ~ \"Veiga J. P.\",\n#       TRUE ~ as.character(last_author)\n#     )\n#   )\n# \n# # 2. Create Core Author Pairs (First → Last)\n# author_pairs_core <- author_roles %>%\n#   select(paper_ID, first_author, last_author) %>%\n#   rename(from = first_author, to = last_author) %>%\n#   filter(from != to) %>%\n#   count(from, to, name = \"weight\")\n# \n# # 3. Build Author Graph\n# author_graph <- graph_from_data_frame(author_pairs_core, directed = TRUE)\n# \n# # 4. Assign Dominant Bird Species to PIs (last authors)\n# author_species <- author_roles %>%\n#   select(last_author, bird_species) %>%\n#   group_by(last_author, bird_species) %>%\n#   count() %>%\n#   slice_max(n, n = 1) %>%\n#   distinct(last_author, .keep_all = TRUE)\n# \n# # Add species as vertex attribute\n# V(author_graph)$bird_species <- author_species$bird_species[\n#   match(V(author_graph)$name, author_species$last_author)\n# ]\n# \n# # 5. Optional: Scale node size by number of papers per author\n# author_paper_counts <- author_roles %>%\n#   pivot_longer(cols = c(first_author, last_author), names_to = \"role\", values_to = \"author\") %>%\n#   count(author, name = \"paper_count\")\n# \n# # Add paper count attribute\n# V(author_graph)$paper_count <- author_paper_counts$paper_count[\n#   match(V(author_graph)$name, author_paper_counts$author)\n# ]\n# \n# # Replace NAs with small size for isolated authors\n# V(author_graph)$paper_count[is.na(V(author_graph)$paper_count)] <- 1\n# \n# # 6. Plot with ggraph\n# ggraph(author_graph, layout = \"fr\") +\n#   geom_edge_link(aes(width = weight), alpha = 0.4, color = \"grey50\") +\n#   geom_node_point(aes(color = bird_species, size = paper_count)) +\n#   geom_node_text(aes(label = name), repel = TRUE, size = 3) +\n#   scale_edge_width(range = c(0.3, 2)) +\n#   scale_size(range = c(3, 10)) +\n#   theme_void() +\n#   labs(title = \"Author Collaboration Network by Bird Species\",\n#        size = \"Paper Count\") +\n#   theme(legend.position = \"right\")\n# \n```\n:::\n\n\n# Intercept only model\n\nOrchard plot for overall effect of green nest material on fitness using lnRR and SMDH\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(here,tidyverse,metafor,orchaRd,patchwork,cowplot)\n\n# Loading models for SMDH and lnRR\n\nintercept_lnRR<-readRDS(here::here(\"model/intercept_lnRR.rds\"))\nintercept_SMDH<-readRDS(here::here(\"model/intercept_SMDH.rds\"))\n\n# Plot for lnRR\n\nintercept_lnRR_plot<- orchaRd::orchard_plot(intercept_lnRR,\n                                             mod = \"1\",\n                                             group = \"paper_ID\",\n                                             trunk.size = 0.3,\n                                             branch.size = 2,\n                                             twig.size = 0.5,\n                                             alpha = 0.2,\n                                             xlab = \"Effect size (lnRR)\", \n                                             fill =  T,\n                                             k.pos = c(0.53,0.6,0.6)) +\n  scale_fill_manual(values = \"#98C127\") +\n  scale_colour_manual(values = \"#98C127\" ) +\ntheme_minimal(base_size = 14) +\n  theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, size = 0.8),\n    legend.position = c(0.98, 0.05),\n    legend.justification = c(1, 0),\n    legend.direction = \"horizontal\",\n    legend.title = element_text(size = 6),\n    legend.text = element_text(size = 7),\n    axis.title = element_text(size = 10),\n    axis.text.x = element_text(size = 10),\n    axis.text.y = element_blank()\n  ) +\n  labs(x = \"Intercept\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code}\n# Plot for SMDH\nintercept_SMDH_plot <- orchaRd::orchard_plot(intercept_SMDH,\n                                    mod = \"1\",\n                                    group = \"paper_ID\",\n                                    trunk.size = 0.3,\n                                    branch.size = 2,\n                                    twig.size = 0.5,\n                                    alpha = 0.2,\n                                    xlab = \"Effect size (SMDH)\",\n                                    fill = TRUE,\n                                    k.pos = c(2,0.6,0.6)) +\n  scale_fill_manual(values = \"#F47A00\") +\n  scale_colour_manual(values = \"#F47A00\") +\n  theme_minimal(base_size = 14) +\n  theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, size = 0.8),\n    legend.position = c(0.98, 0.05),\n    legend.justification = c(1, 0), \n    legend.direction = \"horizontal\",\n    legend.title = element_text(size = 7),\n    legend.text = element_text(size = 7),\n    axis.title = element_text(size = 10),\n    axis.text.x = element_text(size = 10),\n    axis.text.y = element_blank()\n  ) +\n  labs(x = \"Intercept\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code}\n# Combine using patchwork\nFigure_intercept <- intercept_lnRR_plot / intercept_SMDH_plot +\n  plot_annotation(tag_level = c(\"A\",\"B\"))\n\nggsave(here::here(\"figures/Figure_overall_effect.png\"), plot = Figure_intercept, height = 150, width = 170, units = \"mm\", dpi = 600)\n\n###----------------------------------------------------------------------------------\n\n## Now the cropped versions presented in the main manuscript..\n\n###----------------------------------------------------------------------------------\n\n\n\nintercept_lnRR_plot_crop <- orchaRd::orchard_plot(intercept_lnRR,\n                                             mod = \"1\",\n                                             group = \"paper_ID\",\n                                             trunk.size = 0.5,\n                                             branch.size = 2,\n                                             twig.size = 0.5,\n                                             alpha = 0.2,\n                                             xlab = \"Effect size (lnRR)\", \n                                             fill =  T,\n                                             k.pos = c(0.53,0.6,0.6)) +\n  scale_fill_manual(values = \"#98C127\") +\n  scale_colour_manual(values = \"#98C127\" ) +\n    scale_y_continuous(limits = c(-0.6, 0.6)) +\ntheme_minimal(base_size = 14) +\n  theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, size = 0.8),\n    legend.position = c(0.98, 0.05),\n    legend.justification = c(1, 0),\n    legend.direction = \"horizontal\",\n    legend.title = element_text(size = 7),\n    legend.text = element_text(size = 7),\n    axis.title = element_text(size = 10),\n    axis.text.x = element_text(size = 10),\n    axis.text.y = element_blank()\n  ) +\n  labs(x = \"Intercept\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code}\n# Plot for SMDH\nintercept_SMDH_plot_crop <- orchaRd::orchard_plot(intercept_SMDH,\n                                    mod = \"1\",\n                                    group = \"paper_ID\",\n                                    trunk.size = 0.5,\n                                    branch.size = 2,\n                                    twig.size = 0.5,\n                                    alpha = 0.2,\n                                    xlab = \"Effect size (SMDH)\",\n                                    fill = TRUE,\n                                    k.pos = c(2,0.6,0.6)) +\n  scale_fill_manual(values = \"#F47A00\") +\n  scale_colour_manual(values = \"#F47A00\") +\n  scale_y_continuous(limits = c(-2.3, 2.3)) +\n  theme_minimal(base_size = 14) +\n  theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, size = 0.8),\n    legend.position = c(0.98, 0.05),\n    legend.justification = c(1, 0), \n    legend.direction = \"horizontal\",\n    legend.title = element_text(size = 7),\n    legend.text = element_text(size = 7),\n    axis.title = element_text(size = 10),\n    axis.text.x = element_text(size = 10),\n    axis.text.y = element_blank()\n  ) +\n  labs(x = \"Intercept\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code}\n# Combine using patchwork\nFigure_intercept_crop <- intercept_lnRR_plot_crop / intercept_SMDH_plot_crop +\n  plot_annotation(tag_level = c(\"A\",\"B\"))\n\nggsave(here::here(\"figures/Figure_overall_effect_crop.png\"), plot = Figure_intercept_crop, height = 150, width = 170, units = \"mm\", dpi = 600)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 23 rows containing missing values or values outside the scale range\n(`position_quasirandom()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 15 rows containing missing values or values outside the scale range\n(`position_quasirandom()`).\n```\n\n\n:::\n:::\n\n\n# Hypothesis meta-regression\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Loading models for SMDH and lnRR\n\nlnRR_hypothesis<-readRDS(here::here(\"model/lnRR_hypothesis.rds\"))\nSMDH_hypothesis<-readRDS(here::here(\"model/SMDH_hypothesis.rds\"))\n\n\n# Plot lnRR meta-regression on hypothesis\n\nlnRR_hypothesis_plot <-\n  orchard_plot(mod_results(lnRR_hypothesis,\n                           mod = \"Hypothesis\",\n                           group = \"paper_ID\"),\n               trunk.size = 0.25,\n               branch.size = 1,\n               twig.size = 0.5,\n               alpha = 0.4,\n               xlab =\"\") +\n  scale_colour_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\n  scale_fill_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\n  labs(x = \"\",\n       y = \"Effect size (lnRR)\")+\n  theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position.inside = c(0.99, 0.01),\n    legend.background = element_blank(),\n    legend.key = element_blank(),\n    legend.justification = c(1, 0), \n    legend.direction = \"horizontal\",\n    legend.title = element_text(size = 6),\n    legend.text = element_text(size = 6),\n    axis.title = element_text(size = 10),\n    axis.text.x = element_text(size = 10),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1))+ \n  scale_x_discrete(labels = c(\"Both\",\"Courtship\",\"Parental Care\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(lnRR_hypothesis, mod = \"Hypothesis\", group =\n\"paper_ID\"): It is recommended that you fit the model with an intercept.\nUnanticipated errors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code}\n# Plot SMDH meta-regression on hypothesis\n \nSMDH_hypothesis_plot <-\n  orchard_plot(\n    mod_results(\n      SMDH_hypothesis,\n      mod = \"Hypothesis\",\n      group = \"paper_ID\"\n    ),\n    trunk.size = 0.25,\n    branch.size = 1,\n    twig.size = 0.5,\n    alpha = 0.4,\n    xlab =\"\") +\n  scale_colour_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\n  scale_fill_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\n  labs(x = \"\",\n       y = \"Effect size (SMDH)\")+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position.inside = c(0.99, 0.01),\n    legend.background = element_blank(),\n    legend.key = element_blank(),\n    legend.justification = c(1, 0), \n    legend.direction = \"horizontal\",\n    legend.title = element_text(size = 6),\n    legend.text = element_text(size = 6),\n    axis.title = element_text(size = 10),\n    axis.text.x = element_text(size = 10),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1))+ \n  scale_x_discrete(labels = c(\"Both\",\"Courtship\",\"Parental Care\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(SMDH_hypothesis, mod = \"Hypothesis\", group =\n\"paper_ID\"): It is recommended that you fit the model with an intercept.\nUnanticipated errors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code}\nSMDH_hypothesis_plot <- SMDH_hypothesis_plot +\n  theme(axis.text.y  = element_blank(),\n        axis.title.y = element_blank(),\n        axis.ticks.y = element_blank())\n\n# Combine using patchwork\nFigure_hypothesis <- lnRR_hypothesis_plot + SMDH_hypothesis_plot +\n  plot_annotation(tag_level = c(\"A\",\"B\"))\n\nggsave(here::here(\"figures/Figure_hypothesis.png\"), plot = Figure_hypothesis, height = 120, width = 250, units = \"mm\", dpi = 600)\n\n\n##-----------------------------------------------------------------------------\n\n# Now the cropped figures for the main manuscript\n\n##-----------------------------------------------------------------------------\n\n\n# Plot lnRR meta-regression on hypothesis\n\nlnRR_hypothesis_plot_crop <-\n  orchard_plot(mod_results(lnRR_hypothesis,\n                           mod = \"Hypothesis\",\n                           group = \"paper_ID\"),\n               trunk.size = 0.5,\n               branch.size = 1.3,\n               twig.size = 0.5,\n               alpha = 0.4,\n               fill = T,\n               k.pos = c(0.4,0.6,0.6),\n               xlab =\"\") +\n  scale_colour_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\n  scale_fill_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\n    scale_y_continuous(limits = c(-0.6, 0.6)) +\n  labs(x = \"\",\n       y = \"Effect size (lnRR)\")+\n  theme(panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position.inside = c(0.99, 0.01),\n    legend.justification = c(1, 0), \n    legend.direction = \"horizontal\",\n    legend.background = element_blank(),\n    legend.key = element_blank(),\n    legend.title = element_text(size = 6),\n    legend.text = element_text(size = 5),\n    axis.title = element_text(size = 10),\n    axis.text.x = element_text(size = 10),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1))+ \n  scale_x_discrete(labels = c(\"Both\",\"Courtship\",\"Parental\\nCare\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(lnRR_hypothesis, mod = \"Hypothesis\", group =\n\"paper_ID\"): It is recommended that you fit the model with an intercept.\nUnanticipated errors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code}\n# Plot SMDH meta-regression on hypothesis\n \nSMDH_hypothesis_plot_crop <-\n  orchard_plot(\n    mod_results(\n      SMDH_hypothesis,\n      mod = \"Hypothesis\",\n      group = \"paper_ID\"\n    ),\n    trunk.size = 0.5,\n    branch.size = 1.3,\n    twig.size = 0.5,\n    alpha = 0.4,\n    fill = T,\n    k.pos = c(1.9,0.6,0.6),\n    xlab =\"\") +\n  scale_colour_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\n  scale_fill_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\n  scale_y_continuous(limits = c(-2.3, 2.3)) +\n  labs(x = \"\",\n       y = \"Effect size (SMDH)\")+\n  theme(panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position.inside = c(0.99, 0.01),\n    legend.justification = c(1, 0), \n    legend.direction = \"horizontal\",\n    legend.background = element_blank(),\n    legend.key = element_blank(),\n    legend.title = element_text(size = 6),\n    legend.text = element_text(size = 5),\n    axis.title = element_text(size = 10),\n    axis.text.x = element_text(size = 10),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1))+ \n  scale_x_discrete(labels = c(\"Both\",\"Courtship\",\"Parental\\nCare\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(SMDH_hypothesis, mod = \"Hypothesis\", group =\n\"paper_ID\"): It is recommended that you fit the model with an intercept.\nUnanticipated errors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code}\nSMDH_hypothesis_plot_crop <- SMDH_hypothesis_plot_crop +\n  theme(axis.text.y  = element_blank(),\n        axis.title.y = element_blank(),\n        axis.ticks.y = element_blank())\n\n# Combine using patchwork\nFigure_hypothesis_crop <- lnRR_hypothesis_plot_crop + SMDH_hypothesis_plot_crop +\n  plot_annotation(tag_level = c(\"A\",\"B\"))\n\nggsave(here::here(\"figures/Figure_hypothesis_crop.png\"), plot = Figure_hypothesis_crop, height = 120, width = 250, units = \"mm\", dpi = 600)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 23 rows containing missing values or values outside the scale range\n(`position_quasirandom()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 15 rows containing missing values or values outside the scale range\n(`position_quasirandom()`).\n```\n\n\n:::\n:::\n\n\n# Other meta-regressions\n\n# A. Combined Plot\n\n## Time of green nest material addition\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Loading models for SMDH and lnRR\n\nlnRR_time_gnm_addition<-readRDS(here::here(\"model/lnRR_time_gnm_addition.rds\"))\nSMDH_time_gnm_addition<-readRDS(here::here(\"model/SMDH_time_gnm_addition.rds\"))\n\nlnRR_time_gnm_addition_plot <-\n  orchard_plot(mod_results(\n    lnRR_time_gnm_addition,\n    mod = \"time_of_gnm_addition\",\n    group = \"paper_ID\"\n  ),\n  trunk.size = 0.5,\n  branch.size = 1.3,\n  twig.size = 0.5,\n  alpha = 0.4,\n  fill = T,\n  k.pos = c(0.4,0.6,0.6),\n  xlab =\"\") +\n  scale_colour_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\n  scale_fill_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\n  labs(x = \"\",\n       y = \"Effect Size (lnRR)\")+\n  theme(panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n        legend.position.inside = c(0.99, 0.01),\n        legend.justification = c(1, 0), \n        legend.direction = \"horizontal\",\n        legend.background = element_blank(),\n        legend.key = element_blank(),\n        legend.title = element_text(size = 6),\n        legend.text = element_text(size = 6),\n        axis.title = element_text(size = 10),\n        axis.text.x = element_text(size = 10),\n        axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1)\n  ) + scale_x_discrete(labels = c(\"After egg\\nlaying\", \"Before egg\\nlaying\", \"Continous\\naddition\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(lnRR_time_gnm_addition, mod = \"time_of_gnm_addition\", :\nIt is recommended that you fit the model with an intercept. Unanticipated\nerrors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code}\nSMDH_time_gnm_addition_plot <-\n  orchard_plot(mod_results(\n    SMDH_time_gnm_addition,\n    mod = \"time_of_gnm_addition\",\n    group = \"paper_ID\"\n  ),\n  trunk.size = 0.5,\n  branch.size = 1.3,\n  twig.size = 0.5,\n  alpha = 0.4,\n  fill = T,\n  k.pos = c(0.4,0.6,0.6),\n  xlab =\"\") +\n  scale_colour_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\n  scale_fill_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\"))+\n  labs(x = \"\",\n       y = \"Effect Size (SMDH)\")+\n  theme(panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n        legend.position.inside = c(0.99, 0.01),\n        legend.justification = c(1, 0), \n        legend.direction = \"horizontal\",\n        legend.background = element_blank(),\n        legend.key = element_blank(),\n        legend.title = element_text(size = 6),\n        legend.text = element_text(size = 6),\n        axis.title = element_text(size = 10),\n        axis.text.x = element_text(size = 10),\n        axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1)\n  ) + scale_x_discrete(labels = c(\"After egg\\nlaying\", \"Before egg\\nlaying\", \"Continous\\naddition\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(SMDH_time_gnm_addition, mod = \"time_of_gnm_addition\", :\nIt is recommended that you fit the model with an intercept. Unanticipated\nerrors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code}\n##-----------------------------------------------------------------------------\n\n# Now the cropped figures for the main manuscript\n\n##-----------------------------------------------------------------------------\n\nlnRR_time_gnm_addition_plot_cropped <-\n  orchard_plot(mod_results(\n    lnRR_time_gnm_addition,\n    mod = \"time_of_gnm_addition\",\n    group = \"paper_ID\"\n  ),\n  trunk.size = 0.5,\n  branch.size = 1.3,\n  twig.size = 0.5,\n  alpha = 0.4,\n  fill = T,\n  k.pos = c(0.4,0.6,0.6),\n  xlab =\"\") +\n  scale_colour_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\n  scale_fill_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\n  scale_y_continuous(limits = c(-0.6, 0.6)) +\n  labs(x = \"\",\n       y = \"Effect Size (lnRR)\")+\n  theme(panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n        legend.position.inside = c(0.99, 0.01),\n        legend.justification = c(1, 0), \n        legend.direction = \"horizontal\",\n        legend.background = element_blank(),\n        legend.key = element_blank(),\n        legend.title = element_text(size = 6),\n        legend.text = element_text(size = 6),\n        axis.title = element_text(size = 10),\n        axis.text.x = element_text(size = 10),\n        axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1)\n  ) + scale_x_discrete(labels = c(\"After egg\\nlaying\", \"Before egg\\nlaying\", \"Continous\\naddition\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(lnRR_time_gnm_addition, mod = \"time_of_gnm_addition\", :\nIt is recommended that you fit the model with an intercept. Unanticipated\nerrors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code}\nSMDH_time_gnm_addition_plot_cropped <-\n  orchard_plot(mod_results(\n      SMDH_time_gnm_addition,\n      mod = \"time_of_gnm_addition\",\n      group = \"paper_ID\"\n    ),\n  trunk.size = 0.5,\n  branch.size = 1.3,\n  twig.size = 0.5,\n  alpha = 0.4,\n  fill = T,\n    k.pos = c(1.9,0.6,0.6),\n  xlab =\"\") +\n  scale_colour_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\n  scale_fill_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\n  scale_y_continuous(limits = c(-2.3, 2.3)) +\nlabs(x = \"\",\n     y = \"Effect Size (SMDH)\")+\n  theme(panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position.inside = c(0.99, 0.01),\n    legend.justification = c(1, 0), \n    legend.direction = \"horizontal\",\n    legend.background = element_blank(),\n    legend.key = element_blank(),\n    legend.title = element_text(size = 6),\n    legend.text = element_text(size = 6),\n    axis.title = element_text(size = 10),\n    axis.text.x = element_text(size = 10),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1)\n  ) + scale_x_discrete(labels = c(\"After egg\\nlaying\", \"Before egg\\nlaying\", \"Continous\\naddition\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(SMDH_time_gnm_addition, mod = \"time_of_gnm_addition\", :\nIt is recommended that you fit the model with an intercept. Unanticipated\nerrors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n:::\n\n\n## Experimental Design\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Loading models for SMDH and lnRR\n\nlnRR_design<-readRDS(here::here(\"model/lnRR_design.rds\"))\nSMDH_design<-readRDS(here::here(\"model/SMDH_design.rds\"))\n\nlnRR_design_plot <-\n  orchard_plot(mod_results(\n      lnRR_design,\n      mod = \"comparision_type\",\n      group = \"paper_ID\"\n    ),\n  trunk.size = 0.5,\n  branch.size = 1.3,\n  twig.size = 0.5,\n  alpha = 0.4,\n  fill = T,\n  k.pos = c(1,0.6,0.6),\n  xlab =\"\") +\n  scale_colour_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\n  scale_fill_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\nlabs(x = \"\",\n     y = \"Effect Size (lnRR)\")+\n  theme(panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position.inside = c(0.99, 0.01),\n    legend.justification = c(1, 0), \n    legend.direction = \"horizontal\",\n    legend.background = element_blank(),\n    legend.key = element_blank(),\n    legend.title = element_text(size = 6),\n    legend.text = element_text(size = 6),\n    axis.title = element_text(size = 10),\n    axis.text.x = element_text(size = 10),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1))+ \n  scale_x_discrete(labels = c(\"Non-aromatic\\nVs. Aromatic\",\"No material\\nVs. Aromatic\", \"No material\\nVs. Non-Aromatic\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(lnRR_design, mod = \"comparision_type\", group =\n\"paper_ID\"): It is recommended that you fit the model with an intercept.\nUnanticipated errors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code}\nSMDH_design_plot <-\n  orchard_plot(mod_results(\n      SMDH_design,\n      mod = \"comparision_type\",\n      group = \"paper_ID\"\n    ),\n  trunk.size = 0.5,\n  branch.size = 1.3,\n  twig.size = 0.5,\n  alpha = 0.4,\n  fill = T,\n  k.pos = c(1.5,0.6,0.6),\n  xlab =\"\") +\n  scale_colour_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\n  scale_fill_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\"))+\nlabs(x = \"\",\n     y = \"Effect Size (SMDH)\")+\n  theme(panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position.inside = c(0.99, 0.01),\n    legend.justification = c(1, 0), \n    legend.direction = \"horizontal\",\n    legend.background = element_blank(),\n    legend.key = element_blank(),\n    legend.title = element_text(size = 6),\n    legend.text = element_text(size = 6),\n    axis.title = element_text(size = 10),\n    axis.text.x = element_text(size = 10),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1))+ \n  scale_x_discrete(labels = c(\"Non-aromatic\\nVs. Aromatic\",\"No material\\nVs. Aromatic\", \"No material\\nVs. Non-Aromatic\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(SMDH_design, mod = \"comparision_type\", group =\n\"paper_ID\"): It is recommended that you fit the model with an intercept.\nUnanticipated errors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code}\n##-----------------------------------------------------------------------------\n\n# Now the cropped figures for the main manuscript\n\n##-----------------------------------------------------------------------------\n\nlnRR_design_plot_cropped <-\n  orchard_plot(mod_results(\n      lnRR_design,\n      mod = \"comparision_type\",\n      group = \"paper_ID\"\n    ),\n  trunk.size = 0.5,\n  branch.size = 1.3,\n  twig.size = 0.5,\n  alpha = 0.4,\n  fill = T,\n  k.pos = c(0.4,0.6,0.6),\n  xlab =\"\") +\n  scale_colour_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\n  scale_fill_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\n  scale_y_continuous(limits = c(-0.6, 0.6)) +\nlabs(x = \"\",\n     y = \"Effect Size (lnRR)\")+\n  theme(panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position.inside = c(0.99, 0.01),\n    legend.justification = c(1, 0), \n    legend.direction = \"horizontal\",\n    legend.background = element_blank(),\n    legend.key = element_blank(),\n    legend.title = element_text(size = 6),\n    legend.text = element_text(size = 6),\n    axis.title = element_text(size = 10),\n    axis.text.x = element_text(size = 10),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1))+ \n  scale_x_discrete(labels = c(\"Non-aromatic\\nVs. Aromatic\",\"No material\\nVs. Aromatic\", \"No material\\nVs. Non-Aromatic\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(lnRR_design, mod = \"comparision_type\", group =\n\"paper_ID\"): It is recommended that you fit the model with an intercept.\nUnanticipated errors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code}\nSMDH_design_plot_cropped <-\n  orchard_plot(mod_results(\n      SMDH_design,\n      mod = \"comparision_type\",\n      group = \"paper_ID\"\n    ),\n   trunk.size = 0.5,\n  branch.size = 1.3,\n  twig.size = 0.5,\n  alpha = 0.4,\n  fill = T,\n    k.pos = c(1.9,0.6,0.6),\n  xlab =\"\") +\n  scale_colour_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\n  scale_fill_manual(values = c(\"#FF8CAE\", \"#003A7D\", \"#7E4794\")) +\n  scale_y_continuous(limits = c(-2.3, 2.3)) +\nlabs(x = \"\",\n     y = \"Effect Size (SMDH)\")+\n  theme(panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position.inside = c(0.99, 0.01),\n    legend.justification = c(1, 0), \n    legend.direction = \"horizontal\",\n    legend.background = element_blank(),\n    legend.key = element_blank(),\n    legend.title = element_text(size = 6),\n    legend.text = element_text(size = 6),\n    axis.title = element_text(size = 10),\n    axis.text.x = element_text(size = 10),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1))+ \n  scale_x_discrete(labels = c(\"Non-aromatic\\nVs. Aromatic\",\"No material\\nVs. Aromatic\", \"No material\\nVs. Non-Aromatic\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(SMDH_design, mod = \"comparision_type\", group =\n\"paper_ID\"): It is recommended that you fit the model with an intercept.\nUnanticipated errors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n:::\n\n\n### Now we combine these plots\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## I am going to remove the y ticks from the SMDH plots to make it smaller..\nSMDH_design_plot <- SMDH_design_plot +\n  theme(axis.text.y  = element_blank(),\n        axis.title.y = element_blank(),\n        axis.ticks.y = element_blank())\n\nSMDH_time_gnm_addition_plot <- SMDH_time_gnm_addition_plot +\n  theme(axis.text.y  = element_blank(),\n        axis.title.y = element_blank(),\n        axis.ticks.y = element_blank())\n\n# Combine using patchwork\nFigure_design_time_gnm_addition<- ((lnRR_design_plot + SMDH_design_plot) /\n                               (lnRR_time_gnm_addition_plot + SMDH_time_gnm_addition_plot)) +\n  plot_annotation(tag_levels = \"A\")\n\nggsave(here::here(\"figures/Figure_design_time_gnm_addition.png\"), plot = Figure_design_time_gnm_addition, height = 240, width = 250, units = \"mm\", dpi = 600)\n\n##-----------------------------------------------------------------------------\n\n# Now the cropped figures for the main manuscript\n\n##-----------------------------------------------------------------------------\n\n\n## I am going to remove the y ticks from the SMDH plots to make it smaller..\nSMDH_design_plot_cropped <- SMDH_design_plot_cropped +\n  theme(axis.text.y  = element_blank(),\n        axis.title.y = element_blank(),\n        axis.ticks.y = element_blank())\n\nSMDH_time_gnm_addition_plot_cropped <- SMDH_time_gnm_addition_plot_cropped +\n  theme(axis.text.y  = element_blank(),\n        axis.title.y = element_blank(),\n        axis.ticks.y = element_blank())\n\n# Combine using patchwork\nFigure_design_time_gnm_addition_cropped <- ((lnRR_design_plot_cropped + SMDH_design_plot_cropped) /\n                               (lnRR_time_gnm_addition_plot_cropped + SMDH_time_gnm_addition_plot_cropped)) +\n  plot_annotation(tag_levels = \"A\")\n\nggsave(here::here(\"figures/Figure_design_time_gnm_addition_cropped.png\"), plot = Figure_design_time_gnm_addition_cropped, height = 240, width = 250, units = \"mm\", dpi = 600)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 22 rows containing missing values or values outside the scale range\n(`position_quasirandom()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 1 row containing missing values or values outside the scale range\n(`geom_segment()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 15 rows containing missing values or values outside the scale range\n(`position_quasirandom()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 23 rows containing missing values or values outside the scale range\n(`position_quasirandom()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 15 rows containing missing values or values outside the scale range\n(`position_quasirandom()`).\n```\n\n\n:::\n:::\n\n\n# B. Combined Plot\n\n## Parasite Type\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Loading models for SMDH and lnRR\n\nlnRR_parasite<-readRDS(here::here(\"model/lnRR_parasite.rds\"))\nSMDH_parasite<-readRDS(here::here(\"model/SMDH_parasite.rds\"))\n\nlnRR_parasite_plot <-\n  orchard_plot(mod_results(\n      lnRR_parasite,\n      mod = \"parasite_type\",\n      group = \"paper_ID\"\n    ),\n    trunk.size = 0.25,\n    branch.size = 1,\n    twig.size = 0.5,\n    alpha = 0.2,\n    xlab =\"\") +\n  scale_colour_manual(values = c(\"#FF8CAE\", \"#003A7D\")) +\n  scale_fill_manual(values = c(\"#FF8CAE\", \"#003A7D\")) +\n  labs(x = \"\",\n       y = \"lnRR\")+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position = \"none\",\n    # legend.position.inside = c(0.98, 0.05),\n    # legend.justification = c(1, 0), \n    # legend.direction = \"horizontal\",\n    legend.title = element_text(size = 6),\n    legend.text = element_text(size = 6),\n    axis.title = element_text(size = 10),\n    axis.text.x = element_text(size = 10),\n    axis.text.y = element_text(size =6,angle = 0, vjust = 0.5, hjust = 1)\n  )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(lnRR_parasite, mod = \"parasite_type\", group =\n\"paper_ID\"): It is recommended that you fit the model with an intercept.\nUnanticipated errors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code}\nSMDH_parasite_plot <-\n  orchard_plot(mod_results(\n      SMDH_parasite,\n      mod = \"parasite_type\",\n      group = \"paper_ID\"\n    ),\n    trunk.size = 0.25,\n    branch.size = 1,\n    twig.size = 0.5,\n    alpha = 0.2,\n    xlab =\"\") +\n  scale_colour_manual(values = c(\"#FF8CAE\", \"#003A7D\")) +\n  scale_fill_manual(values = c(\"#FF8CAE\", \"#003A7D\")) +\n  labs(x = \"\",\n       y = \"SMD(H)\")+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position = \"none\",\n    # legend.position.inside = c(0.98, 0.05),\n    # legend.justification = c(1, 0), \n    # legend.direction = \"horizontal\",\n    legend.title = element_text(size = 6),\n    legend.text = element_text(size = 6),\n    axis.title = element_text(size = 10),\n    axis.text.x = element_text(size = 10),\n    axis.text.y = element_text(size =6,angle = 0, vjust = 0.5, hjust = 1)\n  )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(SMDH_parasite, mod = \"parasite_type\", group =\n\"paper_ID\"): It is recommended that you fit the model with an intercept.\nUnanticipated errors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n:::\n\n\n## Bird Species\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Loading models for SMDH and lnRR\n\nlnRR_birds<-readRDS(here::here(\"model/lnRR_birds.rds\"))\nSMDH_birds<-readRDS(here::here(\"model/SMDH_birds.rds\"))\n\nlnRR_birds_plot <-\n  orchard_plot(mod_results(\n      lnRR_birds,\n      mod = \"bird_species\",\n      group = \"paper_ID\"\n    ),\n    trunk.size = 0.25,\n    branch.size = 1,\n    twig.size = 0.5,\n    alpha = 0.2,\n    xlab =\"\") +\n  scale_colour_manual(values =  c(\"#00B0BE\",\"#FFB255\",  \"#FF8CAE\", \n                                 \"#F47A00\", \"#98C127\",\"#003A7D\",\"#7E4794\")) +\n  scale_fill_manual(values =  c(\"#00B0BE\",\"#FFB255\",  \"#FF8CAE\", \n                                 \"#F47A00\", \"#98C127\",\"#003A7D\",\"#7E4794\")) +\n  labs(x = \"\",\n       y = \"lnRR\")+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position = \"none\",\n    # legend.position.inside = c(0.98, 0.05),\n    # legend.justification = c(1, 0), \n    # legend.direction = \"horizontal\",\n    legend.title = element_text(size = 6),\n    legend.text = element_text(size = 6),\n    axis.title = element_text(size = 10),\n    axis.text.x = element_text(size = 10),\n    axis.text.y = element_text(size =6,angle = 0, vjust = 0.5, hjust = 1)\n  )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(lnRR_birds, mod = \"bird_species\", group = \"paper_ID\"):\nIt is recommended that you fit the model with an intercept. Unanticipated\nerrors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code}\nSMDH_birds_plot <-\n  orchard_plot(mod_results(\n      SMDH_birds,\n      mod = \"bird_species\",\n      group = \"paper_ID\"\n    ),\n    trunk.size = 0.25,\n    branch.size = 1,\n    twig.size = 0.5,\n    alpha = 0.2,\n    xlab =\"\") +\n  scale_colour_manual(values =  c(\"#00B0BE\",\"#FFB255\",  \"#FF8CAE\", \n                                 \"#F47A00\", \"#98C127\",\"#003A7D\",\"#7E4794\")) +\n  scale_fill_manual(values =  c(\"#00B0BE\",\"#FFB255\",  \"#FF8CAE\", \n                                 \"#F47A00\", \"#98C127\",\"#003A7D\",\"#7E4794\")) +\n  labs(x = \"\",\n       y = \"SMD(H)\")+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position = \"none\",\n    # legend.position.inside = c(0.98, 0.05),\n    # legend.justification = c(1, 0), \n    # legend.direction = \"horizontal\",\n    legend.title = element_text(size = 6),\n    legend.text = element_text(size = 6),\n    axis.title = element_text(size = 10),\n    axis.text.x = element_text(size = 10),\n    axis.text.y = element_text(size =6,angle = 0, vjust = 0.5, hjust = 1)\n  )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(SMDH_birds, mod = \"bird_species\", group = \"paper_ID\"):\nIt is recommended that you fit the model with an intercept. Unanticipated\nerrors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n:::\n\n\n## Trait studied\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Loading models for SMDH and lnRR\n\nlnRR_trait<-readRDS(here::here(\"model/lnRR_trait.rds\"))\nSMDH_trait<-readRDS(here::here(\"model/SMDH_trait.rds\"))\n\nlnRR_trait_plot <-\n  orchard_plot(mod_results(\n      lnRR_trait,\n      mod = \"trait_type\",\n      group = \"paper_ID\"\n    ),\n    trunk.size = 0.25,\n    branch.size = 1,\n    twig.size = 0.5,\n    alpha = 0.2,\n    xlab =\"\") +\n  scale_colour_manual(values =  c(\"#00B0BE\",\"#FFB255\",  \"#FF8CAE\", \n                                 \"#F47A00\", \"#98C127\",\"#003A7D\",\"#7E4794\")) +\n  scale_fill_manual(values =  c(\"#00B0BE\",\"#FFB255\",  \"#FF8CAE\", \n                                 \"#F47A00\", \"#98C127\",\"#003A7D\",\"#7E4794\")) +\n  labs(x = \"\",\n       y = \"lnRR\")+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position = \"none\",\n    # legend.position.inside = c(0.98, 0.05),\n    # legend.justification = c(1, 0), \n    # legend.direction = \"horizontal\",\n    legend.title = element_text(size = 6),\n    legend.text = element_text(size = 6),\n    axis.title = element_text(size = 10),\n    axis.text.x = element_text(size = 10),\n    axis.text.y = element_text(size =6,angle = 0, vjust = 0.5, hjust = 1)\n  )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(lnRR_trait, mod = \"trait_type\", group = \"paper_ID\"): It\nis recommended that you fit the model with an intercept. Unanticipated errors\ncan occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code}\nSMDH_trait_plot <-\n  orchard_plot(mod_results(\n      SMDH_trait,\n      mod = \"trait_type\",\n      group = \"paper_ID\"\n    ),\n    trunk.size = 0.25,\n    branch.size = 1,\n    twig.size = 0.5,\n    alpha = 0.2,\n    xlab =\"\") +\n  scale_colour_manual(values =  c(\"#00B0BE\",\"#FFB255\",  \"#FF8CAE\", \n                                 \"#F47A00\", \"#98C127\",\"#003A7D\",\"#7E4794\")) +\n  scale_fill_manual(values =  c(\"#00B0BE\",\"#FFB255\",  \"#FF8CAE\", \n                                 \"#F47A00\", \"#98C127\",\"#003A7D\",\"#7E4794\")) +\n  labs(x = \"\",\n       y = \"SMD(H)\")+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position = \"none\",\n    # legend.position.inside = c(0.98, 0.05),\n    # legend.justification = c(1, 0), \n    # legend.direction = \"horizontal\",\n    legend.title = element_text(size = 6),\n    legend.text = element_text(size = 6),\n    axis.title = element_text(size = 10),\n    axis.text.x = element_text(size = 10),\n    axis.text.y = element_text(size =6, angle = 0, vjust = 0.5, hjust = 1)\n  )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(SMDH_trait, mod = \"trait_type\", group = \"paper_ID\"): It\nis recommended that you fit the model with an intercept. Unanticipated errors\ncan occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n:::\n\n\n### Now we combine these plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## I am going to remove the y ticks from the SMDH plots to make it smaller..\nSMDH_parasite_plot <- SMDH_parasite_plot +\n  theme(axis.text.y  = element_blank(),\n        axis.title.y = element_blank(),\n        axis.ticks.y = element_blank())\n\nSMDH_birds_plot <- SMDH_birds_plot +\n  theme(axis.text.y  = element_blank(),\n        axis.title.y = element_blank(),\n        axis.ticks.y = element_blank())\n\nSMDH_trait_plot <- SMDH_trait_plot +\n  theme(axis.text.y  = element_blank(),\n        axis.title.y = element_blank(),\n        axis.ticks.y = element_blank())\n\n# Combine using patchwork\nFigure_parasite_birds_trait <- ((lnRR_parasite_plot + SMDH_parasite_plot) / \n                                  (lnRR_birds_plot + SMDH_birds_plot) / \n                                  (lnRR_trait_plot + SMDH_trait_plot)) +\n  plot_annotation(tag_levels = \"A\")\n\nggsave(here::here(\"figures/Figure_parasite_birds_trait.png\"), plot = Figure_parasite_birds_trait, height = 250, width = 400, units = \"mm\", dpi = 600)\n```\n:::\n\n\n# Publication Bias Tests\n\n\n::: {.cell}\n\n```{.r .cell-code}\n###---Small study Effects ----###\n\nlnRR_small_study<-readRDS(here::here(\"model/lnRR_small_study.rds\"))\nSMDH_small_study<-readRDS(here::here(\"model/SMDH_small_study.rds\"))\n\n\nlnRR_small_study_bubble<-orchaRd::bubble_plot(mod_results(lnRR_small_study,\n                     mod=\"sqrt_effective_n_inv\",\n                     group=\"paper_ID\",\n                     weights=\"prop\"),\n                     group=\"paper_ID\") +\n  scale_colour_manual(values =\"mediumpurple4\") +\n  scale_fill_manual(values = \"mediumpurple4\") +\n  labs(y = \"Effect size (lnRR)\",\n       x = expression(sqrt(1 / N[effective])))+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 10),\n    axis.title = element_text(size = 14),\n    axis.text.x = element_text(size = 14),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code}\nSMDH_small_study_bubble<-orchaRd::bubble_plot(mod_results(SMDH_small_study,\n                     mod=\"sqrt_effective_n_inv\",\n                     group=\"paper_ID\",\n                     weights=\"prop\"),\n                     group=\"paper_ID\") +\n  scale_colour_manual(values =\"mediumpurple4\") +\n  scale_fill_manual(values = \"mediumpurple4\") +\n  labs(y = \"Effect size (SMDH)\",\n       x = expression(sqrt(1 / N[effective])))+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 10),\n    axis.title = element_text(size = 14),\n    axis.text.x = element_text(size = 14),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code}\n###---Decline Effects ----###\n\nlnRR_decline_eff<-readRDS(here::here(\"model/lnRR_decline_eff.rds\"))\nSMDH_decline_eff<-readRDS(here::here(\"model/SMDH_decline_eff.rds\"))\n\n\nlnRR_decline_eff_bubble<-orchaRd::bubble_plot(mod_results(lnRR_decline_eff,\n                     mod=\"year_MeanCenter\",\n                     group=\"paper_ID\",\n                     weights=\"prop\"),\n                     group=\"paper_ID\")+\n  scale_colour_manual(values =\"#218833\") +\n  scale_fill_manual(values = \"#218833\") +\n  labs(y = \"Effect size (lnRR)\",\n       x = \"Publication Year (Mean Cenetered)\")+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 10),\n    axis.title = element_text(size = 14),\n    axis.text.x = element_text(size = 14),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code}\nSMDH_decline_effect_bubble<-orchaRd::bubble_plot(mod_results(SMDH_decline_eff,\n                     mod=\"year_MeanCenter\",\n                     group=\"paper_ID\",\n                     weights=\"prop\"),\n                     group=\"paper_ID\")+\n  scale_colour_manual(values =\"#218833\") +\n  scale_fill_manual(values = \"#218833\") +\n  labs(y = \"Effect size (SMDH)\",\n       x = \"Publication Year (Mean Cenetered)\")+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 10),\n    axis.title = element_text(size = 14),\n    axis.text.x = element_text(size = 14),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code}\n# Combine using patchwork\nFigure_publication_bias <- ((lnRR_small_study_bubble + SMDH_small_study_bubble) /\n                               (lnRR_decline_eff_bubble + SMDH_decline_effect_bubble)) +\n  plot_annotation(tag_levels = \"A\")\n\nggsave(here::here(\"figures/Figure_publication_bias.png\"), plot = Figure_publication_bias, height = 300, width = 400, units = \"mm\", dpi = 600)\n```\n:::\n\n\n# -------- Supplementary Material Table ----------\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Loading packages\n\npacman::p_load(gt,dplyr,metafor)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmerged_data_extraction <- read_csv(here::here(\"data/03_data_cleaning/merged_data_extraction.csv\"), show_col_types = F)\n\ndataset_analysis <- read_csv(here::here(\"data/04_data_analysis/dataset_analysis.csv\"), show_col_types = F)\n\nexcluded_proxies<- merged_data_extraction %>%\n  filter(fulltext_screening == \"included\") %>%\n  filter(proxy_decision== \"exclude\")%>%\n  select(paper_ID, fitness_proxy, proxy_comment) %>%\n  distinct() %>%\n  group_by(paper_ID) %>%\n  summarise(\n    `Number of proxies` = n(),\n    `Excluded Proxies` = paste(fitness_proxy, collapse = \", \"),\n    `Reason for Exclusion`= paste(proxy_comment,  collapse = \"; \"),\n    .groups = \"drop\")\n\nSA_only_proxies <- dataset_analysis %>%\n  filter(proxy_decision == \"sensitivity-analysis\")%>%\n  select(paper_ID, fitness_proxy, proxy_comment) %>%\n  distinct() %>%\n  group_by(paper_ID) %>%\n  summarise(\n    `Number of proxies` = n(),\n    `Excluded Proxies` = paste(fitness_proxy, collapse = \", \"),\n    `Reason for Exclusion`= paste(proxy_comment,  collapse = \"; \"),\n    .groups = \"drop\")\n\n\n\n# Now binding them together\ncombined_summary <- bind_rows(\n  excluded_proxies %>% mutate(Category = \"Completely excluded\"),\n  SA_only_proxies   %>% mutate(Category = \"Sensitivity-analysis only\")\n) %>%\n  arrange(Category, paper_ID)\n\n# Group by category\nexcluded_proxies <-combined_summary %>%\n  gt() %>%\n  tab_header(\n    title = md(\"**Excluded Fitness Proxies**\")\n  ) %>%\n  # define row-groups\n  tab_row_group(\n    group    = \"Completely excluded\",\n    rows     = Category == \"Completely excluded\"\n  ) %>%\n  tab_row_group(\n    group    = \"Sensitivity-analysis only\",\n    rows     = Category == \"Sensitivity-analysis only\"\n  ) %>%\n  # hide the helper column\n  cols_hide(\"Category\") %>%\n  # relabel columns\n  cols_label(\n         `paper_ID`             = \"Paper ID\",\n         `Number of proxies`    = \"Noumber\\nof Proxies\",\n         `Excluded Proxies`     = \"Excluded\\nProxies\",\n         `Reason for Exclusion` = \"Reason for Exclusion\"\n  ) %>%\n  fmt_markdown(columns = c(`Excluded Proxies`, `Reason for Exclusion`)) %>%\n  opt_align_table_header(align = \"left\") %>%\n  cols_align(\n    align   = \"left\",\n    columns = everything()\n  ) %>%\n  tab_options(\n    table.width               = pct(90),\n    row.striping.background_color = \"#F7F7F7\"\n  )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Since gt v0.3.0 the `group` argument has been deprecated.\n• Use the `label` argument to specify the group label.\nThis warning is displayed once every 8 hours.\n```\n\n\n:::\n\n```{.r .cell-code}\n# gtsave(\n#   data = excluded_proxies,\n#   filename = here::here(\"/tables/excluded_proxies_table.pdf\"),\n#   expand = 10   # adds a little padding around the table\n# )\n```\n:::\n\n\n## Table: Sensitivity analysis for intercept only model\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Loading the models including only published data\nSA_lnRR_published<-readRDS(here::here(\"model/sensitivity_analysis/SA_lnRR_published.rds\"))\nSA_SMDH_published<-readRDS(here::here(\"model/sensitivity_analysis/SA_SMDH_published.rds\"))\n\n# Loading the models without Comparison Type 3\nSA_lnRR_no_comp3<-readRDS(here::here(\"model/sensitivity_analysis/SA_lnRR_no_comp3.rds\"))\nSA_SMDH_no_comp3<-readRDS(here::here(\"model/sensitivity_analysis/SA_SMDH_no_comp3.rds\"))\n\n# Loading the models including flagged proxies\nSA_lnRR_flagged<-readRDS(here::here(\"model/sensitivity_analysis/SA_lnRR_flagged.rds\"))\nSA_SMDH_flagged<-readRDS(here::here(\"model/sensitivity_analysis/SA_SMDH_flagged.rds\"))\n\n# Loading the models without data for those using 0 as ES because authors reported no effect\nSA_lnRR_no_missingES<-readRDS(here::here(\"model/sensitivity_analysis/SA_lnRR_no_missingES.rds\"))\nSA_SMDH_no_missingES<-readRDS(here::here(\"model/sensitivity_analysis/SA_SMDH_no_missingES.rds\"))\n\n# Loading the models without data for those using 0 as ES because authors reported no effect and including flagged proxies\nSA_lnRR_flagged_no_missingES<-readRDS(here::here(\"model/sensitivity_analysis/SA_lnRR_flagged_no_missingES.rds\"))\nSA_SMDH_flagged_no_missingES<-readRDS(here::here(\"model/sensitivity_analysis/SA_SMDH_flagged_no_missingES.rds\"))\n\n# Loading the model for SMDH without inferential statistics. There is none for lnRR because we can only uses means and deviation to estimate lnRR\nSA_SMDH_no_inferential<-readRDS(here::here(\"model/sensitivity_analysis/SA_SMDH_no_inferential.rds\"))\n\n# Loading the model for Geary's Test Passed. There is none for SMDH because we do not know the guideline for SMDH and Geary's Test\nSA_lnRR_geary_passed<-readRDS(here::here(\"model/sensitivity_analysis/SA_lnRR_geary_passed.rds\"))\n\n# Now let's build the table\n\nSA_intercept_only <- tibble::tibble(\n  effect_size = c(\"lnRR\",\"lnRR\",\"lnRR\",\"lnRR\",\"lnRR\",\"lnRR\",\n                  \"SMD(H)\",\"SMD(H)\",\"SMD(H)\",\"SMD(H)\",\"SMD(H)\",\"SMDH\"),\n  data_used = c(\"Including published data only\",\"Excluding Experimental Design Non-Aromatic Vs. No added material\",\"Including flagged proxies\", \"Without those cases where author reported no effect of the treatment\", \"Including flagged proxies and without the cases with no effect of the treatment\", \"Excluding effect sizes where lnRR failed Geary's Test\",\"Including published data only\",\"Excluding Experimental Design Non-Aromatic Vs. No added material\", \"Including flagged proxies\", \"Without those cases where author reported no effect of the treatment\", \"Including flagged proxies and without the cases with no effect of the treatment\", \"Without the cases where SMDH was calculated from inferential statistics\"),\n  \n  Estimate = c(SA_lnRR_published$b[1],\n               SA_lnRR_no_comp3$b[1],\n               SA_lnRR_flagged$b[1],\n               SA_lnRR_no_missingES$b[1],\n               SA_lnRR_flagged_no_missingES$b[1],\n               SA_lnRR_geary_passed$b[1],\n               SA_SMDH_published$b[1],\n               SA_SMDH_no_comp3$b[1],\n               SA_SMDH_flagged$b[1],\n               SA_SMDH_no_missingES$b[1],\n               SA_SMDH_flagged_no_missingES$b[1],\n               SA_SMDH_no_inferential$b[1]),\n\n  CI_Lower = c(SA_lnRR_published$ci.lb,\n               SA_lnRR_no_comp3$ci.lb,\n               SA_lnRR_flagged$ci.lb,\n               SA_lnRR_no_missingES$ci.lb,\n               SA_lnRR_flagged_no_missingES$ci.lb,\n               SA_lnRR_geary_passed$ci.lb,\n               SA_SMDH_published$ci.lb,\n               SA_SMDH_no_comp3$ci.lb,\n               SA_SMDH_flagged$ci.lb,\n               SA_SMDH_no_missingES$ci.lb,\n               SA_SMDH_flagged_no_missingES$ci.lb,\n               SA_SMDH_no_inferential$ci.lb),\n\n  CI_Upper = c(SA_lnRR_published$ci.ub,\n               SA_lnRR_no_comp3$ci.ub,\n               SA_lnRR_flagged$ci.ub,\n               SA_lnRR_no_missingES$ci.ub,\n               SA_lnRR_flagged_no_missingES$ci.ub,\n               SA_lnRR_geary_passed$ci.ub,\n               SA_SMDH_published$ci.ub,\n               SA_SMDH_no_comp3$ci.ub,\n               SA_SMDH_flagged$ci.ub,\n               SA_SMDH_no_missingES$ci.ub,\n               SA_SMDH_flagged_no_missingES$ci.ub,\n               SA_SMDH_no_inferential$ci.ub),\n  \n  PI_Lower = c(predict(SA_lnRR_published)$pi.lb,\n               predict(SA_lnRR_no_comp3)$pi.lb,\n               predict(SA_lnRR_flagged)$pi.lb,\n               predict(SA_lnRR_no_missingES)$pi.lb,\n               predict(SA_lnRR_flagged_no_missingES)$pi.lb,\n               predict(SA_lnRR_geary_passed)$pi.lb,\n               predict(SA_SMDH_published)$pi.lb,\n               predict(SA_SMDH_no_comp3)$pi.lb,\n               predict(SA_SMDH_flagged)$pi.lb,\n               predict(SA_SMDH_no_missingES)$pi.lb,\n               predict(SA_SMDH_flagged_no_missingES)$pi.lb,\n               predict(SA_SMDH_no_inferential)$pi.lb),\n\n  PI_Upper = c(predict(SA_lnRR_published)$pi.ub,\n               predict(SA_lnRR_no_comp3)$pi.ub,\n               predict(SA_lnRR_flagged)$pi.ub,\n               predict(SA_lnRR_no_missingES)$pi.ub,\n               predict(SA_lnRR_flagged_no_missingES)$pi.ub,\n               predict(SA_lnRR_geary_passed)$pi.ub,\n               predict(SA_SMDH_published)$pi.ub,\n               predict(SA_SMDH_no_comp3)$pi.ub,\n               predict(SA_SMDH_flagged)$pi.ub,\n               predict(SA_SMDH_no_missingES)$pi.ub,\n               predict(SA_SMDH_flagged_no_missingES)$pi.ub,\n               predict(SA_SMDH_no_inferential)$pi.ub),\n\n  P_value =  c(SA_lnRR_published$pval,\n               SA_lnRR_no_comp3$pval,\n               SA_lnRR_flagged$pval,\n               SA_lnRR_no_missingES$pval,\n               SA_lnRR_flagged_no_missingES$pval,\n               SA_lnRR_geary_passed$pval,\n               SA_SMDH_published$pval,\n               SA_SMDH_no_comp3$pval,\n               SA_SMDH_flagged$pval,\n               SA_SMDH_no_missingES$pval,\n               SA_SMDH_flagged_no_missingES$pval,\n               SA_SMDH_no_inferential$pval),\n\n  Q_value = c(SA_lnRR_published$QE,\n               SA_lnRR_no_comp3$QE,\n               SA_lnRR_flagged$QE,\n               SA_lnRR_no_missingES$QE,\n               SA_lnRR_flagged_no_missingES$QE,\n               SA_lnRR_geary_passed$QE,\n               SA_SMDH_published$QE,\n               SA_SMDH_no_comp3$QE,\n               SA_SMDH_flagged$QE,\n               SA_SMDH_no_missingES$QE,\n               SA_SMDH_flagged_no_missingES$QE,\n               SA_SMDH_no_inferential$QE),\n\n  k_effect_sizes = c(SA_lnRR_published$k,\n               SA_lnRR_no_comp3$k,\n               SA_lnRR_flagged$k,\n               SA_lnRR_no_missingES$k,\n               SA_lnRR_flagged_no_missingES$k,\n               SA_lnRR_geary_passed$k,\n               SA_SMDH_published$k,\n               SA_SMDH_no_comp3$k,\n               SA_SMDH_flagged$k,\n               SA_SMDH_no_missingES$k,\n               SA_SMDH_flagged_no_missingES$k,\n               SA_SMDH_no_inferential$k),\n  \n  n_studies = c(length(SA_lnRR_published$s.levels.f[[1]]),\n               length(SA_lnRR_no_comp3$s.levels.f[[1]]),\n               length(SA_lnRR_flagged$s.levels.f[[1]]),\n               length(SA_lnRR_no_missingES$s.levels.f[[1]]),\n               length(SA_lnRR_flagged_no_missingES$s.levels.f[[1]]),\n               length(SA_lnRR_geary_passed$s.levels.f[[1]]),\n               length(SA_SMDH_published$s.levels.f[[1]]),\n               length(SA_SMDH_no_comp3$s.levels.f[[1]]),\n               length(SA_SMDH_flagged$s.levels.f[[1]]),\n               length(SA_SMDH_no_missingES$s.levels.f[[1]]),\n               length(SA_SMDH_flagged_no_missingES$s.levels.f[[1]]),\n               length(SA_SMDH_no_inferential$s.levels.f[[1]])\n               ))\n\n\n# Combine CI and PI into a single column each for compactness\nSA_intercept_only <- SA_intercept_only %>%\n  mutate(\n    CI = paste0(\"[\", sprintf(\"%.3f\", CI_Lower), \", \", sprintf(\"%.3f\", CI_Upper), \"]\"),\n    PI = paste0(\"[\", sprintf(\"%.3f\", PI_Lower), \", \", sprintf(\"%.3f\", PI_Upper), \"]\"),\n    P_value = scales::pvalue(P_value),\n    Q_value = sprintf(\"%.2f\", Q_value)\n  ) %>%\n  select(\n    effect_size,\n    data_used,\n    Estimate,\n    CI,\n    PI,\n    P_value,\n    k_effect_sizes,\n    n_studies\n  )\n\n# Let's make this table pretty\nSA_intercept_only<-SA_intercept_only%>%\n  gt()%>%\n  tab_options(\n    table.font.size = px(12),\n    table.border.top.color = \"black\",\n    table.border.bottom.color = \"black\",\n    heading.title.font.size = px(14),\n    heading.subtitle.font.size = px(12),\n    column_labels.font.weight = \"bold\"\n  ) %>%\n  tab_header(\n    title = md(\"**Summary of Sensitivity Analyses for lnRR and SMD(H) Intercept-only models**\")\n  ) %>%\n  cols_label(\n    effect_size = \"Effect Size\",\n    data_used = \"Data used in model\",\n    Estimate = \"Estimate\",\n    CI = \"95% CI\",\n    PI = \"95% PI\",\n    P_value = \"P-value\",\n    k_effect_sizes = \"k (No. of Effect Sizes)\",\n    n_studies = \"n (No. of Studies)\"\n  ) %>%\n  fmt_number(\n    columns = c(Estimate),\n    decimals = 3\n  ) %>%\n  tab_style(\n    style = cell_borders(\n      sides = \"bottom\",\n      color = \"black\",\n      weight = px(1)\n    ),\n    locations = cells_body()\n  ) %>%\n  tab_options(\n    table.font.size = \"small\",\n    heading.title.font.size = 14,\n    table.border.top.width = px(2),\n    column_labels.font.weight = \"bold\",\n    row_group.font.weight = \"bold\"\n  ) %>%\n  opt_table_outline()\n\n# Saving as an image\ngtsave(SA_intercept_only, here::here(\"tables/SA_intercept_only.png\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////var/folders/sp/jlskm_817d78dg8nvdk72l0c0000gn/T//Rtmppq9oN0/file47876eb681c.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code}\n# For saving as a docx file\n# gtsave(SA_intercept_only,here::here(\"tables/SA_intercept_only.docx\"))\n# gtsave(SA_intercept_only,here::here(\"tables/SA_intercept_only.html\"))\n```\n:::\n\n\n\\\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# t4 <- data.frame(rho  = rho_range,\n#                  \"overall effect\"  = sapply(lnRR_VCV_range, function(x) coef(x)),\n#                  \"standard error\" = sapply(lnRR_VCV_range, function(x) x$se),\n#                  \"p-value\" = sapply(lnRR_VCV_range, function(x) x$pval),\n#                  \"Lower CI\" = sapply(lnRR_VCV_range, function(x) x$ci.lb),\n#                  \"Upper CI\" = sapply(lnRR_VCV_range, function(x) x$ci.ub),\n#                  \"Log-likehood\" = sapply(lnRR_VCV_range, function(x) fitstats(x)[1,1]),\n#                  \"AIC\" = sapply(lnRR_VCV_range, function(x) fitstats(x)[3,1]),\n#                  \"BIC\" = sapply(lnRR_VCV_range, function(x) fitstats(x)[4,1]),\n#                  \"AICc\" = sapply(lnRR_VCV_range, function(x) fitstats(x)[5,1]))\n# \n# colnames(t4) <- c(\"Sampling correlation\", \"Overall effect (lnRR)\", \"Standard error\", \"p-value\", \"Lower CI\", \"Upper CI\", \"Log-likehood\", \"AIC\", \"BIC\", \"AICc\")\n# \n# t4 %>% dfround(4) %>% DT::datatable()\n```\n:::\n\n\n# -------- TABLES ----------\n\n## Table: Output from meta-regressions\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(gt, tidyverse, metafor, purrr, stringr)\n\n# Loading models for experimental design\nlnRR_design<-readRDS(here::here(\"model/lnRR_design.rds\"))\nSMDH_design<-readRDS(here::here(\"model/SMDH_design.rds\"))\n\n# Loading models for parasite type\nlnRR_parasite<-readRDS(here::here(\"model/lnRR_parasite.rds\"))\nSMDH_parasite<-readRDS(here::here(\"model/SMDH_parasite.rds\"))\n\n# Loading models for time of green nest material addition\nlnRR_time_gnm_addition<-readRDS(here::here(\"model/lnRR_time_gnm_addition.rds\"))\nSMDH_time_gnm_addition<-readRDS(here::here(\"model/SMDH_time_gnm_addition.rds\"))\n\n# Loading models for the type of trait studied\nlnRR_trait<-readRDS(here::here(\"model/lnRR_trait.rds\"))\nSMDH_trait<-readRDS(here::here(\"model/SMDH_trait.rds\"))\n\n# Loading models for the bird species studied\nlnRR_birds<-readRDS(here::here(\"model/lnRR_birds.rds\"))\nSMDH_birds<-readRDS(here::here(\"model/SMDH_birds.rds\"))\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Let's source our custom function to extract values from the meta-regressions\nsource(here::here(\"functions/extractor_metareg.R\"))\n\n## For lnRR Values\nlnRR_results <- extractor_metareg(lnRR_parasite,\"parasite_type\")%>%\n  bind_rows(extractor_metareg(lnRR_birds,\"bird_species\"))%>%\n  bind_rows(extractor_metareg(lnRR_trait,\"trait_type\"))%>%\n  bind_rows(extractor_metareg(lnRR_design,\"comparision_type\"))%>%\n  bind_rows(extractor_metareg(lnRR_time_gnm_addition,\"time_of_gnm_addition\"))%>%\n  mutate(effect_size = \"lnRR\")\n\n## For SMDH Values\nSMDH_results <- extractor_metareg(SMDH_parasite,\"parasite_type\")%>%\n  bind_rows(extractor_metareg(SMDH_birds,\"bird_species\"))%>%\n  bind_rows(extractor_metareg(SMDH_trait,\"trait_type\"))%>%\n  bind_rows(extractor_metareg(SMDH_design,\"comparision_type\"))%>%\n  bind_rows(extractor_metareg(SMDH_time_gnm_addition,\"time_of_gnm_addition\"))%>%\n  mutate(effect_size = \"SMDH\")\n\n## Now let's write the table for publication:\n# Combine both results\ncombined_results <- bind_rows(lnRR_results, SMDH_results)%>%\n  pivot_wider(\n    id_cols = c(moderator, level),\n    names_from = effect_size,\n    values_from = c(estimate, p_value, CI, PI, k, n),\n    names_glue = \"{.value}_{effect_size}\"\n  )%>% # Prepare row labels to mimic grouping\n  arrange(moderator, level)%>%\n  mutate(row_type = \"level\")\n\n# # Create moderator header rows for heterogeneity metrics\n#   moderator_header<-bind_rows(lnRR_results, SMDH_results) %>%\n#   select(moderator, effect_size, R2_marginal) %>%\n#     distinct()%>%\n#     pivot_wider(\n#       names_from = effect_size,\n#       values_from = c( R2_marginal),\n#       names_glue = \"{.value}_{effect_size}\"\n#     )%>%\n#   mutate(level = \"Heterogeneity \",\n#          row_type = \"moderator\")\n\n# Final combined table with headers and levels\n combined_results <- combined_results %>%\n   # bind_rows(moderator_header ,combined_results) %>%\n  arrange(moderator, row_type)%>% select(-row_type)%>%\n  relocate(level, .after = moderator)%>%\n  mutate(moderator = case_when(\n    moderator == \"parasite_type\" ~ \"5. Parasite\\nType\",\n    moderator == \"bird_species\" ~ \"3. Bird\\nSpecies\",\n    moderator == \"trait_type\" ~ \"4. Trait\\nCategory\",\n    moderator == \"comparision_type\" ~ \"1. Experimental\\nDesign\",\n    moderator == \"time_of_gnm_addition\" ~ \"2. Time of\\nGNM Addition\"\n  ))%>%mutate(moderator = factor(\n    moderator,\n    levels = c(\n      \"1. Experimental\\nDesign\",\n      \"2. Time of\\nGNM Addition\",\n      \"3. Bird\\nSpecies\",\n      \"4. Trait\\nCategory\",\n      \"5. Parasite\\nType\"\n    )\n  ))%>%\n  arrange(moderator)%>%\n  mutate(level = case_when(level==1 ~ \"Non-aromatic\\nvs. Aromatic\",\n                           level==2 ~ \"No added material\\nvs. Aromatic\",\n                           level==3 ~ \"No added material\\nvs. Non-aromatic\",\n                           level==\"a\" ~ \"After egg\\nhatching\",\n                           level==\"b\" ~ \"Before egg\\nhatching\",\n                           level==\"c\" ~ \"Continously through\\nnesting phase\",\n                           level==\"Parasitic_and_pathogenic\"~\"Parasitic and\\nPathogen Related\", .default=level))\n\n\n# Optional: clean up or reorder columns for display\n# Select and order columns for clarity\nMLMR_table <- combined_results %>%\n  gt(groupname_col = \"moderator\") %>%\n  tab_header(title = md(\"**Multilevel Meta Regressions for Exploratory Analyses**\")) %>%\n  cols_label(\n    # R2_marginal_lnRR = \"R²_mar\",\n    # R2_marginal_SMDH = \"R²_mar\",\n    level = \"Level\",\n    estimate_lnRR = \"Estimate\",\n    CI_lnRR = \"95% CI\",\n    PI_lnRR = \"95% PI\",\n    p_value_lnRR = \"P-val\",\n    k_lnRR = \"k\",\n    n_lnRR = \"n\",\n    estimate_SMDH = \"Estimate\",\n    CI_SMDH = \"95% CI\",\n    PI_SMDH = \"95% PI\",\n    p_value_SMDH = \"P-val\",\n    k_SMDH = \"k\",\n    n_SMDH = \"n\"\n  ) %>%\n   sub_missing(\n    columns = everything(),\n    missing_text = \"\"\n  ) %>%\n  opt_table_outline() %>%\n  tab_options(\n    table.font.size = \"small\",\n    heading.title.font.size = 12,\n    table.border.top.width = px(2),\n    column_labels.font.weight = \"medium\",\n    row_group.font.weight = \"bold\"\n  )   %>%\n  tab_style(\n    style = cell_borders(\n      sides = \"bottom\",\n      color = \"black\",\n      weight = px(1)\n    ),\n    locations = cells_body()\n  ) %>%\n  # tab_style(\n  #   style = cell_text(weight = \"bold\"),\n  #   locations = cells_body(\n  #     rows = level == \"Heterogeneity\"\n  #   ))%>%\n  tab_style(\n    style = cell_text(weight = \"bold\"),\n    locations = cells_body(\n      columns = c(p_value_lnRR),\n      rows = p_value_lnRR < 0.05\n    )\n  ) %>%\n  tab_style(\n    style = cell_text(weight = \"bold\"),\n    locations = cells_body(\n      columns = c(p_value_SMDH),\n      rows = p_value_SMDH < 0.05\n    )\n  )%>%\n  tab_spanner(label = \"lnRR\", columns = contains(\"_lnRR\")) %>%\n  tab_spanner(label = \"SMDH\", columns = contains(\"_SMDH\"))  %>%\n  tab_style(\n    style = cell_text(whitespace = \"nowrap\"),\n    locations = cells_body(columns = c(CI_lnRR, PI_lnRR, CI_SMDH, PI_SMDH))\n  )\n\n# saving the image\ngtsave(MLMR_table,here::here(\"tables/MLMR_table.png\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nfile:////var/folders/sp/jlskm_817d78dg8nvdk72l0c0000gn/T//Rtmppq9oN0/file478be4ef15.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code}\n# #saving as a docx file or html\n# gtsave(MLMR_table,here::here(\"tables/MLMR_table.docx\"))\n# gtsave(MLMR_table,here::here(\"tables/MLMR_table.html\"))\n```\n:::\n\n",
    "supporting": [
      "08_figures-tables_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}