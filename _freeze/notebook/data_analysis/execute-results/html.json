{
  "hash": "8a058d9980c05683c6501e7b5dc80875",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Green Nest Material Meta-Analysis\"\nsubtitle: \"The adaptive value of green nest material across birds: A systematic review and meta-analysis\"\nauthor: \"Shreya Dimri\"\ndate: last-modified\n\nformat:\n  html:\n   toc: true \n   toc-title: \"Table of Contents\" \n   toc-depth: 2 \n   toc-expand: 3 \n   toc-location: left \n   mainfont: Verdana \n   monofont: Jetbrains Mono \n   fontsize: 12pt \n   code-fold: show\n   df-print: paged \n   highlight-style: github \n   pdf: default\neditor: visual\n---\n\n\n\n## Loading Data for analysis\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Setting up workspace\n\n# For plotting trees, and although not strictly necessary, we may need the `ggtree` R package, which you should be able to install by running:\n# if (!require(\"BiocManager\", quietly = TRUE))\n# install.packages(\"BiocManager\")\n# BiocManager::install(\"ggtree\")\n\n#devtools::install_github(\"daniel1noble/orchaRd\", ref = \"main\", force = TRUE)\npacman::p_load(here, tidyverse, metafor,ggpubr,orchaRd,ggpubfigs) #Packages needed\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: package 'ggpubfigs' is not available for this version of R\n\nA version of this package for your version of R might be available elsewhere,\nsee the ideas at\nhttps://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Installing-packages\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in p_install(package, character.only = TRUE, ...):\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in library(package, lib.loc = lib.loc, character.only = TRUE,\nlogical.return = TRUE, : there is no package called 'ggpubfigs'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in pacman::p_load(here, tidyverse, metafor, ggpubr, orchaRd, ggpubfigs): Failed to install/load:\nggpubfigs\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nrm(list=ls()) ## cleaning up\nset.seed(430) #set seed for reproducibility (for random number generation)\n# Loading cleaned dataset\ndataset_analysis<- read_csv(here::here(\"data/03_data_cleaning/dataset_analysis.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRows: 279 Columns: 71\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (35): paper_ID, fulltext_screening, variable_note, authors, population_l...\ndbl (35): year_publication, Observation_ID, experiment_ID, group_ID, repeate...\nlgl  (1): fulltext_notes\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# Functions needed\n\n# function to estimate typical sampling error variance obtained from \n# https://github.com/Yefeng0920/heterogeneity_ecoevo/tree/main/function\nsigma2_v <- function(mod){\n  sigma2_v <- sum(1 / mod$vi) * (mod$k - 1) /\n    (sum(1 / mod$vi)^2 - sum((1 / mod$vi)^2))\n  return(sigma2_v)\n}\n```\n:::\n\n\n\n### Creating Phylogeny for the plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# install.packages(\"pacman\")\n# load packages\npacman::p_load(rotl,\n               ape,\n               ggtree)\n# Doesn't matter if I take dataset_lnRR or dataset_SMDH\nbird_species <- unique(dataset_analysis$bird_species)\n\n# extracting taxonomic information\ntaxa <- rotl::tnrs_match_names(names = bird_species)\ntaxa\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"search_string\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"unique_name\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"approximate_match\"],\"name\":[3],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"score\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ott_id\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"is_synonym\"],\"name\":[6],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"flags\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"number_matches\"],\"name\":[8],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"cyanistes caeruleus\",\"2\":\"Cyanistes caeruleus\",\"3\":\"FALSE\",\"4\":\"1\",\"5\":\"746120\",\"6\":\"FALSE\",\"7\":\"\",\"8\":\"1\"},{\"1\":\"sturnus unicolor\",\"2\":\"Sturnus unicolor\",\"3\":\"FALSE\",\"4\":\"1\",\"5\":\"366470\",\"6\":\"FALSE\",\"7\":\"sibling_higher\",\"8\":\"1\"},{\"1\":\"tachycineta bicolor\",\"2\":\"Tachycineta bicolor\",\"3\":\"FALSE\",\"4\":\"1\",\"5\":\"136028\",\"6\":\"FALSE\",\"7\":\"\",\"8\":\"1\"},{\"1\":\"sturnus vulgaris\",\"2\":\"Sturnus vulgaris\",\"3\":\"FALSE\",\"4\":\"1\",\"5\":\"565813\",\"6\":\"FALSE\",\"7\":\"sibling_higher\",\"8\":\"1\"},{\"1\":\"parus major\",\"2\":\"Parus major\",\"3\":\"FALSE\",\"4\":\"1\",\"5\":\"515143\",\"6\":\"FALSE\",\"7\":\"\",\"8\":\"1\"},{\"1\":\"passer cinnamomeus\",\"2\":\"Passer cinnamomeus\",\"3\":\"FALSE\",\"4\":\"1\",\"5\":\"7661508\",\"6\":\"FALSE\",\"7\":\"\",\"8\":\"1\"},{\"1\":\"buteo buteo\",\"2\":\"Buteo buteo\",\"3\":\"FALSE\",\"4\":\"1\",\"5\":\"119214\",\"6\":\"FALSE\",\"7\":\"sibling_higher\",\"8\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code .hidden}\n# check approximate matches\ntaxa[taxa$approximate_match==TRUE & !(is.na(taxa$approximate_match)),]\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"search_string\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"unique_name\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"approximate_match\"],\"name\":[3],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"score\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ott_id\"],\"name\":[5],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"is_synonym\"],\"name\":[6],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"flags\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"number_matches\"],\"name\":[8],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code .hidden}\n# phylogenetic information for our species from the Open Tree of Life\ntree <- rotl::tol_induced_subtree(ott_ids = taxa[[\"ott_id\"]], label_format = \"name\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nProgress [----------------------------------] 0/99 (  0%) ?s\nProgress [================================] 99/99 (100%)  0s\n                                                            \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in collapse_singles(tr, show_progress): Dropping singleton nodes with\nlabels: mrcaott246ott2907, mrcaott246ott3600042, mrcaott246ott47588,\nmrcaott246ott7113, Passeriformes, mrcaott246ott3212, mrcaott246ott428578,\nmrcaott246ott44866, mrcaott246ott5929, mrcaott246ott32658, mrcaott246ott4820,\nmrcaott246ott310390, mrcaott246ott176461, mrcaott246ott22325,\nmrcaott246ott10351, mrcaott246ott193904, mrcaott246ott5935, mrcaott246ott1566,\nmrcaott1566ott3598440, mrcaott1566ott496009, mrcaott1566ott2175,\nmrcaott2175ott600902, mrcaott2175ott259082, mrcaott2175ott59905,\nmrcaott2175ott2224, mrcaott2224ott366470, mrcaott3364ott310375,\nmrcaott3364ott3370, mrcaott4083ott35042, mrcaott4083ott370807,\nmrcaott4083ott469177, mrcaott4083ott18592, mrcaott4083ott4088,\nmrcaott4088ott9416, mrcaott9416ott840030, mrcaott9416ott96148,\nmrcaott9416ott7068473, Passer, mrcaott9416ott7661508, mrcaott1488ott72472,\nmrcaott1488ott63797, mrcaott1488ott284404, mrcaott1488ott107463,\nmrcaott1488ott17016, mrcaott1488ott107476, mrcaott1488ott104673,\nmrcaott1488ott16185, mrcaott16185ott274931, Hirundinidae, mrcaott16185ott67916,\nmrcaott16185ott16194, mrcaott16185ott136028, mrcaott136028ott1050413,\nTachycineta, mrcaott136028ott621794, mrcaott2375ott73144, mrcaott2375ott124085,\nmrcaott2375ott71358, mrcaott2375ott814750, mrcaott2375ott61147,\nmrcaott84656ott325811, mrcaott84656ott325806, mrcaott84656ott875992, Parus,\nmrcaott84656ott3598691, mrcaott123763ott995871, mrcaott123763ott258794,\nAccipitriformes, mrcaott1858ott1036186, mrcaott1858ott806938, Accipitridae,\nAccipitrinae, mrcaott1858ott47576, mrcaott1858ott103122, mrcaott1858ott8285,\nmrcaott8285ott34284, mrcaott8285ott11582, mrcaott8285ott919198,\nmrcaott8285ott68001, mrcaott8285ott243416, mrcaott8285ott327100,\nmrcaott8285ott376409, mrcaott8285ott33798, mrcaott8285ott33791,\nmrcaott8285ott1008547, mrcaott8285ott1034654, mrcaott8285ott33792,\nmrcaott33792ott458092, mrcaott33792ott120833, mrcaott33792ott34339,\nmrcaott33792ott458099, mrcaott33792ott33796, mrcaott33796ott34349,\nmrcaott33796ott33797, mrcaott33796ott554772, mrcaott33796ott215782,\nmrcaott215782ott236917, mrcaott215782ott433865, mrcaott215782ott805051\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nape::is.binary(tree)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# here are the species included in the tree\nsort(tree$tip.label)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Buteo_buteo\"         \"Cyanistes_caeruleus\" \"Parus_major\"        \n[4] \"Passer_cinnamomeus\"  \"Sturnus_unicolor\"    \"Sturnus_vulgaris\"   \n[7] \"Tachycineta_bicolor\"\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# removing the underscore \"_\" from the tree tip.label\ntree$tip.label <- gsub(\"_\",\" \", tree$tip.label)\nsort(tree$tip.label)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Buteo buteo\"         \"Cyanistes caeruleus\" \"Parus major\"        \n[4] \"Passer cinnamomeus\"  \"Sturnus unicolor\"    \"Sturnus vulgaris\"   \n[7] \"Tachycineta bicolor\"\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# compute branch lengths of tree\nphylo_branch <- compute.brlen(tree, method = \"Grafen\", power = 1)\n\n# check tree is ultrametric\nis.ultrametric(phylo_branch) # TRUE\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# matrix to be included in the models\nbird_phylo <- vcv(phylo_branch, cor = T)\nbird_phylo\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                    Sturnus unicolor Sturnus vulgaris Passer cinnamomeus\nSturnus unicolor           1.0000000        0.8333333          0.6666667\nSturnus vulgaris           0.8333333        1.0000000          0.6666667\nPasser cinnamomeus         0.6666667        0.6666667          1.0000000\nTachycineta bicolor        0.1666667        0.1666667          0.1666667\nParus major                0.1666667        0.1666667          0.1666667\nCyanistes caeruleus        0.1666667        0.1666667          0.1666667\nButeo buteo                0.0000000        0.0000000          0.0000000\n                    Tachycineta bicolor Parus major Cyanistes caeruleus\nSturnus unicolor              0.1666667   0.1666667           0.1666667\nSturnus vulgaris              0.1666667   0.1666667           0.1666667\nPasser cinnamomeus            0.1666667   0.1666667           0.1666667\nTachycineta bicolor           1.0000000   0.6666667           0.6666667\nParus major                   0.6666667   1.0000000           0.8333333\nCyanistes caeruleus           0.6666667   0.8333333           1.0000000\nButeo buteo                   0.0000000   0.0000000           0.0000000\n                    Buteo buteo\nSturnus unicolor              0\nSturnus vulgaris              0\nPasser cinnamomeus            0\nTachycineta bicolor           0\nParus major                   0\nCyanistes caeruleus           0\nButeo buteo                   1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nplot(tree) #check: https://www.rdocumentation.org/packages/ape/versions/5.3/topics/plot.phylo\n```\n\n::: {.cell-output-display}\n![](data_analysis_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n\n### Visualizing random effects structure\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# install.packages(\"devtools\")\n#devtools::install_github(\"davidsjoberg/ggsankey\")\nlibrary(ggsankey)\n\nsankey_data <- dataset_analysis %>%\n  select(Observation_ID, repeated_trait_ID_coded, paper_ID, experiment_ID_coded, group_ID_coded)%>%\n  mutate(across(c(Observation_ID, repeated_trait_ID_coded, paper_ID, experiment_ID_coded, group_ID_coded), as.character)) %>%\n  make_long(Observation_ID, repeated_trait_ID_coded, paper_ID, experiment_ID_coded, group_ID_coded)\n\nsankey_data <- dataset_analysis %>%\n  select(paper_ID, bird_species, population_ID)%>%\n  mutate(across(c(paper_ID, bird_species, population_ID), as.character)) %>%\n  make_long(paper_ID, bird_species, population_ID)\n\n\nggplot(sankey_data, aes(x = x, \n               next_x = next_x, \n               node = node, \n               next_node = next_node,\n               fill = factor(node))) +\n  geom_sankey() +\n  scale_fill_discrete(drop=FALSE) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](data_analysis_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code .hidden}\nggplot(sankey_data, aes(x = x, next_x = next_x, node = node, next_node = next_node, fill = factor(node))) +\n  geom_alluvial(flow.alpha = .6) +\n  scale_fill_viridis_d(drop = FALSE) +\n  theme_alluvial(base_size = 18) +\n  labs(x = NULL) +\n  theme(legend.position = \"none\",\n        plot.title = element_text(hjust = .5))\n```\n\n::: {.cell-output-display}\n![](data_analysis_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n:::\n\n\n\n# Preparing datasets\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n## For lnRR\n# selecting dataset which are not flagged\ndataset_lnRR<-dataset_analysis%>%\n   filter(lnRR_sign != \"NA\" | lnRR_variance != \"NA\")%>%\n  filter(proxy_decision == \"include\")\n\n# selecting only published dataset\ndataset_lnRR_published<-dataset_lnRR%>%\n  filter(!is.na(year_publication))\n\n# selecting dataset which are flagged\nlnRR_con_flagged<-dataset_analysis%>%\n   filter(lnRR_sign != \"NA\" | lnRR_variance != \"NA\")%>%\n  filter(proxy_decision != \"SMDH only\" | proxy_decision != \"contingency table\" )\n\n# selecting dataset without those using 0 as ES because authors reported no effect\nlnRR_sin_missingES <- dataset_lnRR %>% \n   filter(!proxy_comment %in% c(\"use 0 as ES\"))\n\nlnRR_flagged_no_missingES<- lnRR_con_flagged %>% \n   filter(!proxy_comment %in% c(\"use 0 as ES\"))\n\n## For SMDH\n# selecting dataset which are not flagged\ndataset_SMDH<-dataset_analysis%>%\n   filter(proxy_decision == \"include\"| proxy_decision == \"SMDH only\"|proxy_decision ==\"contingency table\") %>% filter(SMDH_sign != \"NA\")\n\n# selecting only published dataset\ndataset_SMDH_published<-dataset_SMDH%>%\n  filter(!is.na(year_publication))\n\n# selecting dataset which are flagged\nSMDH_con_flagged<-dataset_analysis%>%\n   filter(SMDH_sign != \"NA\")\n\n# selecting dataset without those using 0 as ES because authors reported no effect\n\nSMDH_sin_missingES <- dataset_SMDH %>% \n   filter(!proxy_comment %in% c(\"use 0 as ES\"))\n\nSMDH_flagged_no_missingES<- SMDH_con_flagged %>% \n   filter(!proxy_comment %in% c(\"use 0 as ES\"))\n\n# selecting dataset which are not flagged but without the SMDH calculated from inferential statistics \n\nSMDH_no_inferential<-dataset_analysis%>%\n  filter(proxy_decision == \"include\")%>% filter(SMDH_sign != \"NA\")\n```\n:::\n\n\n\n# Overall effect : Intercept-only meta-analytic model\n\n*\"Does adding green material to the nest have an adaptive function across the bird species that perform this behaviour?\"*\n\n## using lnRR\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nVCV_lnRR<- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_lnRR,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\nintercept_lnRR<- rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = dataset_lnRR)\n# saving the model\nsaveRDS(intercept_lnRR, file = here::here(\"model/intercept_lnRR.rds\"))\n```\n:::\n\n\n\nExploring heterogeneity in intercept only model\n\nThis is the function from Yefeng's Github for interpretting heterogeneity. I have to download the data used for this function to be able to use it. For now I am using the values from the table directly so I should just delete it later before finishing the code.\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# ## Function is from the Pluralistic approach to heterogeneity from Yefeng's Pre-print repository from GitHub\n# \n# #-----------------------heterogeneity interpretation-----------------------#\n# het_interpret <- function(observed_value, het_type, es_type, data) {\n#   \n#   if (!het_type %in% c(\"I2\", \"CVH\", \"M\", \"sigma2\", \"V_bar\")) {\n#     stop(\"Invalid heterogeneity type. Choose from 'I2', 'CVH', 'M', 'sigma2', or 'V_bar'.\")\n#   }\n#   \n#   if (!es_type %in% unique(data$es.type)) {\n#     stop(\"Invalid effect size type. Check the levels of 'es.type'.\")\n#   }\n#   \n#   filtered_data <- data %>% filter(es.type == es_type)\n#   \n#   if (nrow(filtered_data) == 0) {\n#     stop(\"No data available for the selected effect size type.\")\n#   }\n#   \n#   het_values <- filtered_data[[het_type]]\n#   \n#   percentiles <- quantile(het_values, probs = seq(0, 1, by = 0.05), na.rm = TRUE)\n#   \n#   lower_bound <- max(percentiles[percentiles <= observed_value], na.rm = TRUE)\n#   upper_bound <- min(percentiles[percentiles >= observed_value], na.rm = TRUE)\n#   lower_percentile <- names(percentiles)[percentiles == lower_bound]\n#   upper_percentile <- names(percentiles)[percentiles == upper_bound]\n#   \n#   percentile_range <- paste0(lower_percentile, \"-\", upper_percentile, \"th percentile\")\n#   \n#   # return the results\n#   return(tibble::tibble(\n#     observed_value = observed_value,\n#     het_type = het_type,\n#     es_type = es_type,\n#     percentile_range = percentile_range\n#   ))\n# }\n# x<-het_interpret(observed_value= I2_main_model_vector[1], \n#                  het_type = \"I2\", \n#                  es_type = \"lnRR_sign\", \n#                  data= intercept_lnRR)\n```\n:::\n\n\n\n## lnRR-heterogeneity\n\nLet us look at the heterogeneity in lnRR intercept-only model\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Then also:\n# # Typical sampling variance (which captures the statistical noise of the data, \n# # but is rarely reported in the current meta-analytic practice):\nsigma2_v(intercept_lnRR)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.0003310316\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# To calculate heterogeneity, these are the functions from orchaRd:\n# # I2, CV and M\nsigma2_main_model_vector <- sum(intercept_lnRR$sigma2)\n# 0.11, 0.27, and 0.57 for lnRR\nI2_main_model_vector <- orchaRd::i2_ml(intercept_lnRR)\n# 0.88, 0.95, and 0.99 for lnRR\nCV_main_model_vector <- orchaRd::cvh1_ml(intercept_lnRR)\n# CVH2 (CVH1) - 1.36 (1.16), 3.76 (1.94), and 12.1 (3.48) for lnRR\nM_main_model_vector <- orchaRd::m1_ml(intercept_lnRR)\n# M2(M1) - 0.58 (0.54), 0.79 (0.66), and 0.78 for lnRR;\n\n# # # Total unstandardized raw variance (i.e. total heterogeneity)\nround(sum(intercept_lnRR$sigma2), 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.022\n```\n\n\n:::\n:::\n\n\n\n## using SMDH\n\nWe are only running these analysis for the fitness proxy labelled \"included\". Some proxies have been flagged and we will run them in a sensitivity analysis only\n\ntheir sampling variances will be fitted as variance--covariance matrices assuming a 0.5 correlation (ρs) between sampling variances from the same paper_ID (Noble et al. 2017).\n\nThe MLMA using SMDH as the effect size measure incorporate the imputed sampling variance\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nVCV_SMDH <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_SMDH,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\nintercept_SMDH<- rma.mv(yi = SMDH_sign, # specify SMDH as the effect size measure;\n                    V = VCV_SMDH, # specify SMDH's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = dataset_SMDH)\n\n# saving the model\n# saveRDS(intercept_SMDH, file = here::here(\"model/intercept_SMDH.rds\"))\n```\n:::\n\n\n\n## SMDH-heterogeneity\n\nNow looking at the intercept only model\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nsummary(intercept_SMDH)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 258; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-328.9026   657.8052   669.8052   691.0997   670.1412   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0010     26     no        paper_ID \nsigma^2.2  0.2543  0.5043    258     no  Observation_ID \nsigma^2.3  0.0000  0.0021     47     no  group_ID_coded \nsigma^2.4  0.0000  0.0042     19     no   population_ID \nsigma^2.5  0.0000  0.0002      7     no    bird_species \n\nTest for Heterogeneity:\nQ(df = 257) = 1124.7869, p-val < .0001\n\nModel Results:\n\nestimate      se    tval   df    pval   ci.lb   ci.ub     \n  0.1720  0.0662  2.5979  257  0.0099  0.0416  0.3024  ** \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npredict(intercept_SMDH)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   pred     se  ci.lb  ci.ub   pi.lb  pi.ub \n 0.1720 0.0662 0.0416 0.3024 -0.8296 1.1736 \n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# Then also:\n# # Typical sampling variance (which captures the statistical noise of the data, \n# # but is rarely reported in the current meta-analytic practice):\nsigma2_v(intercept_SMDH)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1321033\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# To calculate heterogeneity, these are the functions from orchaRd:\n# # I2, CV and M\nsigma2_main_model_vector <- sum(intercept_SMDH$sigma2)\n# 0.54, 1.25, and 3.03 for SMD;\nI2_main_model_vector <- orchaRd::i2_ml(intercept_SMDH)\n# 0.78, 0.89, and 0.96 for SMD\n# 0.88, 0.95, and 0.99 for lnRR\nCV_main_model_vector <- orchaRd::cvh1_ml(intercept_SMDH)\n# CVH2 (CVH1) - 1.36 (1.16), 3.76 (1.94), and 12.1 (3.48) for lnRR\nM_main_model_vector <- orchaRd::m1_ml(intercept_SMDH)\n# M2 (M1) - 0.58 (0.54), 0.79 (0.66), and 0.78 for lnRR\n\n# # # Total unstandardized raw variance (i.e. total heterogeneity)\nround(sum(intercept_SMDH$sigma2), 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.254\n```\n\n\n:::\n:::\n\n\n\n## Bivariate Meta-analytical model\n\nFor the overall effect size (i.e., the meta-analytical mean), we will run the bivariate multilevel meta-analytic model suggested by Yang et al. (2024), which models both lnRR and SMD(H) simultaneously (i.e., including them both as response variables and estimating their correlation; random).\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndataset_bivariate <- data.frame(paper_ID = c(dataset_lnRR$paper_ID, dataset_SMDH$paper_ID),\n                      Observation_ID = c(dataset_lnRR$Observation_ID, dataset_SMDH$Observation_ID),\n                      group_ID_coded = c(dataset_lnRR$group_ID_coded, dataset_SMDH$group_ID_coded),\n                      population_ID = c(dataset_lnRR$population_ID, dataset_SMDH$population_ID),\n                      bird_species = c(dataset_lnRR$bird_species, dataset_SMDH$bird_species),\n                      ES = c(dataset_lnRR$lnRR_sign, dataset_SMDH$SMDH_sign),\n                      V_ES = c(dataset_lnRR$lnRR_variance, dataset_SMDH$SMDH_variance),\n                      ES_measure = c(rep(\"lnRR\", nrow(dataset_lnRR)), rep(\"SMDH\", nrow(dataset_SMDH)))\n                      )\n\nVCV_bivariate <- vcalc(vi = V_ES, # sampling variances of lnRR and SMD that are correlated within the same study;\n             cluster = paper_ID, # study identity;\n             type = ES_measure, # different types of effect size measures underlying the observed effect sizes;\n             data = dataset_bivariate, # the long format data frame;\n             rho = 0.2, # assuming that the effect sizes within the same study are correlated with rho = 0.5.\n             nearpd = TRUE # specify whether impose the non positive definite VCV matrix (not invertible) to the nearest positive semi-definite matrix \n             )\n\nBivariate_model <- rma.mv(yi = ES, # specify the effect size estimate (the variable ES in our case);\n                V = VCV_bivariate, # specify the imputed variance-covariance matrix;\n                mods = ~ ES_measure - 1, # specify the variable \"ES_measure\" indicating the types of effect size measures;\n                random = list(~ ES_measure | paper_ID, \n                              ~ ES_measure | Observation_ID,\n                              ~ 1 | group_ID_coded,\n                              ~ 1 | population_ID,\n                              ~ 1 | bird_species\n                              ), # add correlated random effects corresponding to the lnRR and SMD parameters in the same study;\n                struct = \"UN\", # impose an unstructured variance-covariance of the study-specific random effects;\n                test = \"t\", # t distribution is specified to test the overall effect against the null hypothesis and construct confidence intervals;\n                method = \"REML\", # restricted likelihood maximum is assigned as the estimator for variance components as suggested;\n                data = dataset_bivariate, # the long format dataset\n                sparse = T\n               )\n\nsaveRDS(Bivariate_model, file = here::here(\"sensitivity_analysis/bivariate_model.rds\"))\n\nsummary(Bivariate_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 501; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-485.9593   971.9186   993.9186  1040.2573   994.4607   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0000     47     no  group_ID_coded \nsigma^2.2  0.0000  0.0000     19     no   population_ID \nsigma^2.3  0.0000  0.0000      7     no    bird_species \n\nouter factor: paper_ID   (nlvls = 26)\ninner factor: ES_measure (nlvls = 2)\n\n            estim    sqrt  k.lvl  fixed  level \ntau^2.1    0.0013  0.0359     26     no   lnRR \ntau^2.2    0.1561  0.3951     26     no   SMDH \n\n      rho.lnRR  rho.SMDH    lnRR  SMDH \nlnRR         1                 -    26 \nSMDH   -1.0000         1      no     - \n\nouter factor: Observation_ID (nlvls = 258)\ninner factor: ES_measure     (nlvls = 2)\n\n              estim    sqrt  k.lvl  fixed  level \ngamma^2.1    0.1264  0.3555    243     no   lnRR \ngamma^2.2    1.2527  1.1192    258     no   SMDH \n\n      phi.lnRR  phi.SMDH    lnRR  SMDH \nlnRR         1    0.5215       -   243 \nSMDH    0.5215         1      no     - \n\nTest for Residual Heterogeneity:\nQE(df = 499) = 16205642539.1904, p-val < .0001\n\nTest of Moderators (coefficients 1:2):\nF(df1 = 2, df2 = 499) = 1.7279, p-val = 0.1787\n\nModel Results:\n\n                estimate      se     tval   df    pval    ci.lb   ci.ub    \nES_measurelnRR   -0.0132  0.0301  -0.4392  499  0.6607  -0.0724  0.0460    \nES_measureSMDH    0.2404  0.1365   1.7616  499  0.0788  -0.0277  0.5085  . \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n::: {.cell WARNING='false'}\n\n```{.r .cell-code .hidden}\npacman::p_load(ellipse)\nab.l <- matreg(y=2, x=1, R=Bivariate_model$G, cov=TRUE, means=coef(Bivariate_model), n=Bivariate_model$g.levels.comb.k) # fit regression model\n\nxy <- ellipse(Bivariate_model$G, centre=coef(Bivariate_model), level=0.95) # get 95% coverage region\nellipse_df <- data.frame(x = xy[, 1], y = xy[, 2]) # convert it int dataframe so that we can use ggplot to make a figure\n\npivot_wider(dataset_bivariate, names_from = ES_measure, values_from = c(ES, V_ES)) %>%\n  ggplot() + \n  geom_point(aes(x = ES_lnRR, y = ES_SMDH, size = 1/sqrt(V_ES_lnRR)), color = \"#1B9E77\", alpha = 0.5) + \n  geom_point(aes(x = coef(Bivariate_model)[1], y = coef(Bivariate_model)[2]), color = \"red\", size = 2) + \n  geom_abline(intercept = ab.l$tab$beta[1], slope = ab.l$tab$beta[2]) +\n  geom_path(data = ellipse_df, aes(x = x, y = y), color = \"gray50\") +\n  #scale_x_continuous(limits = c(-2.5, 2.5)) + \n  #scale_y_continuous(limits = c(-2.5, 2.5)) + \n  guides(size = \"none\") + \n  labs(x = \"lnRR\", y = \"SMD\") + \n  theme_bw()\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in geom_point(aes(x = coef(Bivariate_model)[1], y = coef(Bivariate_model)[2]), : All aesthetics have length 1, but the data has 258 rows.\nℹ Please consider using `annotate()` or provide this layer with data containing\n  a single row.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 15 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](data_analysis_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\nThere is a very high negative correlation between the two effect sizes. This probably is an artifact of the data and not a true correlation. If you look at the model summary, the $tau^2$ for lnRR, it is extremely small 0.0008, i.e., there is very little variance. This could also be stemming from the fact that the log values in the dataset could be causing this. For SMDH on the other hand, the $tau^2$ is 0.1681 that is much larger. This difference in the variance estimate itself could be causing this artifact of the model. I will only go ahead to present this model as a senstivity analysis because I am not completely convinced by it's robustness.\n\n# Sensitivity Analysis\n\n### Sensitivity Analysis with published data only\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Preparing new variance-covariance matrix\n\nVCV_lnRR_published <- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_lnRR_published,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\n\n## Running intercept only model\n\nSA_lnRR_published<- rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_published, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = dataset_lnRR_published)\n\n\n# saving the model\nsaveRDS(SA_lnRR_published, file = here::here(\"sensitivity_analysis/SA_lnRR_published.rds\"))\n\n# What is the effect now?\n\nsummary(SA_lnRR_published)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 226; method: REML)\n\n  logLik  Deviance       AIC       BIC      AICc   \n-18.2947   36.5895   48.5895   69.0861   48.9748   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0003     24     no        paper_ID \nsigma^2.2  0.0231  0.1520    226     no  Observation_ID \nsigma^2.3  0.0000  0.0001     44     no  group_ID_coded \nsigma^2.4  0.0000  0.0002     17     no   population_ID \nsigma^2.5  0.0000  0.0000      6     no    bird_species \n\nTest for Heterogeneity:\nQ(df = 225) = 2260.0579, p-val < .0001\n\nModel Results:\n\nestimate      se    tval   df    pval    ci.lb   ci.ub    \n  0.0182  0.0156  1.1662  225  0.2448  -0.0126  0.0490    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npredict(SA_lnRR_published)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   pred     se   ci.lb  ci.ub   pi.lb  pi.ub \n 0.0182 0.0156 -0.0126 0.0490 -0.2828 0.3193 \n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# Preparing new variance-covariance matrix\n\nVCV_SMDH_published <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_SMDH_published,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\n\n## Running intercept only model\n\nSA_SMDH_published<- rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_published, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = dataset_SMDH_published)\n\n\n# saving the model\nsaveRDS(SA_SMDH_published, file = here::here(\"sensitivity_analysis/SA_SMDH_published.rds\"))\n\n# What is the effect now?\n\nsummary(SA_SMDH_published)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 240; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-312.9183   625.8367   637.8367   658.6955   638.1988   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0044     24     no        paper_ID \nsigma^2.2  0.2696  0.5192    240     no  Observation_ID \nsigma^2.3  0.0001  0.0071     45     no  group_ID_coded \nsigma^2.4  0.0007  0.0259     17     no   population_ID \nsigma^2.5  0.0000  0.0014      6     no    bird_species \n\nTest for Heterogeneity:\nQ(df = 239) = 1102.1599, p-val < .0001\n\nModel Results:\n\nestimate      se    tval   df    pval   ci.lb   ci.ub     \n  0.1846  0.0688  2.6822  239  0.0078  0.0490  0.3201  ** \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npredict(SA_SMDH_published)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   pred     se  ci.lb  ci.ub   pi.lb  pi.ub \n 0.1846 0.0688 0.0490 0.3201 -0.8486 1.2177 \n```\n\n\n:::\n:::\n\n\n\n### Sensitivity Analysis with flagged proxies\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Preparing new variance-covariance matrix\n\nVCV_lnRR_flagged <- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = lnRR_con_flagged,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\n\n## Running intercept only model\n\nSA_lnRR_flagged<- rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_flagged, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = lnRR_con_flagged)\n\n\n# saving the model\nsaveRDS(SA_lnRR_flagged, file = here::here(\"sensitivity_analysis/SA_lnRR_flagged.rds\"))\n\n# What is the effect now?\n\nsummary(SA_lnRR_flagged)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 264; method: REML)\n\n  logLik  Deviance       AIC       BIC      AICc   \n-20.7461   41.4922   53.4922   74.9252   53.8204   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0001     28     no        paper_ID \nsigma^2.2  0.0213  0.1458    264     no  Observation_ID \nsigma^2.3  0.0000  0.0003     52     no  group_ID_coded \nsigma^2.4  0.0000  0.0001     19     no   population_ID \nsigma^2.5  0.0000  0.0000      7     no    bird_species \n\nTest for Heterogeneity:\nQ(df = 263) = 2402.2982, p-val < .0001\n\nModel Results:\n\nestimate      se    tval   df    pval    ci.lb   ci.ub    \n  0.0221  0.0143  1.5404  263  0.1247  -0.0061  0.0503    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npredict(SA_lnRR_flagged)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   pred     se   ci.lb  ci.ub   pi.lb  pi.ub \n 0.0221 0.0143 -0.0061 0.0503 -0.2664 0.3105 \n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n## Now for SMDH \n\n# Preparing new variance-covariance matrix\n\nVCV_SMDH_flagged <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = SMDH_con_flagged,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\n\n## Running intercept only model\n\nSA_SMDH_flagged<- rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_flagged, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = SMDH_con_flagged)\n\n# saving the model\nsaveRDS(SA_SMDH_flagged, file = here::here(\"sensitivity_analysis/SA_SMDH_flagged.rds\"))\n\n# What is the effect now?\n\nsummary(SA_SMDH_flagged)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 279; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-348.4132   696.8265   708.8265   730.5922   709.1364   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0051     28     no        paper_ID \nsigma^2.2  0.2428  0.4927    279     no  Observation_ID \nsigma^2.3  0.0074  0.0863     53     no  group_ID_coded \nsigma^2.4  0.0000  0.0039     19     no   population_ID \nsigma^2.5  0.0000  0.0032      7     no    bird_species \n\nTest for Heterogeneity:\nQ(df = 278) = 1194.9344, p-val < .0001\n\nModel Results:\n\nestimate      se    tval   df    pval   ci.lb   ci.ub     \n  0.1876  0.0650  2.8850  278  0.0042  0.0596  0.3157  ** \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npredict(SA_SMDH_flagged)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   pred     se  ci.lb  ci.ub   pi.lb  pi.ub \n 0.1876 0.0650 0.0596 0.3157 -0.8055 1.1808 \n```\n\n\n:::\n:::\n\n\n\n### Sensitivity Analysis without 0 ES\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Preparing new variance-covariance matrix\n\nVCV_lnRR_no_missingES <- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = lnRR_sin_missingES,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\n\n## Running intercept only model\n\nSA_lnRR_no_missingES<- rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_no_missingES, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = lnRR_sin_missingES)\n\n\n# saving the model\nsaveRDS(SA_lnRR_no_missingES, file = here::here(\"sensitivity_analysis/SA_lnRR_no_missingES.rds\"))\n\n# What is the effect now?\n\nsummary(SA_lnRR_no_missingES)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 227; method: REML)\n\n  logLik  Deviance       AIC       BIC      AICc   \n-25.4123   50.8246   62.8246   83.3478   63.2082   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0000     26     no        paper_ID \nsigma^2.2  0.0230  0.1518    227     no  Observation_ID \nsigma^2.3  0.0000  0.0003     46     no  group_ID_coded \nsigma^2.4  0.0000  0.0000     19     no   population_ID \nsigma^2.5  0.0000  0.0000      7     no    bird_species \n\nTest for Heterogeneity:\nQ(df = 226) = 2282.3305, p-val < .0001\n\nModel Results:\n\nestimate      se    tval   df    pval    ci.lb   ci.ub    \n  0.0176  0.0153  1.1527  226  0.2503  -0.0125  0.0478    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npredict(SA_lnRR_no_missingES)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   pred     se   ci.lb  ci.ub   pi.lb  pi.ub \n 0.0176 0.0153 -0.0125 0.0478 -0.2830 0.3182 \n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n## Now we do this for SMDH\n\n# Preparing new variance-covariance matrix\n\nVCV_SMDH_no_missingES <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = SMDH_sin_missingES,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\n\n## Running intercept only model\n\nSA_SMDH_no_missingES<- rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_no_missingES, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = SMDH_sin_missingES)\n\n# saving the model\nsaveRDS(SA_SMDH_no_missingES, file = here::here(\"sensitivity_analysis/SA_SMDH_no_missingES.rds\"))\n\n# What is the effect now?\n\nsummary(SA_SMDH_no_missingES)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 242; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-319.9149   639.8297   651.8297   672.7385   652.1887   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0012     26     no        paper_ID \nsigma^2.2  0.2917  0.5401    242     no  Observation_ID \nsigma^2.3  0.0000  0.0019     47     no  group_ID_coded \nsigma^2.4  0.0000  0.0045     19     no   population_ID \nsigma^2.5  0.0000  0.0002      7     no    bird_species \n\nTest for Heterogeneity:\nQ(df = 241) = 1123.5497, p-val < .0001\n\nModel Results:\n\nestimate      se    tval   df    pval   ci.lb   ci.ub    \n  0.1781  0.0696  2.5576  241  0.0112  0.0409  0.3152  * \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npredict(SA_SMDH_no_missingES)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   pred     se  ci.lb  ci.ub   pi.lb  pi.ub \n 0.1781 0.0696 0.0409 0.3152 -0.8946 1.2508 \n```\n\n\n:::\n:::\n\n\n\n### Sensitivity Analysis with flagged proxies and no missing ES\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Preparing new variance-covariance matrix\n\nVCV_flagged_no_missingES <- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = lnRR_flagged_no_missingES,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\n\n## Running intercept only model\n\nSA_lnRR_flagged_no_missingES<- rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_flagged_no_missingES, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = lnRR_flagged_no_missingES)\n\n\n# saving the model\nsaveRDS(SA_lnRR_flagged_no_missingES, file = here::here(\"sensitivity_analysis/SA_lnRR_flagged_no_missingES.rds\"))\n\n# What is the effect now?\n\nsummary(SA_lnRR_flagged_no_missingES)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 248; method: REML)\n\n  logLik  Deviance       AIC       BIC      AICc   \n-24.5958   49.1917   61.1917   82.2480   61.5417   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0001     28     no        paper_ID \nsigma^2.2  0.0224  0.1497    248     no  Observation_ID \nsigma^2.3  0.0000  0.0003     52     no  group_ID_coded \nsigma^2.4  0.0000  0.0000     19     no   population_ID \nsigma^2.5  0.0000  0.0000      7     no    bird_species \n\nTest for Heterogeneity:\nQ(df = 247) = 2399.8889, p-val < .0001\n\nModel Results:\n\nestimate      se    tval   df    pval    ci.lb   ci.ub    \n  0.0222  0.0147  1.5164  247  0.1307  -0.0066  0.0511    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npredict(SA_lnRR_flagged_no_missingES)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   pred     se   ci.lb  ci.ub   pi.lb  pi.ub \n 0.0222 0.0147 -0.0066 0.0511 -0.2740 0.3185 \n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n## with SMDH\n\n# Preparing new variance-covariance matrix\n\nVCV_SMDH_flagged_no_missingES <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = SMDH_flagged_no_missingES,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\n\n## Running intercept only model\n\nSA_SMDH_flagged_no_missingES<- rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_flagged_no_missingES, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = SMDH_flagged_no_missingES)\n\n\n# saving the model\nsaveRDS(SA_SMDH_flagged_no_missingES, file = here::here(\"sensitivity_analysis/SA_SMDH_flagged_no_missingES.rds\"))\n\n\n# What is the effect now?\n\nsummary(SA_SMDH_flagged_no_missingES)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 263; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-339.6297   679.2593   691.2593   712.6694   691.5887   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0003     28     no        paper_ID \nsigma^2.2  0.2772  0.5265    263     no  Observation_ID \nsigma^2.3  0.0001  0.0085     53     no  group_ID_coded \nsigma^2.4  0.0000  0.0001     19     no   population_ID \nsigma^2.5  0.0000  0.0000      7     no    bird_species \n\nTest for Heterogeneity:\nQ(df = 262) = 1193.7544, p-val < .0001\n\nModel Results:\n\nestimate      se    tval   df    pval   ci.lb   ci.ub     \n  0.1914  0.0657  2.9124  262  0.0039  0.0620  0.3208  ** \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npredict(SA_SMDH_flagged_no_missingES)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   pred     se  ci.lb  ci.ub   pi.lb  pi.ub \n 0.1914 0.0657 0.0620 0.3208 -0.8535 1.2363 \n```\n\n\n:::\n:::\n\n\n\n### Sensitivity analysis only using effect sizes calculated from means, SDs, and ns\n\n(i.e., excluding any effect sizes calculated from inferential statistics)\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Preparing new variance-covariance matrix\n\nVCV_SMDH_no_inferential <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = SMDH_no_inferential,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\n\n## Running intercept only model\n\nSA_SMDH_no_inferential<- rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_no_inferential, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = SMDH_no_inferential)\n\n\n# saving the model\nsaveRDS(SA_SMDH_no_inferential, file = here::here(\"sensitivity_analysis/SA_SMDH_no_inferential.rds\"))\n\n\n# What is the effect now?\n\nsummary(SA_SMDH_no_inferential)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 250; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-322.7054   645.4108   657.4108   678.5155   657.7579   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0048     26     no        paper_ID \nsigma^2.2  0.2623  0.5122    250     no  Observation_ID \nsigma^2.3  0.0001  0.0088     46     no  group_ID_coded \nsigma^2.4  0.0004  0.0204     19     no   population_ID \nsigma^2.5  0.0000  0.0013      7     no    bird_species \n\nTest for Heterogeneity:\nQ(df = 249) = 1110.1810, p-val < .0001\n\nModel Results:\n\nestimate      se    tval   df    pval   ci.lb   ci.ub    \n  0.1721  0.0680  2.5298  249  0.0120  0.0381  0.3061  * \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npredict(SA_SMDH_no_inferential)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   pred     se  ci.lb  ci.ub   pi.lb  pi.ub \n 0.1721 0.0680 0.0381 0.3061 -0.8465 1.1907 \n```\n\n\n:::\n:::\n\n\n\n### Different values of sampling variance correlation\n\n[**Robust variance estimation to guard against arbitary value of sampling correlation**]{.underline} - 'robust()' function from R package 'metafor' (Viechtbauer 2010) using 'CR2' (bias reduced linearization correction) from the R package 'clubSandwich' (Pustejovsky 2024) for small-sample size adjustment.\n\nAt the moment, this is not working..\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#MLMA_lnRR_RVE<- robust(MLMA_lnRR_VCV,\n#                        cluster = paper_ID,\n#                        clubSandwich = TRUE,\n#                        verbose=T)\n\n# # summary(MLMA_lnRR_RVE)\n# I2_CI <- i2_ml(MLMA_lnRR_RVE) # Relative heterogeneity\n# round(I2_CI,2) # absolute heterogeneity is reported in the summary of the model\n```\n:::\n\n\n\n::: callout-important\nSensitivity Analysis\n\nWe will also perform a sensitivity analysis using 0.3 and 0.7 correlation between the sampling variances from the same paper_ID and report it in the supplementary materials. If this sensitivity analysis shows large differences in conclusions for the intercept-only model, we will proceed to perform such sensitivity analysis for the meta-regressions.\n:::\n\nFirst, set a series of ρs (i.e., 0.3, 0.5, 0.7) (we assume these values arbitrarily):\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# rho_range <- c(0.3, 0.5, 0.7)\n# \n# MLMAlnRR_VCV_range <- list() # repeatedly run the specified model with varying rho\n# for (i in 1:length(rho_range))\n# {VCV_range <- vcalc(vi = lnRR_variance,\n#                   cluster = paper_ID,\n#                   subgroup = group_ID,\n#                   obs = Observation_ID,\n#                   data = dataset_lnRR,\n#                    rho = rho_range[i],\n#                     ) # impute sampling variance covariance matrix with varying rho\n# \n# MLMAlnRR_VCV_range[[i]] <- rma.mv(yi = lnRR_sign,\n#                                   V = VCV_range, # sampling variance covariance matrix with varying values of rho.\n#                                  random = list(~ 1 | paper_ID,\n#                                   ~ 1 | Observation_ID,\n#                                   ~ 1 | experiment_ID,\n#                                   ~ 1 | group_ID,\n#                                   ~ 1 | repeated_trait_ID),\n#                                   method = \"REML\",\n#                                   data = dataset_lnRR # run the model with varying rho\n# )\n# }\n# \n# save(VCV_range, file = here::here(\"GNM/figures/VCV_range.Rdata\"))\n# save(MLMAlnRR_VCV_range, file = here::here(\"GNM/figures/MLMAlnRR_VCV_range.Rdata\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# t4 <- data.frame(rho  = rho_range,\n#                  \"overall effect\"  = sapply(MLMAlnRR_VCV_range, function(x) coef(x)),\n#                  \"standard error\" = sapply(MLMAlnRR_VCV_range, function(x) x$se),\n#                  \"p-value\" = sapply(MLMAlnRR_VCV_range, function(x) x$pval),\n#                  \"Lower CI\" = sapply(MLMAlnRR_VCV_range, function(x) x$ci.lb),\n#                  \"Upper CI\" = sapply(MLMAlnRR_VCV_range, function(x) x$ci.ub),\n#                  \"Log-likehood\" = sapply(MLMAlnRR_VCV_range, function(x) fitstats(x)[1,1]),\n#                  \"AIC\" = sapply(MLMAlnRR_VCV_range, function(x) fitstats(x)[3,1]),\n#                  \"BIC\" = sapply(MLMAlnRR_VCV_range, function(x) fitstats(x)[4,1]),\n#                  \"AICc\" = sapply(MLMAlnRR_VCV_range, function(x) fitstats(x)[5,1]))\n# \n# colnames(t4) <- c(\"Sampling correlation\", \"Overall effect (lnRR)\", \"Standard error\", \"p-value\", \"Lower CI\", \"Upper CI\", \"Log-likehood\", \"AIC\", \"BIC\", \"AICc\")\n# \n# t4 %>% dfround(4) %>% DT::datatable()\n```\n:::\n\n\n\n# Mechanistic Hypothesis\n\nTo address our secondary questions \"Does the addition of green nest material by birds increase their reproductive success? (Courtship hypothesis)\" and \"Does the addition of green nest material have protective effects and health benefits for the nestlings? (Parental care hypothesis)\", we will make use of the unimoderator multilevel meta-regressions hypothesis type (levels: CH, PCH, Both) as the moderator.\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlnRR_hypothesis <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + Hypothesis,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR)\n\nsaveRDS(lnRR_hypothesis, file = here::here(\"model/lnRR_hypothesis.rds\"))\n\nlnRR_hypothesis_R2 <- r2_ml(lnRR_hypothesis)\nround(lnRR_hypothesis_R2 * 100, 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   R2_marginal R2_conditional \n           1.7            1.7 \n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nSMDH_hypothesis <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + Hypothesis,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH)\n\nsaveRDS(SMDH_hypothesis, file = here::here(\"model/SMDH_hypothesis.rds\"))\n```\n:::\n\n\n\n# Exploratory Analysis\n\nFor our exploratory analyses (see section Exploratory Analyses), we will run unimoderator multilevel meta-regressions using the following moderators:\n\n#### Type of parasites\n\n(levels: arthropods, micro-organisms) \n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# This analysis only includes dataset that has a proxy relating to parasite or pathogen\ndataset_lnRR_parasite <- dataset_lnRR%>%\n  filter(!is.na(parasite_type))%>%\n  mutate(parasite_type=as.factor(parasite_type),\n         paper_ID=as.factor(paper_ID),\n         Observation_ID=as.factor(Observation_ID),\n         group_ID_coded=as.factor(group_ID_coded),\n         bird_species=as.factor(bird_species))\n\nVCV_lnRR_parasite <- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_lnRR_parasite,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\nlnRR_parasite <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_parasite,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + parasite_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                   test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR_parasite)\n\nsaveRDS( lnRR_parasite, file = here::here(\"model/lnRR_parasite.rds\"))\n\n### Similiarly for SMDH as well selecting the dataset with parasite type\n# This analysis only includes dataset that has a proxy relating to parasite or pathogen\ndataset_SMDH_parasite <- dataset_SMDH%>%\n  filter(!is.na(parasite_type))\nVCV_SMDH_parasite <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_SMDH_parasite,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\nSMDH_parasite <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_parasite,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + parasite_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                   test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH_parasite)\n\n \nsaveRDS(SMDH_parasite, file = here::here(\"model/SMDH_parasite.rds\"))\n```\n:::\n\n\n\n#### Time of addition of green nest material\n\n(levels: before egg hatching, after egg hatching, continuously throughout the nesting phase).\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n## We use the complete dataset in this case\nlnRR_time_gnm_addition <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR,# specify lnRR's sampling variance using the variance-covariance matrix we created for the intercept-only model since the whole dataset is being used in this case as well\n                    mods = ~ - 1 + time_of_gnm_addition,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR)\n\nsaveRDS(lnRR_time_gnm_addition, file = here::here(\"model/lnRR_time_gnm_addition.rds\"))\n\n## Now similarly for the SMDH effect size using the complete dataset\nSMDH_time_gnm_addition <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH,# specify lnRR's sampling variance using the variance-covariance matrix we created for the intercept-only model since the whole dataset is being used in this case as well\n                    mods = ~ - 1 + time_of_gnm_addition,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH)\n\nsaveRDS(SMDH_time_gnm_addition, file = here::here(\"model/SMDH_time_gnm_addition.rds\"))\n```\n:::\n\n\n\n#### Type of experimental design\n\n(levels: 1 = non-aromatic vs. aromatic, 2 = no added material vs. aromatic, 3 = no added material vs. non-aromatic).\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# This analysis only includes dataset that has a proxy relating to comaparision type\ndataset_lnRR_design <- dataset_lnRR %>%\n  filter(!is.na(comparision_type))%>%\n  mutate(comparision_type= as.factor(comparision_type))\n\nVCV_lnRR_design <- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_lnRR_design,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\nlnRR_design <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_design ,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + comparision_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR_design )\n\nsaveRDS(lnRR_design, file = here::here(\"model/lnRR_design.rds\"))\n\n# This analysis only includes dataset that has a proxy relating to comaparision type\ndataset_SMDH_design <- dataset_SMDH %>%\n  filter(!is.na(comparision_type))%>%\n  mutate(comparision_type= as.factor(comparision_type))\n\nVCV_SMDH_design <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_SMDH_design,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\nSMDH_design <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_design ,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + comparision_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH_design )\n\nsaveRDS(SMDH_design, file = here::here(\"model/SMDH_design.rds\"))\n```\n:::\n\n\n\nLet me try to do a sensitivity analysis to see what happens when I remove the control condition of 3 in the overall model since that is expected to not have an effect according to the authors as well.. i.e. it is a double control..\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndataset_lnRR_remove3<-dataset_lnRR%>%filter(is.na(comparision_type) | comparision_type!=\"3\")\n\nVCV_lnRR_remove3 <- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_lnRR_remove3,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\nlnRR_remove3 <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_remove3 ,# specify lnRR's sampling variance;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR_remove3 )\n\n## Now for SMDH\n\ndataset_SMDH_remove3<-dataset_SMDH%>%filter(is.na(comparision_type) | comparision_type!=\"3\")\n\nVCV_SMDH_remove3 <- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_SMDH_remove3,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\nSMDH_remove3 <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_remove3 ,# specify lnRR's sampling variance;\n                    mods = ~ 1,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH_remove3 )\n\nsummary(SMDH_remove3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 246; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-287.7625   575.5250   587.5250   608.5326   587.8779   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0002     26     no        paper_ID \nsigma^2.2  0.2338  0.4836    246     no  Observation_ID \nsigma^2.3  0.0000  0.0008     47     no  group_ID_coded \nsigma^2.4  0.0000  0.0002     19     no   population_ID \nsigma^2.5  0.0000  0.0000      7     no    bird_species \n\nTest for Heterogeneity:\nQ(df = 245) = 1048.0795, p-val < .0001\n\nModel Results:\n\nestimate      se    tval   df    pval   ci.lb   ci.ub    \n  0.1415  0.0654  2.1618  245  0.0316  0.0126  0.2703  * \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\nResults remain practically the same irrespective..\n\n#### Bird species\n\n(levels: Cyanistes caeruleus, Sturnus unicolor, Tachycineta bicolor, Sturnus vulgaris; note that these levels reflect the list of species studied in our current database, which may increase after updating our search and/or receiving unpublished data from authors)\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlnRR_birds <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + bird_species,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR)\n\nsaveRDS(lnRR_birds, file = here::here(\"model/lnRR_birds.rds\"))\n\n## Now doing this for SMDH\n\nSMDH_birds <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + bird_species,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH)\n\nsaveRDS(SMDH_birds, file = here::here(\"model/SMDH_birds.rds\"))\n```\n:::\n\n\n\n#### Type of trait studied\n\n(levels:physiology, morphology, reproduction, behaviour, parasite and pathogenic load, phenology)\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlnRR_trait <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + trait_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR)\n\nsaveRDS(lnRR_trait, file = here::here(\"model/lnRR_trait.rds\"))\n\n## Now similarly for SMDH\n\nSMDH_trait <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH,# specify lnRR's sampling variance;\n                    mods = ~ - 1 + trait_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH)\n\nsaveRDS(SMDH_trait, file = here::here(\"model/SMDH_trait.rds\"))\n```\n:::\n\n\n\n# **Sensitivity analyses / robustness checks**\n\nWe will run several sensitivity analyses using the same random effect structure as described above aimed at ensuring the robustness of our results. \n\n3.  We will re-run our intercept-only multivariate meta-analysis (with both lnRR and SMDH as effect sizes) using 0.3 and 0.7 correlation (ρs) between sampling variances from the same paper_ID. If we find large differences in conclusions depending on ρs, we will run the corresponding sensitivity analyses for all our meta-regressions as well.\n\n4.  If during our analyses we notice the need to run additional sensitivity analyses to ensure the robustness of our results, we will label those analyses as non-pre-registered and report them in the supplementary materials of the eventual manuscript.\n\n### Risk of Bias\n\n6\\. Blinding: (Levels: yes, no(\n\n7\\. Random Assignment: (Levels: yes, no)\n\n8\\. Missing Data: (Levels: yes, no)\n\nNote that the specific subset of data for each meta-regression may differ based on the data availability (e.g., information about the type of parasites is only available for effect sizes based on parasite/pathogen related fitness proxy). We will conduct meta-regression on suitable subsets of data for each analysis, provided we have sufficient effect sizes per moderator level (i.e., at least 5 effect sizes per moderator level).\n\n::: callout-important\n## Phylogenetic Effects\n\nNote also that if we obtain additional effect sizes for other bird species after we update our search and/or contact authors, our models may need to account for phylogenetic nonindependence via the inclusion of two additional random effects: \"species\" and \"phylogeny\" following Cinar et al. (2022).\n:::\n\n## Other Analysis\n\n### Risk of Bias Assessment\n\n-   RoB - The outcome will be presented in the form of a [**summary table**]{.underline}. We will conduct uni-moderator meta-regressions using these variables.\n\n## Publication Bias\n\nSmall study effects:\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndataset_lnRR_published<-dataset_lnRR_published%>%\n  mutate(effective_n_inv=1/((4*effective_n_experiment*effective_n_control)/(effective_n_experiment+effective_n_control)))%>%\n  mutate(sqrt_effective_n_inv=sqrt(effective_n_inv))\n\n\nlnRR_small_study <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_published,# specify lnRR's sampling variance;\n                    mods = ~sqrt_effective_n_inv,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR_published)\n\n\n# saving the model\nsaveRDS(lnRR_small_study, file = here::here(\"model/lnRR_small_study.rds\"))\n\nsummary(lnRR_small_study)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 226; method: REML)\n\n  logLik  Deviance       AIC       BIC      AICc   \n-18.6565   37.3131   51.3131   75.1946   51.8316   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0003     24     no        paper_ID \nsigma^2.2  0.0231  0.1520    226     no  Observation_ID \nsigma^2.3  0.0000  0.0001     44     no  group_ID_coded \nsigma^2.4  0.0000  0.0002     17     no   population_ID \nsigma^2.5  0.0000  0.0000      6     no    bird_species \n\nTest for Residual Heterogeneity:\nQE(df = 224) = 2237.9769, p-val < .0001\n\nTest of Moderators (coefficient 2):\nF(df1 = 1, df2 = 224) = 0.2422, p-val = 0.6231\n\nModel Results:\n\n                      estimate      se    tval   df    pval    ci.lb   ci.ub    \nintrcpt                 0.0035  0.0338  0.1037  224  0.9175  -0.0630  0.0700    \nsqrt_effective_n_inv    0.0705  0.1433  0.4921  224  0.6231  -0.2119  0.3530    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nround(r2_ml(lnRR_small_study)*100,2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   R2_marginal R2_conditional \n          0.28           0.28 \n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n## Now for SMDH model\n\ndataset_SMDH_published<-dataset_SMDH_published%>%\n  mutate(effective_n_inv=1/((4*effective_n_experiment*effective_n_control)/(effective_n_experiment+effective_n_control)))%>%\n  mutate(sqrt_effective_n_inv=sqrt(effective_n_inv))\n\n\nSMDH_small_study <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_published,# specify lnRR's sampling variance;\n                    mods = ~sqrt_effective_n_inv,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH_published)\n\n# saving the model\nsaveRDS(SMDH_small_study, file = here::here(\"model/SMDH_small_study.rds\"))\n\nsummary(SMDH_small_study)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 240; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-310.2823   620.5646   634.5646   658.8705   635.0515   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0004     24     no        paper_ID \nsigma^2.2  0.2683  0.5180    240     no  Observation_ID \nsigma^2.3  0.0000  0.0011     45     no  group_ID_coded \nsigma^2.4  0.0000  0.0005     17     no   population_ID \nsigma^2.5  0.0000  0.0001      6     no    bird_species \n\nTest for Residual Heterogeneity:\nQE(df = 238) = 1100.1351, p-val < .0001\n\nTest of Moderators (coefficient 2):\nF(df1 = 1, df2 = 238) = 2.8479, p-val = 0.0928\n\nModel Results:\n\n                      estimate      se     tval   df    pval    ci.lb   ci.ub \nintrcpt                -0.0290  0.1434  -0.2022  238  0.8399  -0.3114  0.2535 \nsqrt_effective_n_inv    1.3096  0.7760   1.6876  238  0.0928  -0.2191  2.8383 \n                        \nintrcpt                 \nsqrt_effective_n_inv  . \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nround(r2_ml(SMDH_small_study)*100,2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   R2_marginal R2_conditional \n          7.46           7.46 \n```\n\n\n:::\n:::\n\n\n\nDecline effects (Time lag bias)\n\nNext, run a uni-moderator meta-regression to test for evidence of decline effects (also known as time-lag bias) which includes year of publication (mean-centered) as the only moderator, and whose slope would provide information about whether the overall effect size has changed (decline) over time (Nakagawa et al. 2022; Sánchez-Tójar et al. 2018).\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndataset_lnRR_published<-dataset_lnRR_published%>%\n  mutate(year_MeanCenter=scale(as.numeric(year_publication),scale=F)[,1])\n\nlnRR_decline_eff <-\n  metafor::rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_published,# specify lnRR's sampling variance;\n                    mods = ~ year_MeanCenter,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_lnRR_published)\n\n# saving the model\nsaveRDS(lnRR_decline_eff, file = here::here(\"model/lnRR_decline_eff.rds\"))\n  \nsummary(lnRR_decline_eff)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 226; method: REML)\n\n  logLik  Deviance       AIC       BIC      AICc   \n-18.0408   36.0815   50.0815   73.9630   50.6000   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0001     24     no        paper_ID \nsigma^2.2  0.0222  0.1491    226     no  Observation_ID \nsigma^2.3  0.0000  0.0002     44     no  group_ID_coded \nsigma^2.4  0.0000  0.0001     17     no   population_ID \nsigma^2.5  0.0000  0.0000      6     no    bird_species \n\nTest for Residual Heterogeneity:\nQE(df = 224) = 1999.1758, p-val < .0001\n\nTest of Moderators (coefficient 2):\nF(df1 = 1, df2 = 224) = 1.5457, p-val = 0.2151\n\nModel Results:\n\n                 estimate      se     tval   df    pval    ci.lb   ci.ub    \nintrcpt            0.0193  0.0154   1.2529  224  0.2116  -0.0111  0.0497    \nyear_MeanCenter   -0.0018  0.0015  -1.2433  224  0.2151  -0.0047  0.0011    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nround(r2_ml(lnRR_decline_eff)*100,2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   R2_marginal R2_conditional \n          1.81           1.81 \n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n## --- Now for SMDH -----\ndataset_SMDH_published<-dataset_SMDH_published%>%\n  mutate(year_MeanCenter=scale(as.numeric(year_publication),scale=F)[,1])\n\n\n\nSMDH_decline_eff <-\n  metafor::rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_published,# specify lnRR's sampling variance;\n                    mods = ~ year_MeanCenter,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                  test = \"t\",\n                  control = list(optimizer=\"optim\"),\n                  data = dataset_SMDH_published)\n# saving the model\nsaveRDS(SMDH_decline_eff, file = here::here(\"model/SMDH_decline_eff.rds\"))\n\nsummary(SMDH_decline_eff)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMultivariate Meta-Analysis Model (k = 240; method: REML)\n\n   logLik   Deviance        AIC        BIC       AICc   \n-311.0891   622.1783   636.1783   660.4842   636.6652   \n\nVariance Components:\n\n            estim    sqrt  nlvls  fixed          factor \nsigma^2.1  0.0000  0.0014     24     no        paper_ID \nsigma^2.2  0.2678  0.5175    240     no  Observation_ID \nsigma^2.3  0.0000  0.0030     45     no  group_ID_coded \nsigma^2.4  0.0229  0.1513     17     no   population_ID \nsigma^2.5  0.0000  0.0001      6     no    bird_species \n\nTest for Residual Heterogeneity:\nQE(df = 238) = 1101.7199, p-val < .0001\n\nTest of Moderators (coefficient 2):\nF(df1 = 1, df2 = 238) = 1.1225, p-val = 0.2905\n\nModel Results:\n\n                 estimate      se     tval   df    pval    ci.lb   ci.ub    \nintrcpt            0.2056  0.0802   2.5637  238  0.0110   0.0476  0.3636  * \nyear_MeanCenter   -0.0087  0.0082  -1.0595  238  0.2905  -0.0250  0.0075    \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nround(r2_ml(SMDH_decline_eff)*100,2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   R2_marginal R2_conditional \n          3.06          10.70 \n```\n\n\n:::\n:::\n\n\n\nLast, run an all-in meta-regression including both the (square root of the) inverse of the 'effective sample size' and the mean-centered year of publication as well as all the other moderators tested in our study to estimate how much heterogeneity is explained by all moderators combined as well as to explore whether evidence remains similar after accounting for all the other moderators (see equation 29 in Nakagawa et al. 2022 for more information about this approach). \n\n## All-in Model for heterogeneity\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n## For lnRR complete dataset\nVCV_lnRR_published<- vcalc(vi = lnRR_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_lnRR_published,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\nall_in_lnRR <- rma.mv(yi = lnRR_sign, # specify lnRR as the effect size measure;\n                    V = VCV_lnRR_published, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ - 1 + time_of_gnm_addition + \n                      year_MeanCenter + \n                      sqrt_effective_n_inv + \n                      comparision_type + \n                      bird_species + \n                      trait_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = dataset_lnRR_published)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: 13 rows with NAs omitted from model fitting.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n## For SMDH complete published dataset\nVCV_SMDH_published<- vcalc(vi = SMDH_variance,\n                  cluster = paper_ID,\n                  obs = Observation_ID,\n                  data = dataset_SMDH_published,\n                  rho = 0.5 # assuming that the effect sizes within the same study are correlated with rho = 0.5\n                  )\n\nall_in_SMDH<- rma.mv(yi = SMDH_sign, # specify lnRR as the effect size measure;\n                    V = VCV_SMDH_published, # specify lnRR's sampling variance-covariance matrix;\n                    mods = ~ - 1 + time_of_gnm_addition + \n                      year_MeanCenter + \n                      sqrt_effective_n_inv + \n                      comparision_type + \n                      bird_species + \n                      trait_type,\n                    random = list(~ 1 | paper_ID,\n                                  ~ 1 | Observation_ID,\n                                  ~ 1 | group_ID_coded,\n                                  ~ 1 | population_ID,\n                                  ~ 1 | bird_species),\n                    method = \"REML\",\n                    control = list(optimizer=\"optim\"),\n                    test = \"t\",\n                    data = dataset_SMDH_published)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: 13 rows with NAs omitted from model fitting.\n```\n\n\n:::\n:::\n",
    "supporting": [
      "data_analysis_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}