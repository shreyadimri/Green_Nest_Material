{
  "hash": "4e1a6a0610bcd10f79f3b9c9217683d7",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Figures and Plots\"\n---\n\n# Visualising location and bird species\n\nI am using the figure code from here and adapting it for my needs..\n\nMentesana, L., Hau, M., D'Amelio, P.B., Adreani, N.M. and Sánchez-Tójar, A. (2025), Do Egg Hormones Have Fitness Consequences in Wild Birds? A Systematic Review and Meta-Analysis. Ecology Letters, 28: e70100. <https://doi.org/10.1111/ele.70100> \\[[Code](https://github.com/ASanchez-Tojar/meta-analysis_egg_hormones_and_fitness/blob/main/code/003_figures.R)\\]\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ndevtools::install_github(\"daniel1noble/orchaRd\", ref = \"main\", force = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nUsing GitHub PAT from the git credential store.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nDownloading GitHub repo daniel1noble/orchaRd@main\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\npillar (1.10.2 -> 1.11.0) [CRAN]\nRcpp   (1.0.14 -> 1.1.0 ) [CRAN]\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nInstalling 2 packages: pillar, Rcpp\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nThe downloaded binary packages are in\n\t/var/folders/sp/jlskm_817d78dg8nvdk72l0c0000gn/T//RtmptHUDi1/downloaded_packages\n── R CMD build ─────────────────────────────────────────────────────────────────\n* checking for file ‘/private/var/folders/sp/jlskm_817d78dg8nvdk72l0c0000gn/T/RtmptHUDi1/remotes130b54056a6ad/daniel1noble-orchaRd-20d9a75/DESCRIPTION’ ... OK\n* preparing ‘orchaRd’:\n* checking DESCRIPTION meta-information ... OK\n* checking for LF line-endings in source and make files and shell scripts\n* checking for empty or unneeded directories\nRemoved empty directory ‘orchaRd/bib’\nRemoved empty directory ‘orchaRd/figures’\n* building ‘orchaRd_2.0.tar.gz’\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\npacman::p_load(ggplot2,dplyr,stringr,readr,cowplot,maps)\n\n# Loading cleaned dataset\ndataset_analysis<- read_csv(here::here(\"data/03_data_cleaning/dataset_analysis.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRows: 279 Columns: 71\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (35): paper_ID, fulltext_screening, variable_note, authors, population_l...\ndbl (35): year_publication, Observation_ID, experiment_ID, group_ID, repeate...\nlgl  (1): fulltext_notes\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# To split population_ID into location and country\ndataset_analysis[c('Location','Country')] <- str_split_fixed(dataset_analysis$population_ID, ',', 2)\n\n### For the purpose of this map, I am adding the the longitude and latitude of the study area manually. They exist in the dataset_analysis$population_location as they were extracted from the paper. I have also added some by just searching the general location since the coordinates were not provided for these..\n\n\ndata_coordinates<-data.frame(Location = unique(dataset_analysis$Location),\n                             Lat_Location=c(51.50,38.41,40.45,40.75,45.40,52.39,37.18,\n                                             40.53,54,39.05,\n                                             51.57,48,42.54,39.95,\n                                             40.13,47.96,28.10,52.06,60.39),\n                             Long_Location=c(19.29,-9.02,-3.50,-3.78,-64.10,6.05,-3.11,\n                                              -4.0,-124,-76.81,\n                                              -2.26,11,8.91,-75.16,\n                                              -8.27,11.18,107.10,8.25,5.32))\n\n## Let's now merge the datasets by the location names\n\ndataset_analysis <- dataset_analysis %>%\n  left_join(data_coordinates, by = \"Location\")\n\n## Count how many times each Location appears in the full dataset\nlocation_counts <- dataset_analysis %>%\n  group_by(Location) %>%\n  summarise(size.freq = n_distinct(paper_ID), .groups = 'drop')\n\n# I will subset the data base so that I get one row per Location AND bird_species.\n# Like this, I get one point per location independently of the number of effect sizes \n# we have per place.\ndataset_analysis_unique_rows <- dataset_analysis %>%\n  distinct(Location, bird_species, .keep_all = TRUE)\n\n# Merge the counts into the unique rows dataset\ndataset_analysis_unique_rows <- dataset_analysis_unique_rows %>%\n  left_join(location_counts, by = \"Location\")\n\n# create data for world coordinates using  \n# map_data() function \nworld_coordinates <- map_data(\"world\") \n\n# create world map using ggplot() function \n# geom_map() function takes world coordinates as input to plot world map \nfig_map <- ggplot() + \n  geom_map(data = world_coordinates, map = world_coordinates, \n    aes(long, lat, map_id = region), \n    color = \"white\", fill= \"#D9EAF7\") + \n  geom_point(data = dataset_analysis_unique_rows, \n             aes(x = Long_Location, y = Lat_Location,\n                 size = size.freq, colour=bird_species), alpha = 0.6) +\nscale_size(range = c(3, 10)) +\n  scale_fill_manual(values = c(\"#11a3d9\",\"#f6c800\",  \"#fb5158\", \n                               \"#ea60e9\", \"#40ad28\",\"#ef8c27\",\"#a083e2\")) +\n  \n  scale_colour_manual(values = c(\"#11a3d9\",\"#f6c800\",  \"#fb5158\", \n                               \"#ea60e9\", \"#40ad28\",\"#ef8c27\",\"#a083e2\")) +\n  guides(size = \"none\", alpha = \"none\") +\n  labs(x = \"Longitude\",\n       y = \"Latitude\")+\n  theme_classic() +\n  theme(legend.position = c(0.88, 0.10),\n        legend.justification = c(\"right\", \"bottom\"),\n        legend.background = element_rect(fill = \"white\", color = \"black\"),\n        axis.title = element_text(size = 12),\n        axis.text.x = element_text(size = 12),\n        axis.text.y = element_blank())\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in geom_map(data = world_coordinates, map = world_coordinates,\naes(long, : Ignoring unknown aesthetics: x and y\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2\n3.5.0.\nℹ Please use the `legend.position.inside` argument of `theme()` instead.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# To add the zoomed in map.. to show the points more clearly\nzoom_map <- ggplot() + \n  geom_map(data = world_coordinates, map = world_coordinates,\n           aes(long, lat, map_id = region),\n           color = \"white\", fill = \"lightgrey\") +\n  geom_point(data = dataset_analysis_unique_rows,\n             aes(x = Long_Location, y = Lat_Location,\n                 size = size.freq, colour = bird_species),\n             alpha = 0.6) +\n  scale_size(range = c(3, 10)) +\n  scale_colour_manual(values = c(\"#11a3d9\",\"#f6c800\",\"#fb5158\",\n                                 \"#ea60e9\",\"#40ad28\",\"#ef8c27\",\"#a083e2\")) +\n  coord_cartesian(xlim = c(-120, 120), ylim = c(25, 65)) +  # Northern Hemisphere\n  theme_void() +\n  theme(\n    legend.position = \"none\",\n    plot.background = element_rect(color = \"white\", fill=\"white\"),\n    panel.border = element_rect(colour = \"black\", fill = NA, size = 1)\n  )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in geom_map(data = world_coordinates, map = world_coordinates,\naes(long, : Ignoring unknown aesthetics: x and y\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: The `size` argument of `element_rect()` is deprecated as of ggplot2 3.4.0.\nℹ Please use the `linewidth` argument instead.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ngeographic_distribution <- ggdraw() +\n  draw_plot(fig_map) +\n  draw_plot(zoom_map, x = 0.10, y = 0.12, width = 0.62, height = 0.22)\n\n\nggsave(here::here(\"figures/Figure_Distribution.png\"), plot = geographic_distribution, height = 250, width = 400, units = \"mm\", dpi = 600)\n```\n:::\n\n\n# Visualizing author network\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# # Loading cleaned dataset\n# dataset_analysis<- read_csv(here::here(\"data/03_data_cleaning/dataset_analysis.csv\"))\n# \n# library(tidyverse)\n# library(tidyr)\n# library(igraph)\n# installed.packages(\"ggraph\")\n# library(ggraph)\n# \n# clean_author <- function(name) {\n#   name %>%\n#     str_replace_all(\",\", \"\") %>%   # remove commas\n#     str_squish() %>%              # remove excess whitespace\n#     str_to_title()                # standardize case (optional, if needed)\n# }\n# \n# # Apply cleaning to first and last author fields\n# author_roles <- dataset_analysis %>%\n#   distinct(paper_ID, .keep_all = TRUE) %>%\n#   select(paper_ID, authors, bird_species) %>%\n#   mutate(\n#     author_list = str_split(authors, \";\\\\s*\"),\n#     first_author = map_chr(author_list, 1),\n#     last_author = map_chr(author_list, ~ tail(.x, 1))\n#   )%>%\n#   mutate(\n#     first_author=case_when(\n#       first_author == \"Polo, V\" | first_author == \"Polo V\" ~ \"Polo V.\",\n#       first_author == \"Soler J J\" ~ \"Soler J. J.\",\n#       first_author == \"Glądalski, M\" ~ \"Gladalski M.\",\n#       first_author == \"Gwinner, H\" | first_author == \"Gwinner H\" ~ \"Gwinner H.\",\n#       TRUE ~ as.character(first_author)\n#     ))%>%\n#   mutate(\n#     last_author=case_when(\n#       last_author == \"Veiga J P\" ~ \"Veiga J. P.\",\n#       TRUE ~ as.character(last_author)\n#     )\n#   )\n# \n# # 2. Create Core Author Pairs (First → Last)\n# author_pairs_core <- author_roles %>%\n#   select(paper_ID, first_author, last_author) %>%\n#   rename(from = first_author, to = last_author) %>%\n#   filter(from != to) %>%\n#   count(from, to, name = \"weight\")\n# \n# # 3. Build Author Graph\n# author_graph <- graph_from_data_frame(author_pairs_core, directed = TRUE)\n# \n# # 4. Assign Dominant Bird Species to PIs (last authors)\n# author_species <- author_roles %>%\n#   select(last_author, bird_species) %>%\n#   group_by(last_author, bird_species) %>%\n#   count() %>%\n#   slice_max(n, n = 1) %>%\n#   distinct(last_author, .keep_all = TRUE)\n# \n# # Add species as vertex attribute\n# V(author_graph)$bird_species <- author_species$bird_species[\n#   match(V(author_graph)$name, author_species$last_author)\n# ]\n# \n# # 5. Optional: Scale node size by number of papers per author\n# author_paper_counts <- author_roles %>%\n#   pivot_longer(cols = c(first_author, last_author), names_to = \"role\", values_to = \"author\") %>%\n#   count(author, name = \"paper_count\")\n# \n# # Add paper count attribute\n# V(author_graph)$paper_count <- author_paper_counts$paper_count[\n#   match(V(author_graph)$name, author_paper_counts$author)\n# ]\n# \n# # Replace NAs with small size for isolated authors\n# V(author_graph)$paper_count[is.na(V(author_graph)$paper_count)] <- 1\n# \n# # 6. Plot with ggraph\n# ggraph(author_graph, layout = \"fr\") +\n#   geom_edge_link(aes(width = weight), alpha = 0.4, color = \"grey50\") +\n#   geom_node_point(aes(color = bird_species, size = paper_count)) +\n#   geom_node_text(aes(label = name), repel = TRUE, size = 3) +\n#   scale_edge_width(range = c(0.3, 2)) +\n#   scale_size(range = c(3, 10)) +\n#   theme_void() +\n#   labs(title = \"Author Collaboration Network by Bird Species\",\n#        size = \"Paper Count\") +\n#   theme(legend.position = \"right\")\n# \n```\n:::\n\n\n# \n\n# Intercept only model\n\nOrchard plot for overall effect of green nest material on fitness using lnRR and SMDH\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\npacman::p_load(here,tidyverse,metafor,orchaRd,patchwork,cowplot)\n\n# Loading models for SMDH and lnRR\n\nintercept_lnRR<-readRDS(here::here(\"model/intercept_lnRR.rds\"))\nintercept_SMDH<-readRDS(here::here(\"model/intercept_SMDH.rds\"))\n\n# Plot for lnRR\nintercept_lnRR_plot <- orchaRd::orchard_plot(intercept_lnRR,\n                                    mod = \"1\",\n                                    group = \"paper_ID\",\n                                    trunk.size = 0.5,\n                                    branch.size = 2,\n                                    twig.size = 0.5,\n                                    alpha = 0.3,\n                                    xlab = \"Effect size (Log Response Ratio- lnRR)\",\n                                    fill = T) +\n   scale_fill_manual(values = \"#218833\") +\n   scale_colour_manual(values = \"#218833\" ) +\n  theme_minimal(base_size = 14) +\n  theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, size = 0.8),\n    legend.position = c(0.98, 0.05),\n    legend.justification = c(1, 0),\n    legend.direction = \"horizontal\",\n    legend.title = element_text(size = 7),\n    legend.text = element_text(size = 7),\n    axis.title = element_text(size = 12),\n    axis.text.x = element_text(size = 12),\n    axis.text.y = element_blank()\n  ) +\n  labs(x = \"Intercept\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# Plot for SMDH\nintercept_SMDH_plot <- orchaRd::orchard_plot(intercept_SMDH,\n                                    mod = \"1\",\n                                    group = \"paper_ID\",\n                                    trunk.size = 0.5,\n                                    branch.size = 2,\n                                    twig.size = 0.5,\n                                    alpha = 0.3,\n                                    xlab = \"Effect size (Standardized Mean Difference- SMDH)\",\n                                    fill = TRUE) +\n  scale_fill_manual(values = \"#895129\") +\n  scale_colour_manual(values = \"#895129\") +\n  theme_minimal(base_size = 14) +\n  theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, size = 0.8),\n    legend.position = c(0.98, 0.05),\n    legend.justification = c(1, 0), \n    legend.direction = \"horizontal\",\n    legend.title = element_text(size = 7),\n    legend.text = element_text(size = 7),\n    axis.title = element_text(size = 12),\n    axis.text.x = element_text(size = 12),\n    axis.text.y = element_blank()\n  ) +\n  labs(x = \"Intercept\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# Combine using patchwork\nFigure_intercept <- intercept_lnRR_plot / intercept_SMDH_plot +\n  plot_annotation(tag_level = c(\"A\",\"B\"))\n\nggsave(here::here(\"figures/Figure_overall_effect.png\"), plot = Figure_intercept, height = 250, width = 400, units = \"mm\", dpi = 600)\n```\n:::\n\n\n# Hypothesis meta-regression\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Loading models for SMDH and lnRR\n\nlnRR_hypothesis<-readRDS(here::here(\"model/lnRR_hypothesis.rds\"))\nSMDH_hypothesis<-readRDS(here::here(\"model/SMDH_hypothesis.rds\"))\n\n\n# Plot lnRR meta-regression on hypothesis\n\nlnRR_hypothesis_plot <-\n  orchard_plot(mod_results(\n      lnRR_hypothesis,\n      mod = \"Hypothesis\",\n      group = \"paper_ID\"\n    ), xlab =\"\") +\n  scale_colour_manual(values = c(\"#895129\", \"mediumpurple4\", \"#218833\")) +\n  scale_fill_manual(values = c(\"#895129\", \"mediumpurple4\", \"#218833\")) +\n  labs(x = \"\",\n       y = \"lnRR\")+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position.inside = c(0.98, 0.05),\n    legend.justification = c(1, 0), \n    legend.direction = \"horizontal\",\n    legend.title = element_text(size = 7),\n    legend.text = element_text(size = 7),\n    axis.title = element_text(size = 12),\n    axis.text.x = element_text(size = 12),\n    axis.text.y = element_text(angle = 90, vjust = 0.5, hjust = 1)\n  )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(lnRR_hypothesis, mod = \"Hypothesis\", group =\n\"paper_ID\"): It is recommended that you fit the model with an intercept.\nUnanticipated errors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# Plot SMDH meta-regression on hypothesis\n \nSMDH_hypothesis_plot <-\n  orchard_plot(\n    mod_results(\n      SMDH_hypothesis,\n      mod = \"Hypothesis\",\n      group = \"paper_ID\"\n    ), xlab =\"\") +\n  scale_colour_manual(values = c(\"#895129\", \"mediumpurple4\", \"#218833\")) +\n  scale_fill_manual(values = c(\"#895129\", \"mediumpurple4\", \"#218833\")) +\n  labs(x = \"\",\n       y = \"SMDH\")+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position.inside = c(0.98, 0.05),\n    legend.justification = c(1, 0), \n    legend.direction = \"horizontal\",\n    legend.title = element_text(size = 7),\n    legend.text = element_text(size = 7),\n    axis.title = element_text(size = 12),\n    axis.text.x = element_text(size = 12),\n    axis.text.y = element_text(angle = 90, vjust = 0.5, hjust = 1)\n  )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(SMDH_hypothesis, mod = \"Hypothesis\", group =\n\"paper_ID\"): It is recommended that you fit the model with an intercept.\nUnanticipated errors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# Combine using patchwork\nFigure_hypothesis <- lnRR_hypothesis_plot + SMDH_hypothesis_plot +\n  plot_annotation(tag_level = c(\"A\",\"B\"))\n\nggsave(here::here(\"figures/Figure_hypothesis.png\"), plot = Figure_hypothesis, height = 150, width = 400, units = \"mm\", dpi = 600)\n```\n:::\n\n\n# Exploratory Analysis\n\n## Parasite Type\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Loading models for SMDH and lnRR\n\nlnRR_parasite<-readRDS(here::here(\"model/lnRR_parasite.rds\"))\nSMDH_parasite<-readRDS(here::here(\"model/SMDH_parasite.rds\"))\n\nlnRR_parasite_plot <-\n  orchard_plot(mod_results(\n      lnRR_parasite,\n      mod = \"parasite_type\",\n      group = \"paper_ID\"\n    ), xlab =\"\") +\n  scale_colour_manual(values = c(\"#895129\", \"#218833\")) +\n  scale_fill_manual(values = c(\"#895129\",  \"#218833\")) +\n  labs(x = \"\",\n       y = \"lnRR\")+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position = \"none\",\n    # legend.position.inside = c(0.98, 0.05),\n    # legend.justification = c(1, 0), \n    # legend.direction = \"horizontal\",\n    # legend.title = element_text(size = 7),\n    # legend.text = element_text(size = 7),\n    axis.title = element_text(size = 12),\n    axis.text.x = element_text(size = 12),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1)\n  )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(lnRR_parasite, mod = \"parasite_type\", group =\n\"paper_ID\"): It is recommended that you fit the model with an intercept.\nUnanticipated errors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nSMDH_parasite_plot <-\n  orchard_plot(mod_results(\n      SMDH_parasite,\n      mod = \"parasite_type\",\n      group = \"paper_ID\"\n    ), xlab =\"\") +\n  scale_colour_manual(values = c(\"#895129\", \"#218833\")) +\n  scale_fill_manual(values = c(\"#895129\",  \"#218833\")) +\n  labs(x = \"\",\n       y = \"SMDH\")+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position = \"none\",\n    # legend.position.inside = c(0.98, 0.05),\n    # legend.justification = c(1, 0), \n    # legend.direction = \"horizontal\",\n    # legend.title = element_text(size = 7),\n    # legend.text = element_text(size = 7),\n    axis.title = element_text(size = 12),\n    axis.text.x = element_text(size = 12),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1)\n  )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(SMDH_parasite, mod = \"parasite_type\", group =\n\"paper_ID\"): It is recommended that you fit the model with an intercept.\nUnanticipated errors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n:::\n\n\n## Bird Species\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Loading models for SMDH and lnRR\n\nlnRR_birds<-readRDS(here::here(\"model/lnRR_birds.rds\"))\nSMDH_birds<-readRDS(here::here(\"model/SMDH_birds.rds\"))\n\nlnRR_birds_plot <-\n  orchard_plot(mod_results(\n      lnRR_birds,\n      mod = \"bird_species\",\n      group = \"paper_ID\"\n    ), xlab =\"\") +\n  scale_colour_manual(values = c(\"darkorange2\", \"lightgoldenrod3\", \"mediumpurple4\", \"#218833\",\"#895129\",\"lightcoral\",\"grey5\")) +\n  scale_fill_manual(values = c(\"darkorange2\", \"lightgoldenrod3\", \"mediumpurple4\", \"#218833\",\"#895129\",\"lightcoral\",\"grey5\")) +\n  labs(x = \"\",\n       y = \"lnRR\")+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position = \"none\",\n    # legend.position.inside = c(0.98, 0.05),\n    # legend.justification = c(1, 0), \n    # legend.direction = \"horizontal\",\n    # legend.title = element_text(size = 7),\n    # legend.text = element_text(size = 7),\n    axis.title = element_text(size = 12),\n    axis.text.x = element_text(size = 12),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1)\n  )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(lnRR_birds, mod = \"bird_species\", group = \"paper_ID\"):\nIt is recommended that you fit the model with an intercept. Unanticipated\nerrors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nSMDH_birds_plot <-\n  orchard_plot(mod_results(\n      SMDH_birds,\n      mod = \"bird_species\",\n      group = \"paper_ID\"\n    ), xlab =\"\") +\n  scale_colour_manual(values =  c(\"darkorange2\", \"lightgoldenrod3\", \"mediumpurple4\", \"#218833\",\"#895129\",\"lightcoral\",\"grey5\")) +\n  scale_fill_manual(values =  c(\"darkorange2\", \"lightgoldenrod3\", \"mediumpurple4\", \"#218833\",\"#895129\",\"lightcoral\",\"grey5\")) +\n  labs(x = \"\",\n       y = \"SMDH\")+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position = \"none\",\n    # legend.position.inside = c(0.98, 0.05),\n    # legend.justification = c(1, 0), \n    # legend.direction = \"horizontal\",\n    # legend.title = element_text(size = 7),\n    # legend.text = element_text(size = 7),\n    axis.title = element_text(size = 12),\n    axis.text.x = element_text(size = 12),\n    axis.text.y = element_text(angle =0, vjust = 0.5, hjust = 1)\n  )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(SMDH_birds, mod = \"bird_species\", group = \"paper_ID\"):\nIt is recommended that you fit the model with an intercept. Unanticipated\nerrors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n:::\n\n\n## Trait studied\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Loading models for SMDH and lnRR\n\nlnRR_trait<-readRDS(here::here(\"model/lnRR_trait.rds\"))\nSMDH_trait<-readRDS(here::here(\"model/SMDH_trait.rds\"))\n\nlnRR_trait_plot <-\n  orchard_plot(mod_results(\n      lnRR_trait,\n      mod = \"trait_type\",\n      group = \"paper_ID\"\n    ), xlab =\"\") +\n  scale_colour_manual(values = c(\"darkorange2\", \"lightgoldenrod3\", \"mediumpurple4\", \"#218833\",\"#895129\",\"lightcoral\",\"grey5\")) +\n  scale_fill_manual(values = c(\"darkorange2\", \"lightgoldenrod3\", \"mediumpurple4\", \"#218833\",\"#895129\",\"lightcoral\",\"grey5\")) +\n  labs(x = \"\",\n       y = \"lnRR\")+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position = \"bottom\",\n    # legend.position.inside = c(0.98, 0.05),\n    # legend.justification = c(1, 0), \n    # legend.direction = \"horizontal\",\n    legend.title = element_text(size = 7),\n    legend.text = element_text(size = 7),\n    axis.title = element_text(size = 12),\n    axis.text.x = element_text(size = 12),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1)\n  )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(lnRR_trait, mod = \"trait_type\", group = \"paper_ID\"): It\nis recommended that you fit the model with an intercept. Unanticipated errors\ncan occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nSMDH_trait_plot <-\n  orchard_plot(mod_results(\n      SMDH_trait,\n      mod = \"trait_type\",\n      group = \"paper_ID\"\n    ), xlab =\"\") +\n  scale_colour_manual(values =  c(\"darkorange2\", \"lightgoldenrod3\", \"mediumpurple4\", \"#218833\",\"#895129\",\"lightcoral\",\"grey5\")) +\n  scale_fill_manual(values =  c(\"darkorange2\", \"lightgoldenrod3\", \"mediumpurple4\", \"#218833\",\"#895129\",\"lightcoral\",\"grey5\")) +\n  labs(x = \"\",\n       y = \"SMDH\")+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position = \"bottom\",\n    # legend.position.inside = c(0.98, 0.05),\n    # legend.justification = c(1, 0), \n    # legend.direction = \"horizontal\",\n    legend.title = element_text(size = 7),\n    legend.text = element_text(size = 7),\n    axis.title = element_text(size = 12),\n    axis.text.x = element_text(size = 12),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1)\n  )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(SMDH_trait, mod = \"trait_type\", group = \"paper_ID\"): It\nis recommended that you fit the model with an intercept. Unanticipated errors\ncan occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n:::\n\n\n### Combined plot\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n## I am going to remove the y ticks from the SMDH plots to make it smaller..\nSMDH_parasite_plot <- SMDH_parasite_plot +\n  theme(axis.text.y  = element_blank(),\n        axis.title.y = element_blank(),\n        axis.ticks.y = element_blank())\n\nSMDH_birds_plot <- SMDH_birds_plot +\n  theme(axis.text.y  = element_blank(),\n        axis.title.y = element_blank(),\n        axis.ticks.y = element_blank())\n\nSMDH_trait_plot <- SMDH_trait_plot +\n  theme(axis.text.y  = element_blank(),\n        axis.title.y = element_blank(),\n        axis.ticks.y = element_blank())\n\n# Combine using patchwork\nFigure_parasite_birds_trait <- ((lnRR_parasite_plot + SMDH_parasite_plot) / \n                                  (lnRR_birds_plot + SMDH_birds_plot) / \n                                  (lnRR_trait_plot + SMDH_trait_plot)) +\n  plot_annotation(tag_levels = \"A\")\n\nggsave(here::here(\"figures/Figure_parasite_birds_trait.png\"), plot = Figure_parasite_birds_trait, height = 250, width = 400, units = \"mm\", dpi = 600)\n```\n:::\n\n\n## Time of green nest material addition\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Loading models for SMDH and lnRR\n\nlnRR_time_gnm_addition<-readRDS(here::here(\"model/lnRR_time_gnm_addition.rds\"))\nSMDH_time_gnm_addition<-readRDS(here::here(\"model/SMDH_time_gnm_addition.rds\"))\n\nlnRR_time_gnm_addition_plot <-\n  orchard_plot(mod_results(\n      lnRR_time_gnm_addition,\n      mod = \"time_of_gnm_addition\",\n      group = \"paper_ID\"\n    ), xlab =\"\") +\n  scale_colour_manual(values = c( \"#218833\",\"mediumpurple4\",\"#895129\")) +\n  scale_fill_manual(values = c( \"#218833\",\"mediumpurple4\",\"#895129\")) +\n  labs(x = \"\",\n       y = \"lnRR\")+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position = \"bottom\",\n    # legend.position.inside = c(0.98, 0.05),\n    # legend.justification = c(1, 0), \n    # legend.direction = \"horizontal\",\n    legend.title = element_text(size = 7),\n    legend.text = element_text(size = 7),\n    axis.title = element_text(size = 12),\n    axis.text.x = element_text(size = 12),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1)\n  ) + scale_x_discrete(labels = c(\"After egg laying\", \"Before egg laying\", \"Continous addition\"))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(lnRR_time_gnm_addition, mod = \"time_of_gnm_addition\", :\nIt is recommended that you fit the model with an intercept. Unanticipated\nerrors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nSMDH_time_gnm_addition_plot <-\n  orchard_plot(mod_results(\n      SMDH_time_gnm_addition,\n      mod = \"time_of_gnm_addition\",\n      group = \"paper_ID\"\n    ), xlab =\"\") +\n  scale_colour_manual(values = c( \"#218833\",\"mediumpurple4\",\"#895129\")) +\n  scale_fill_manual(values = c( \"#218833\",\"mediumpurple4\",\"#895129\")) +\n  labs(x = \"\",\n       y = \"SMDH\")+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.position = \"bottom\",\n    # legend.position.inside = c(0.98, 0.05),\n    # legend.justification = c(1, 0), \n    # legend.direction = \"horizontal\",\n    legend.title = element_text(size = 7),\n    legend.text = element_text(size = 7),\n    axis.title = element_text(size = 12),\n    axis.text.x = element_text(size = 12),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1)\n  )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mod_results(SMDH_time_gnm_addition, mod = \"time_of_gnm_addition\", :\nIt is recommended that you fit the model with an intercept. Unanticipated\nerrors can occur otherwise.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n:::\n\n\n## Experimental Design\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Loading models for SMDH and lnRR\n\nlnRR_design<-readRDS(here::here(\"model/lnRR_design.rds\"))\nSMDH_design<-readRDS(here::here(\"model/SMDH_design.rds\"))\n\n# lnRR_design_plot <-\n#   orchard_plot(mod_results(\n#       lnRR_design,\n#       mod = \"comparision_type\",\n#       group = \"paper_ID\"\n#     ), xlab =\"\") +\n#   scale_colour_manual(values = c( \"#218833\",\"mediumpurple4\",\"#895129\")) +\n#   scale_fill_manual(values = c( \"#218833\",\"mediumpurple4\",\"#895129\")) +\n#   labs(x = \"\",\n#        y = \"lnRR\")+\n#     theme(\n#     panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n#     legend.position = \"none\",\n#     # legend.position.inside = c(0.98, 0.05),\n#     # legend.justification = c(1, 0), \n#     # legend.direction = \"horizontal\",\n#     legend.title = element_text(size = 7),\n#     legend.text = element_text(size = 7),\n#     axis.title = element_text(size = 12),\n#     axis.text.x = element_text(size = 12),\n#     axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1)\n#   ) + scale_x_discrete(labels = c(\"Non-aromatic Vs. Aromatic\",\"Blank Vs. Aromatic\", \"Blank Vs. Non-Aromatic\"))\n# \n# SMDH_design_plot <-\n#   orchard_plot(mod_results(\n#       SMDH_design,\n#       mod = \"comparision_type\",\n#       group = \"paper_ID\"\n#     ), xlab =\"\") +\n#   scale_colour_manual(values = c( \"#218833\",\"mediumpurple4\",\"#895129\")) +\n#   scale_fill_manual(values = c( \"#218833\",\"mediumpurple4\",\"#895129\")) +\n#   labs(x = \"\",\n#        y = \"SMDH\")+\n#     theme(\n#     panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n#     legend.position = \"none\",\n#     # legend.position.inside = c(0.98, 0.05),\n#     # legend.justification = c(1, 0), \n#     # legend.direction = \"horizontal\",\n#     legend.title = element_text(size = 7),\n#     legend.text = element_text(size = 7),\n#     axis.title = element_text(size = 12),\n#     axis.text.x = element_text(size = 12),\n#     axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1)\n#   )\n```\n:::\n\n\n### Combined plot\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# ## I am going to remove the y ticks from the SMDH plots to make it smaller..\n# SMDH_design_plot <- SMDH_design_plot +\n#   theme(axis.text.y  = element_blank(),\n#         axis.title.y = element_blank(),\n#         axis.ticks.y = element_blank())\n# \n# SMDH_time_gnm_addition_plot <- SMDH_time_gnm_addition_plot +\n#   theme(axis.text.y  = element_blank(),\n#         axis.title.y = element_blank(),\n#         axis.ticks.y = element_blank())\n# \n# # Combine using patchwork\n# Figure_design_time_gnm_addition <- ((lnRR_design_plot + SMDH_design_plot) /\n#                                (lnRR_time_gnm_addition_plot + SMDH_time_gnm_addition_plot)) +\n#   plot_annotation(tag_levels = \"A\")\n# \n# ggsave(here::here(\"figures/Figure_design_time_gnm_addition.png\"), plot = Figure_design_time_gnm_addition, height = 300, width = 400, units = \"mm\", dpi = 600)\n#        \n```\n:::\n\n\n# Publication Bias Tests\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n###---Small study Effects ----###\n\nlnRR_small_study<-readRDS(here::here(\"model/lnRR_small_study.rds\"))\nSMDH_small_study<-readRDS(here::here(\"model/SMDH_small_study.rds\"))\n\n\nlnRR_small_study_bubble<-orchaRd::bubble_plot(mod_results(lnRR_small_study,\n                     mod=\"sqrt_effective_n_inv\",\n                     group=\"paper_ID\",\n                     weights=\"prop\"),\n                     group=\"paper_ID\") +\n  scale_colour_manual(values =\"mediumpurple4\") +\n  scale_fill_manual(values = \"mediumpurple4\") +\n  labs(y = \"Effect size (lnRR)\",\n       x = expression(sqrt(1 / N[effective])))+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 10),\n    axis.title = element_text(size = 14),\n    axis.text.x = element_text(size = 14),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nSMDH_small_study_bubble<-orchaRd::bubble_plot(mod_results(SMDH_small_study,\n                     mod=\"sqrt_effective_n_inv\",\n                     group=\"paper_ID\",\n                     weights=\"prop\"),\n                     group=\"paper_ID\") +\n  scale_colour_manual(values =\"mediumpurple4\") +\n  scale_fill_manual(values = \"mediumpurple4\") +\n  labs(y = \"Effect size (SMDH)\",\n       x = expression(sqrt(1 / N[effective])))+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 10),\n    axis.title = element_text(size = 14),\n    axis.text.x = element_text(size = 14),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n###---Decline Effects ----###\n\nlnRR_decline_eff<-readRDS(here::here(\"model/lnRR_decline_eff.rds\"))\nSMDH_decline_eff<-readRDS(here::here(\"model/SMDH_decline_eff.rds\"))\n\n\nlnRR_decline_eff_bubble<-orchaRd::bubble_plot(mod_results(lnRR_decline_eff,\n                     mod=\"year_MeanCenter\",\n                     group=\"paper_ID\",\n                     weights=\"prop\"),\n                     group=\"paper_ID\")+\n  scale_colour_manual(values =\"#218833\") +\n  scale_fill_manual(values = \"#218833\") +\n  labs(y = \"Effect size (lnRR)\",\n       x = \"Publication Year (Mean Cenetered)\")+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 10),\n    axis.title = element_text(size = 14),\n    axis.text.x = element_text(size = 14),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nSMDH_decline_effect_bubble<-orchaRd::bubble_plot(mod_results(SMDH_decline_eff,\n                     mod=\"year_MeanCenter\",\n                     group=\"paper_ID\",\n                     weights=\"prop\"),\n                     group=\"paper_ID\")+\n  scale_colour_manual(values =\"#218833\") +\n  scale_fill_manual(values = \"#218833\") +\n  labs(y = \"Effect size (SMDH)\",\n       x = \"Publication Year (Mean Cenetered)\")+\n    theme(\n    panel.border = element_rect(colour = \"black\", fill = NA, linewidth = 0.8),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 10),\n    axis.title = element_text(size = 14),\n    axis.text.x = element_text(size = 14),\n    axis.text.y = element_text(angle = 0, vjust = 0.5, hjust = 1))\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n# Combine using patchwork\nFigure_publication_bias <- ((lnRR_small_study_bubble + SMDH_small_study_bubble) /\n                               (lnRR_decline_eff_bubble + SMDH_decline_effect_bubble)) +\n  plot_annotation(tag_levels = \"A\")\n\nggsave(here::here(\"figures/Figure_publication_bias.png\"), plot = Figure_publication_bias, height = 300, width = 400, units = \"mm\", dpi = 600)\n```\n:::\n\n",
    "supporting": [
      "figures_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}